<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>util/BuiltinAggregates.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.util
<span class="keyword">import</span> org.apache.avro.Schema
<span class="keyword">import</span> edu.berkeley.cs.avro.marker.AvroRecord
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime.ScalaSpecificRecord

case <span class="keyword">class</span> <a href="#115286" title="class ValueAggContainer extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroRecord with ScalaObject with Product with Serializable" id="91088">ValueAggContainer</a><a href="#91088" title="ScalaObject" class="delimiter">(</a><a href="#91088" title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="108562" class="keyword">var</a> <a title="Double" id="90753">curval</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span>
case <span class="keyword">class</span> <a href="#115296" title="class CountAggContainer extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroRecord with ScalaObject with Product with Serializable" id="91084">CountAggContainer</a><a href="#91084" title="ScalaObject" class="delimiter">(</a><a href="#91084" title="()edu.berkeley.cs.scads.util.CountAggContainer" id="108572" class="keyword">var</a> <a title="Int" id="90662">curcount</a>: <span title="Int">Int</span>, <span class="keyword">var</span> <a title="Double" id="90663">curval</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span>

<span class="comment">// average</span>
<span class="keyword">class</span> <a title="class AvgRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9896">AvgRemote</a><a href="#9896" title="ScalaObject" class="delimiter">(</a><a title="String" id="90660">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9878" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>CountAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90653">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="90655">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91084" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.CountAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.CountAggContainer" id="90656">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90669">ag</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90670">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90671">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90653" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90653" title="(x$1: Int)Unit">pos</a> = <a href="#90671" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90660" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <a href="#90669" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#90669" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90663" title="(x$1: Double)Unit">curval</a> = <a href="#90669" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="AnalyticsUtils.scala.html#26760" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90671" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90653" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Double)Double">-</span> <a href="#90669" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90663" title="=&gt; Double">curval</a><span class="delimiter">)</span> <span title="(x: Int)Double">/</span> <a href="#90669" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="=&gt; Int">curcount</a><span class="delimiter">)</span>
    <a href="#90669" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>    
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class AvgLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double] with ScalaObject" id="9897">AvgLocal</a> <a href="#9897" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9875" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>CountAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="90698">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91084" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.CountAggContainer, next: edu.berkeley.cs.scads.util.CountAggContainer)edu.berkeley.cs.scads.util.CountAggContainer" id="90699">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90714">cur</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90715">next</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#90714" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90662" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <a href="#90715" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90662" title="=&gt; Int">curcount</a>
    <a href="#90714" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90663" title="(x$1: Double)Unit">curval</a> = <a href="#90714" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#90715" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Int)Double">*</span> <a href="#90715" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90662" title="=&gt; Int">curcount</a><span class="delimiter">)</span>
    <a href="#90714" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.CountAggContainer)Double" id="90700">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90731">f</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90731" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Int)Double">/</span> <a href="#90731" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90662" title="=&gt; Int">curcount</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="comment">// max</span>
<span class="keyword">class</span> <a title="class MaxRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9898">MaxRemote</a><a href="#9898" title="ScalaObject" class="delimiter">(</a><a title="String" id="90751">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9878" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>ValueAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90744">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90746">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91088" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(4.9E-324)">MIN_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.ValueAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.ValueAggContainer" id="90747">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90757">ag</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90758">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90759">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90744" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90744" title="(x$1: Int)Unit">pos</a> = <a href="#90759" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90751" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <span class="keyword">val</span> <a title="Double" id="90764">v</a> = <a href="AnalyticsUtils.scala.html#26760" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90759" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90744" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90764" title="Double">v</a> <span title="(x: Double)Boolean">&gt;</span> <a href="#90757" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90753" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90757" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90753" title="(x$1: Double)Unit">curval</a> = <a href="#90764" title="Double">v</a>
    <a href="#90757" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class MaxLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double] with ScalaObject" id="9899">MaxLocal</a> <a href="#9899" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9875" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>ValueAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90774">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91088" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(4.9E-324)">MIN_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.ValueAggContainer, next: edu.berkeley.cs.scads.util.ValueAggContainer)edu.berkeley.cs.scads.util.ValueAggContainer" id="90775">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90790">cur</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90791">next</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90790" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90753" title="=&gt; Double">curval</a> <span title="(x: Double)Boolean">&lt;</span> <a href="#90791" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90753" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90790" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90753" title="(x$1: Double)Unit">curval</a> = <a href="#90791" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90753" title="=&gt; Double">curval</a>
    <a href="#90790" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.ValueAggContainer)Double" id="90776">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90799">f</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90799" title="edu.berkeley.cs.scads.util.ValueAggContainer">f</a>.<a href="#90753" title="=&gt; Double">curval</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="comment">// min</span>
<span class="keyword">class</span> <a title="class MinRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9900">MinRemote</a><a href="#9900" title="ScalaObject" class="delimiter">(</a><a title="String" id="90815">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9878" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>ValueAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90808">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90810">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91088" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(1.7976931348623157E308)">MAX_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.ValueAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.ValueAggContainer" id="90811">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90817">ag</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90818">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90819">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90808" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90808" title="(x$1: Int)Unit">pos</a> = <a href="#90819" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90815" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <span class="keyword">val</span> <a title="Double" id="90824">v</a> = <a href="AnalyticsUtils.scala.html#26760" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90819" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90808" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90824" title="Double">v</a> <span title="(x: Double)Boolean">&lt;</span> <a href="#90817" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90753" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90817" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90753" title="(x$1: Double)Unit">curval</a> = <a href="#90824" title="Double">v</a>
    <a href="#90817" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class MinLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double] with ScalaObject" id="9901">MinLocal</a> <a href="#9901" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9875" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>ValueAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90834">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91088" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(1.7976931348623157E308)">MAX_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.ValueAggContainer, next: edu.berkeley.cs.scads.util.ValueAggContainer)edu.berkeley.cs.scads.util.ValueAggContainer" id="90835">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90850">cur</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90851">next</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90850" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90753" title="=&gt; Double">curval</a> <span title="(x: Double)Boolean">&gt;</span> <a href="#90851" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90753" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90850" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90753" title="(x$1: Double)Unit">curval</a> = <a href="#90851" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90753" title="=&gt; Double">curval</a>
    <a href="#90850" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.ValueAggContainer)Double" id="90836">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90859">f</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90859" title="edu.berkeley.cs.scads.util.ValueAggContainer">f</a>.<a href="#90753" title="=&gt; Double">curval</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>



<span class="comment">// sum</span>
<span class="keyword">class</span> <a title="class SumRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9902">SumRemote</a><a href="#9902" title="ScalaObject" class="delimiter">(</a><a title="String" id="90875">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9878" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>ValueAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90868">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90870">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91088" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span><span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.ValueAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.ValueAggContainer" id="90871">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90877">ag</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90878">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90879">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90868" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90868" title="(x$1: Int)Unit">pos</a> = <a href="#90879" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90875" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <a href="#90877" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90753" title="(x$1: Double)Unit">curval</a> <span title="(x: Double)Double">+=</span> <a href="AnalyticsUtils.scala.html#26760" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90879" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90868" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#90877" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SumLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double] with ScalaObject" id="9903">SumLocal</a> <a href="#9903" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9875" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>ValueAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90893">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91088" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span><span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.ValueAggContainer, next: edu.berkeley.cs.scads.util.ValueAggContainer)edu.berkeley.cs.scads.util.ValueAggContainer" id="90894">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90909">cur</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90910">next</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#90909" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90753" title="(x$1: Double)Unit">curval</a> <span title="(x: Double)Double">+=</span> <a href="#90910" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90753" title="=&gt; Double">curval</a>
    <a href="#90909" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.ValueAggContainer)Double" id="90895">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90918">f</a>: <a href="#91088" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90918" title="edu.berkeley.cs.scads.util.ValueAggContainer">f</a>.<a href="#90753" title="=&gt; Double">curval</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>




<span class="comment">// average over limited number of records</span>
<span class="comment">// if hard is true, EXACTLY limit records will be averaged, </span>
<span class="comment">// otherwise, AT LEAST limit records will be averaged</span>
<span class="keyword">class</span> <a title="class SampleAvgRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="91080">SampleAvgRemote</a><a href="#91080" title="ScalaObject" class="delimiter">(</a><a title="String" id="90964">field</a>:<span title="String">String</span>,<a title="Int" id="90965">limit</a>:<span title="Int">Int</span>,<a title="Boolean" id="90968">hard</a>:<span title="Boolean">Boolean</span>=<span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9878" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>CountAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90931">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="90933">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91084" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/* -- some internal private vars for maintaining error counts -- */</span>
  <span class="comment">// for welford's variance</span>
  <span class="keyword">var</span> <a title="Double" id="90935">Mk</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90938">Mkp</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90941">Sk</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90944">Skp</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>

  <span class="keyword">var</span> <a title="Double" id="90947">welvar</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90950">stderr</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.CountAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.CountAggContainer" id="90952">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90970">ag</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90971">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90972">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="=&gt; Int">curcount</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#90965" title="Int">limit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="AnalyticsUtils.scala.html#26758" title="(x$1: Boolean)Unit">stop</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90968" title="Boolean">hard</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90931" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#90931" title="(x$1: Int)Unit">pos</a> = <a href="#90972" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90964" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
      <a href="#90935" title="(x$1: Double)Unit">Mk</a> = <a href="AnalyticsUtils.scala.html#26760" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90972" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90931" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#90938" title="(x$1: Double)Unit">Mkp</a> = <a href="#90935" title="=&gt; Double">Mk</a>
      <a href="#90944" title="(x$1: Double)Unit">Skp</a> = <span title="Double(0.0)" class="double">0.0</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// compute sample variance and mean using welford's method </span>
      <span class="keyword">val</span> <a title="Double" id="90989">x</a> = <a href="AnalyticsUtils.scala.html#26760" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90972" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90931" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#90935" title="(x$1: Double)Unit">Mk</a> = <a href="#90938" title="=&gt; Double">Mkp</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#90989" title="Double">x</a> <span title="(x: Double)Double">-</span> <a href="#90938" title="=&gt; Double">Mkp</a><span class="delimiter">)</span><span title="(x: Int)Double">/</span><a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="=&gt; Int">curcount</a>;
      <a href="#90941" title="(x$1: Double)Unit">Sk</a> = <a href="#90944" title="=&gt; Double">Skp</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#90989" title="Double">x</a> <span title="(x: Double)Double">-</span> <a href="#90938" title="=&gt; Double">Mkp</a><span class="delimiter">)</span><span title="(x: Double)Double">*</span><span class="delimiter">(</span><a href="#90989" title="Double">x</a> <span title="(x: Double)Double">-</span> <a href="#90935" title="=&gt; Double">Mk</a><span class="delimiter">)</span>;
    
      <a href="#90938" title="(x$1: Double)Unit">Mkp</a> = <a href="#90935" title="=&gt; Double">Mk</a>
      <a href="#90944" title="(x$1: Double)Unit">Skp</a> = <a href="#90941" title="=&gt; Double">Sk</a>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="=&gt; Int">curcount</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#90947" title="(x$1: Double)Unit">welvar</a> =  <a href="#90941" title="=&gt; Double">Sk</a><span title="(x: Int)Double">/</span><span class="delimiter">(</span><a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="=&gt; Int">curcount</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <a href="#90950" title="(x$1: Double)Unit">stderr</a> = <a href="#90947" title="=&gt; Double">welvar</a> <span title="(x: Double)Double">/</span> scala.math.<span title="(x: Double)Double">sqrt</span><span class="delimiter">(</span><a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90662" title="=&gt; Double">curcount</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90663" title="(x$1: Double)Unit">curval</a> = <a href="#90935" title="=&gt; Double">Mk</a>
    <a href="#90970" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SampleAvgLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double] with ScalaObject" id="9907">SampleAvgLocal</a> <a href="#9907" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9875" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>CountAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="91035">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91084" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.CountAggContainer, next: edu.berkeley.cs.scads.util.CountAggContainer)edu.berkeley.cs.scads.util.CountAggContainer" id="91036">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="91051">cur</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.scads.util.CountAggContainer" id="91052">next</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91051" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90662" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <a href="#91052" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90662" title="=&gt; Int">curcount</a>
    <a href="#91051" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90663" title="(x$1: Double)Unit">curval</a> = <a href="#91051" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#91052" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Int)Double">*</span> <a href="#91052" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90662" title="=&gt; Int">curcount</a><span class="delimiter">)</span>
    <a href="#91051" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.CountAggContainer)Double" id="91037">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="91068">f</a>: <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#91068" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90663" title="=&gt; Double">curval</a> <span title="(x: Int)Double">/</span> <a href="#91068" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90662" title="=&gt; Int">curcount</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>