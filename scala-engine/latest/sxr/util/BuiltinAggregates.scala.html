<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>util/BuiltinAggregates.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.util
<span class="keyword">import</span> org.apache.avro.Schema
<span class="keyword">import</span> edu.berkeley.cs.avro.marker.AvroRecord
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime.ScalaSpecificRecord

case <span class="keyword">class</span> <a href="#115623" title="class ValueAggContainer extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroRecord with ScalaObject with Product with Serializable" id="91104">ValueAggContainer</a><a href="#91104" title="ScalaObject" class="delimiter">(</a><a href="#91104" title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="108899" class="keyword">var</a> <a title="Double" id="90769">curval</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span>
case <span class="keyword">class</span> <a href="#115633" title="class CountAggContainer extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroRecord with ScalaObject with Product with Serializable" id="91100">CountAggContainer</a><a href="#91100" title="ScalaObject" class="delimiter">(</a><a href="#91100" title="()edu.berkeley.cs.scads.util.CountAggContainer" id="108909" class="keyword">var</a> <a title="Int" id="90678">curcount</a>: <span title="Int">Int</span>, <span class="keyword">var</span> <a title="Double" id="90679">curval</a>: <span title="Double">Double</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span>

<span class="comment">// average</span>
<span class="keyword">class</span> <a title="class AvgRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9890">AvgRemote</a><a href="#9890" title="ScalaObject" class="delimiter">(</a><a title="String" id="90676">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9872" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>CountAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90669">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="90671">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91100" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.CountAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.CountAggContainer" id="90672">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90685">ag</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90686">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90687">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90669" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90669" title="(x$1: Int)Unit">pos</a> = <a href="#90687" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90676" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <a href="#90685" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#90685" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90679" title="(x$1: Double)Unit">curval</a> = <a href="#90685" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="AnalyticsUtils.scala.html#26761" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90687" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90669" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Double)Double">-</span> <a href="#90685" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90679" title="=&gt; Double">curval</a><span class="delimiter">)</span> <span title="(x: Int)Double">/</span> <a href="#90685" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="=&gt; Int">curcount</a><span class="delimiter">)</span>
    <a href="#90685" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>    
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class AvgLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double] with ScalaObject" id="9891">AvgLocal</a> <a href="#9891" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9869" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>CountAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="90714">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91100" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.CountAggContainer, next: edu.berkeley.cs.scads.util.CountAggContainer)edu.berkeley.cs.scads.util.CountAggContainer" id="90715">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90730">cur</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90731">next</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#90730" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90678" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <a href="#90731" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90678" title="=&gt; Int">curcount</a>
    <a href="#90730" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90679" title="(x$1: Double)Unit">curval</a> = <a href="#90730" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#90731" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Int)Double">*</span> <a href="#90731" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90678" title="=&gt; Int">curcount</a><span class="delimiter">)</span>
    <a href="#90730" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.CountAggContainer)Double" id="90716">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90747">f</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90747" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Int)Double">/</span> <a href="#90747" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90678" title="=&gt; Int">curcount</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="comment">// max</span>
<span class="keyword">class</span> <a title="class MaxRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9892">MaxRemote</a><a href="#9892" title="ScalaObject" class="delimiter">(</a><a title="String" id="90767">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9872" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>ValueAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90760">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90762">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91104" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(4.9E-324)">MIN_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.ValueAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.ValueAggContainer" id="90763">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90773">ag</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90774">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90775">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90760" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90760" title="(x$1: Int)Unit">pos</a> = <a href="#90775" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90767" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <span class="keyword">val</span> <a title="Double" id="90780">v</a> = <a href="AnalyticsUtils.scala.html#26761" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90775" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90760" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90780" title="Double">v</a> <span title="(x: Double)Boolean">&gt;</span> <a href="#90773" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90769" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90773" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90769" title="(x$1: Double)Unit">curval</a> = <a href="#90780" title="Double">v</a>
    <a href="#90773" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class MaxLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double] with ScalaObject" id="9893">MaxLocal</a> <a href="#9893" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9869" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>ValueAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90790">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91104" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(4.9E-324)">MIN_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.ValueAggContainer, next: edu.berkeley.cs.scads.util.ValueAggContainer)edu.berkeley.cs.scads.util.ValueAggContainer" id="90791">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90806">cur</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90807">next</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90806" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90769" title="=&gt; Double">curval</a> <span title="(x: Double)Boolean">&lt;</span> <a href="#90807" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90769" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90806" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90769" title="(x$1: Double)Unit">curval</a> = <a href="#90807" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90769" title="=&gt; Double">curval</a>
    <a href="#90806" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.ValueAggContainer)Double" id="90792">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90815">f</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90815" title="edu.berkeley.cs.scads.util.ValueAggContainer">f</a>.<a href="#90769" title="=&gt; Double">curval</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span class="comment">// min</span>
<span class="keyword">class</span> <a title="class MinRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9894">MinRemote</a><a href="#9894" title="ScalaObject" class="delimiter">(</a><a title="String" id="90831">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9872" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>ValueAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90824">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90826">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91104" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(1.7976931348623157E308)">MAX_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.ValueAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.ValueAggContainer" id="90827">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90833">ag</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90834">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90835">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90824" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90824" title="(x$1: Int)Unit">pos</a> = <a href="#90835" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90831" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <span class="keyword">val</span> <a title="Double" id="90840">v</a> = <a href="AnalyticsUtils.scala.html#26761" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90835" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90824" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90840" title="Double">v</a> <span title="(x: Double)Boolean">&lt;</span> <a href="#90833" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90769" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90833" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90769" title="(x$1: Double)Unit">curval</a> = <a href="#90840" title="Double">v</a>
    <a href="#90833" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class MinLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double] with ScalaObject" id="9895">MinLocal</a> <a href="#9895" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9869" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>ValueAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90850">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91104" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span>java.lang.Double.<span title="Double(1.7976931348623157E308)">MAX_VALUE</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.ValueAggContainer, next: edu.berkeley.cs.scads.util.ValueAggContainer)edu.berkeley.cs.scads.util.ValueAggContainer" id="90851">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90866">cur</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90867">next</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90866" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90769" title="=&gt; Double">curval</a> <span title="(x: Double)Boolean">&gt;</span> <a href="#90867" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90769" title="=&gt; Double">curval</a><span class="delimiter">)</span>
      <a href="#90866" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90769" title="(x$1: Double)Unit">curval</a> = <a href="#90867" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90769" title="=&gt; Double">curval</a>
    <a href="#90866" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.ValueAggContainer)Double" id="90852">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90875">f</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90875" title="edu.berkeley.cs.scads.util.ValueAggContainer">f</a>.<a href="#90769" title="=&gt; Double">curval</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>



<span class="comment">// sum</span>
<span class="keyword">class</span> <a title="class SumRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="9896">SumRemote</a><a href="#9896" title="ScalaObject" class="delimiter">(</a><a title="String" id="90891">field</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9872" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>ValueAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90884">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90886">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91104" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span><span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.ValueAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.ValueAggContainer" id="90887">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90893">ag</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90894">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90895">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90884" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#90884" title="(x$1: Int)Unit">pos</a> = <a href="#90895" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90891" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
    <a href="#90893" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>.<a href="#90769" title="(x$1: Double)Unit">curval</a> <span title="(x: Double)Double">+=</span> <a href="AnalyticsUtils.scala.html#26761" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90895" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90884" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#90893" title="edu.berkeley.cs.scads.util.ValueAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SumLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double] with ScalaObject" id="9897">SumLocal</a> <a href="#9897" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9869" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.ValueAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>ValueAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.ValueAggContainer" id="90909">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91104" title="(curval: Double)edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">(</span><span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.ValueAggContainer, next: edu.berkeley.cs.scads.util.ValueAggContainer)edu.berkeley.cs.scads.util.ValueAggContainer" id="90910">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90925">cur</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a>, <a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90926">next</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a> = <span class="delimiter">{</span>
    <a href="#90925" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>.<a href="#90769" title="(x$1: Double)Unit">curval</a> <span title="(x: Double)Double">+=</span> <a href="#90926" title="edu.berkeley.cs.scads.util.ValueAggContainer">next</a>.<a href="#90769" title="=&gt; Double">curval</a>
    <a href="#90925" title="edu.berkeley.cs.scads.util.ValueAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.ValueAggContainer)Double" id="90911">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.ValueAggContainer" id="90934">f</a>: <a href="#91104" title="edu.berkeley.cs.scads.util.ValueAggContainer">ValueAggContainer</a><span class="delimiter">)</span>:<span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#90934" title="edu.berkeley.cs.scads.util.ValueAggContainer">f</a>.<a href="#90769" title="=&gt; Double">curval</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>




<span class="comment">// average over limited number of records</span>
<span class="comment">// if hard is true, EXACTLY limit records will be averaged, </span>
<span class="comment">// otherwise, AT LEAST limit records will be averaged</span>
<span class="keyword">class</span> <a title="class SampleAvgRemote extends java.lang.Object with edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord] with ScalaObject" id="91096">SampleAvgRemote</a><a href="#91096" title="ScalaObject" class="delimiter">(</a><a title="String" id="90980">field</a>:<span title="String">String</span>,<a title="Int" id="90981">limit</a>:<span title="Int">Int</span>,<a title="Boolean" id="90984">hard</a>:<span title="Boolean">Boolean</span>=<span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="AnalyticsUtils.scala.html#9872" title="edu.berkeley.cs.scads.util.RemoteAggregate[edu.berkeley.cs.scads.util.CountAggContainer,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord,edu.berkeley.cs.avro.runtime.ScalaSpecificRecord]">RemoteAggregate</a><span class="delimiter">[</span>CountAggContainer, ScalaSpecificRecord, ScalaSpecificRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="90947">pos</a> = -<span title="Int(-1)" class="int">1</span> <span class="comment">// will be updated first time we see a record</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="90949">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91100" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/* -- some internal private vars for maintaining error counts -- */</span>
  <span class="comment">// for welford's variance</span>
  <span class="keyword">var</span> <a title="Double" id="90951">Mk</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90954">Mkp</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90957">Sk</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90960">Skp</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>

  <span class="keyword">var</span> <a title="Double" id="90963">welvar</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>
  <span class="keyword">var</span> <a title="Double" id="90966">stderr</a>:<span title="Double">Double</span> = <span title="Double(0.0)" class="double">0.0</span>

  <span class="keyword">def</span> <a title="(ag: edu.berkeley.cs.scads.util.CountAggContainer, key: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord, value: edu.berkeley.cs.avro.runtime.ScalaSpecificRecord)edu.berkeley.cs.scads.util.CountAggContainer" id="90968">applyAggregate</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="90986">ag</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90987">key</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span>, <a title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord" id="90988">value</a>: <span title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">ScalaSpecificRecord</span><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="=&gt; Int">curcount</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#90981" title="Int">limit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="AnalyticsUtils.scala.html#26759" title="(x$1: Boolean)Unit">stop</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90984" title="Boolean">hard</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90947" title="=&gt; Int">pos</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#90947" title="(x$1: Int)Unit">pos</a> = <a href="#90988" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="()org.apache.avro.Schema">getSchema</span>.<span title="(x$1: java.lang.String)org.apache.avro.Schema.Field">getField</span><span class="delimiter">(</span><a href="#90980" title="String">field</a><span class="delimiter">)</span>.<span title="()Int">pos</span>
      <a href="#90951" title="(x$1: Double)Unit">Mk</a> = <a href="AnalyticsUtils.scala.html#26761" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90988" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90947" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#90954" title="(x$1: Double)Unit">Mkp</a> = <a href="#90951" title="=&gt; Double">Mk</a>
      <a href="#90960" title="(x$1: Double)Unit">Skp</a> = <span title="Double(0.0)" class="double">0.0</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// compute sample variance and mean using welford's method </span>
      <span class="keyword">val</span> <a title="Double" id="91005">x</a> = <a href="AnalyticsUtils.scala.html#26761" title="(v: Any)Double">toDouble</a><span class="delimiter">(</span><a href="#90988" title="edu.berkeley.cs.avro.runtime.ScalaSpecificRecord">value</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#90947" title="=&gt; Int">pos</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#90951" title="(x$1: Double)Unit">Mk</a> = <a href="#90954" title="=&gt; Double">Mkp</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#91005" title="Double">x</a> <span title="(x: Double)Double">-</span> <a href="#90954" title="=&gt; Double">Mkp</a><span class="delimiter">)</span><span title="(x: Int)Double">/</span><a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="=&gt; Int">curcount</a>;
      <a href="#90957" title="(x$1: Double)Unit">Sk</a> = <a href="#90960" title="=&gt; Double">Skp</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#91005" title="Double">x</a> <span title="(x: Double)Double">-</span> <a href="#90954" title="=&gt; Double">Mkp</a><span class="delimiter">)</span><span title="(x: Double)Double">*</span><span class="delimiter">(</span><a href="#91005" title="Double">x</a> <span title="(x: Double)Double">-</span> <a href="#90951" title="=&gt; Double">Mk</a><span class="delimiter">)</span>;
    
      <a href="#90954" title="(x$1: Double)Unit">Mkp</a> = <a href="#90951" title="=&gt; Double">Mk</a>
      <a href="#90960" title="(x$1: Double)Unit">Skp</a> = <a href="#90957" title="=&gt; Double">Sk</a>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="=&gt; Int">curcount</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#90963" title="(x$1: Double)Unit">welvar</a> =  <a href="#90957" title="=&gt; Double">Sk</a><span title="(x: Int)Double">/</span><span class="delimiter">(</span><a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="=&gt; Int">curcount</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <a href="#90966" title="(x$1: Double)Unit">stderr</a> = <a href="#90963" title="=&gt; Double">welvar</a> <span title="(x: Double)Double">/</span> scala.math.<span title="(x: Double)Double">sqrt</span><span class="delimiter">(</span><a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90678" title="=&gt; Double">curcount</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>.<a href="#90679" title="(x$1: Double)Unit">curval</a> = <a href="#90951" title="=&gt; Double">Mk</a>
    <a href="#90986" title="edu.berkeley.cs.scads.util.CountAggContainer">ag</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SampleAvgLocal extends edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double] with ScalaObject" id="9901">SampleAvgLocal</a> <a href="#9901" title="ScalaObject" class="keyword">extends</a> <a href="AnalyticsUtils.scala.html#9869" title="edu.berkeley.cs.scads.util.LocalAggregate[edu.berkeley.cs.scads.util.CountAggContainer,Double]">LocalAggregate</a><span class="delimiter">[</span>CountAggContainer, Double<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.util.CountAggContainer" id="91051">init</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91100" title="(curcount: Int, curval: Double)edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Double(0.0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(cur: edu.berkeley.cs.scads.util.CountAggContainer, next: edu.berkeley.cs.scads.util.CountAggContainer)edu.berkeley.cs.scads.util.CountAggContainer" id="91052">foldFunction</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="91067">cur</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a>, <a title="edu.berkeley.cs.scads.util.CountAggContainer" id="91068">next</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a> = <span class="delimiter">{</span>
    <a href="#91067" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90678" title="(x$1: Int)Unit">curcount</a> <span title="(x: Int)Int">+=</span> <a href="#91068" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90678" title="=&gt; Int">curcount</a>
    <a href="#91067" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90679" title="(x$1: Double)Unit">curval</a> = <a href="#91067" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#91068" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Int)Double">*</span> <a href="#91068" title="edu.berkeley.cs.scads.util.CountAggContainer">next</a>.<a href="#90678" title="=&gt; Int">curcount</a><span class="delimiter">)</span>
    <a href="#91067" title="edu.berkeley.cs.scads.util.CountAggContainer">cur</a>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: edu.berkeley.cs.scads.util.CountAggContainer)Double" id="91053">finalize</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.CountAggContainer" id="91084">f</a>: <a href="#91100" title="edu.berkeley.cs.scads.util.CountAggContainer">CountAggContainer</a><span class="delimiter">)</span>: <span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90679" title="=&gt; Double">curval</a> <span title="(x: Int)Double">/</span> <a href="#91084" title="edu.berkeley.cs.scads.util.CountAggContainer">f</a>.<a href="#90678" title="=&gt; Int">curcount</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>