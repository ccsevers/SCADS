<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>server/PartitionHandler.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.storage

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> net.lag.logging.Logger
<span class="keyword">import</span> scala.collection.mutable.ArrayBuffer
<span class="keyword">import</span> java.io.<span class="delimiter">{</span>BufferedReader,ObjectInputStream,InputStream,InputStreamReader,ByteArrayInputStream<span class="delimiter">}</span>
<span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger

<span class="comment">// keep track of number of gets and puts</span>
case <span class="keyword">class</span> <a title="class PartitionWorkloadStats extends java.lang.Object with ScalaObject with Product with Serializable" id="79149">PartitionWorkloadStats</a><a href="#79149" title="ScalaObject" class="delimiter">(</a><span class="keyword">var</span> <a title="Int" id="78282">gets</a>:<span title="Int">Int</span>, <span class="keyword">var</span> <a title="Int" id="78283">puts</a>:<span title="Int">Int</span><span class="delimiter">)</span>

<span class="comment">// Used for bulk puts of urls</span>
<span class="keyword">abstract</span> <span class="keyword">trait</span> <a title="trait RecParser extends java.lang.Object with Serializable with ScalaObject" id="9816">RecParser</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Serializable">Serializable</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(location: String)Unit" id="49885">setLocation</a><span class="delimiter">(</span><a title="String" id="70052">location</a>:<span title="String">String</span><span class="delimiter">)</span>:<span title="Unit">Unit</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(in: java.io.InputStream)Unit" id="49886">setInput</a><span class="delimiter">(</span><a title="java.io.InputStream" id="70177">in</a>:<span title="java.io.InputStream">InputStream</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="()(AnyRef, AnyRef)" id="49887">getNext</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="(AnyRef, AnyRef)" class="delimiter">(</span>AnyRef,AnyRef<span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class RequestRejectedException extends java.lang.Exception with ScalaObject" id="9817">RequestRejectedException</a><a href="#9817" title="ScalaObject" class="delimiter">(</a><a title="String" id="74029">e</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="java.lang.Exception">Exception</span><span class="delimiter">(</span><a href="#74029" title="String">e</a><span class="delimiter">)</span>

<span class="comment">/* Everything at this level is done in Array[Byte] packets as all these methods
 * get called as a result of receiving Avro messages and their responses
 * will also go out as Avro messages.  Converting these bytes to an internal
 * representation, or using them as is, is left to the StorageManager */</span>
<span class="keyword">abstract</span> <span class="keyword">trait</span> <a title="trait StorageManager extends java.lang.Object" id="9818">StorageManager</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(key: Array[Byte])Option[Array[Byte]]" id="65755">get</a><span class="delimiter">(</span><a title="Array[Byte]" id="69859">key</a>:<span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(key: Array[Byte], value: Option[Array[Byte]])Unit" id="65756">put</a><span class="delimiter">(</span><a title="Array[Byte]" id="69947">key</a>:<span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>,<a title="Option[Array[Byte]]" id="69948">value</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="(key: Array[Byte], value: Option[Array[Byte]], expectedValue: Option[Array[Byte]])Boolean" id="65757">testAndSet</a><span class="delimiter">(</span><a title="Array[Byte]" id="69961">key</a>:<span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="69962">value</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="69963">expectedValue</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Boolean">Boolean</span>
  <span class="comment">// bit odd to have PutRequest in here, but would probable be a performance hit to do it another way</span>
  <span class="keyword">def</span> <a title="(parser: edu.berkeley.cs.scads.storage.RecParser, locations: Seq[String])Unit" id="65758">bulkUrlPut</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.RecParser" id="70030">parser</a>:<a href="#9816" title="edu.berkeley.cs.scads.storage.RecParser">RecParser</a>, <a title="Seq[String]" id="70031">locations</a>:<span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(records: Seq[edu.berkeley.cs.scads.comm.PutRequest])Unit" id="65759">bulkPut</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.PutRequest]" id="70197">records</a>:<span title="Seq[edu.berkeley.cs.scads.comm.PutRequest]">Seq</span><span class="delimiter">[</span>PutRequest<span class="delimiter">]</span><span class="delimiter">)</span> 
  <span class="comment">// cursorscanrequest?</span>
  <span class="keyword">def</span> <a title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]], limit: Option[Int], offset: Option[Int], ascending: Boolean)Seq[edu.berkeley.cs.scads.comm.Record]" id="65760">getRange</a><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="70234">minKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="70235">maxKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Int]" id="70236">limit</a>:<span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Option[Int]" id="70237">offset</a>:<span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Boolean" id="70238">ascending</a>:<span title="Boolean">Boolean</span><span class="delimiter">)</span>:<span title="Seq[edu.berkeley.cs.scads.comm.Record]">Seq</span><span class="delimiter">[</span>Record<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(ranges: Seq[edu.berkeley.cs.scads.comm.MessageBody])scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.comm.GetRangeResponse]" id="65761">getBatch</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.MessageBody]" id="70320">ranges</a>:<span title="Seq[edu.berkeley.cs.scads.comm.MessageBody]">Seq</span><span class="delimiter">[</span>MessageBody<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.comm.GetRangeResponse]">ArrayBuffer</span><span class="delimiter">[</span>GetRangeResponse<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]])Int" id="65762">countRange</a><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="70419">minKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="70420">maxKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Int">Int</span>
  <span class="keyword">def</span> <a title="(src: edu.berkeley.cs.scads.comm.PartitionService, overwrite: Boolean)Unit" id="65763">copyData</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.PartitionService" id="70439">src</a>:<span title="edu.berkeley.cs.scads.comm.PartitionService">PartitionService</span>, <a title="Boolean" id="70440">overwrite</a>:<span title="Boolean">Boolean</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()(Option[Array[Byte]], Option[Array[Byte]])" id="65764">getResponsibility</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="(Option[Array[Byte]], Option[Array[Byte]])" class="delimiter">(</span>Option<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>,Option<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="comment">//def deleteRange(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]], txn: Option[Transaction])</span>
  <span class="keyword">def</span> <a title="(groups: Seq[String], keyType: String, valType: String, filters: Seq[edu.berkeley.cs.scads.comm.AggFilter], aggregates: Seq[edu.berkeley.cs.scads.comm.AggOp])Seq[edu.berkeley.cs.scads.comm.GroupedAgg]" id="65765">applyAggregate</a><span class="delimiter">(</span><a title="Seq[String]" id="70518">groups</a>:<span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
                     <a title="String" id="70519">keyType</a>:<span title="String">String</span>,
                     <a title="String" id="70520">valType</a>:<span title="String">String</span>,
                     <a title="Seq[edu.berkeley.cs.scads.comm.AggFilter]" id="70521">filters</a>:<span title="Seq[edu.berkeley.cs.scads.comm.AggFilter]">Seq</span><span class="delimiter">[</span>AggFilter<span class="delimiter">]</span>,
                     <a title="Seq[edu.berkeley.cs.scads.comm.AggOp]" id="70522">aggregates</a>:<span title="Seq[edu.berkeley.cs.scads.comm.AggOp]">Seq</span><span class="delimiter">[</span>AggOp<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Seq[edu.berkeley.cs.scads.comm.GroupedAgg]">Seq</span><span class="delimiter">[</span>GroupedAgg<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="()Unit" id="65766">startup</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="()Unit" id="65767">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
<span class="delimiter">}</span>


case <span class="keyword">class</span> <a title="class PartitionHandler extends java.lang.Object with edu.berkeley.cs.scads.comm.ServiceHandler[edu.berkeley.cs.scads.comm.PartitionServiceOperation] with ScalaObject with Product with Serializable" id="79145">PartitionHandler</a><a href="#79145" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.StorageManager" id="79142">manager</a>:<a href="#9818" title="edu.berkeley.cs.scads.storage.StorageManager">StorageManager</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.scads.comm.ServiceHandler[edu.berkeley.cs.scads.comm.PartitionServiceOperation]">ServiceHandler</span><span class="delimiter">[</span>PartitionServiceOperation<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="78238">logger</a> = <span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;PartitionHandler&quot;)" class="string">&quot;PartitionHandler&quot;</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="78240">startup</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span> = <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65766" title="()Unit">startup</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="78241">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span> = <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65767" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>


  <span class="comment">// workload stats code</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78243">currentStats</a> = <a href="#79149" title="(gets: Int, puts: Int)edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78246">completedStats</a> = <a href="#79149" title="(gets: Int, puts: Int)edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Long" id="78249">statsClearedTime</a> = <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Int" id="78251">statWindowTime</a> = <span class="int">20</span><span title="Int(20000)">*</span><span class="int">1000</span> <span class="comment">// ms, how long a window to maintain stats for</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Int" id="78253">clearStatWindowsTime</a> = <span class="int">60</span><span title="Int(60000)">*</span><span class="int">1000</span> <span class="comment">// ms, keep long to keep stats around, in all windows</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="List[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]" id="78256">statWindows</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#78253" title="=&gt; Int">clearStatWindowsTime</a><span title="(x: Int)Int">/</span><a href="#78251" title="=&gt; Int">statWindowTime</a><span class="delimiter">)</span>
    .<span title="(f: Int =&gt; (java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger),scala.collection.immutable.IndexedSeq[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]])scala.collection.immutable.IndexedSeq[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger),scala.collection.immutable.IndexedSeq[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]]" class="delimiter">{</span><a title="Int" id="78437">_</a>=&gt;<span title="(_1: java.util.concurrent.atomic.AtomicInteger, _2: java.util.concurrent.atomic.AtomicInteger)(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)" class="delimiter">(</span><span title="()java.util.concurrent.atomic.AtomicInteger" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span>,<span title="()java.util.concurrent.atomic.AtomicInteger" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span><span class="delimiter">)</span><span class="delimiter">}</span>.<span title="=&gt; List[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]">toList</span> <span class="comment">// (get,put) for each window</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Double" id="78258">getSamplingRate</a> = <span title="Double(1.0)" class="double">1.0</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Double" id="78260">putSamplingRate</a> = <span title="Double(1.0)" class="double">1.0</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.Random" id="78262">samplerRandom</a> = <span title="java.util.Random" class="keyword">new</span> java.util.<span title="java.util.Random">Random</span>

  <span class="keyword">def</span> <a title="()(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" id="78264">getWorkloadStats</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" class="delimiter">(</span>PartitionWorkloadStats,Long<span class="delimiter">)</span> = <span title="(_1: edu.berkeley.cs.scads.storage.PartitionWorkloadStats, _2: Long)(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" class="delimiter">(</span><a href="#78246" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">completedStats</a>,<a href="#78249" title="=&gt; Long">statsClearedTime</a><span class="delimiter">)</span>
  <span class="comment">/**
  * set the current stats as the last completed interval, used when stats are queried
  * zero out the current stats to start a new interval
  * return the old completed interval for archiving
  */</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78265">resetWorkloadStats</a><span class="delimiter">(</span><span class="delimiter">)</span>:<a href="#79149" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78503">ret</a> = <a href="#78246" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">completedStats</a>
    <a href="#78246" title="(x$1: edu.berkeley.cs.scads.storage.PartitionWorkloadStats)Unit">completedStats</a> = <a href="#78243" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">currentStats</a>
    <a href="#78249" title="(x$1: Long)Unit">statsClearedTime</a> = <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#78243" title="(x$1: edu.berkeley.cs.scads.storage.PartitionWorkloadStats)Unit">currentStats</a> = <a href="#79149" title="(gets: Int, puts: Int)edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <a href="#78503" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">ret</a>
  <span class="delimiter">}</span>
  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="(num: Int)Unit" id="78266">incrementGetCount</a><span class="delimiter">(</span><a title="Int" id="78504">num</a>:<span title="Int">Int</span><span class="delimiter">)</span> = <a href="#78243" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">currentStats</a>.<a href="#78282" title="(x$1: Int)Unit">gets</a> <span title="(x: Int)Int">+=</span> <a href="#78504" title="Int">num</a>
  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="(num: Int)Unit" id="78267">incrementPutCount</a><span class="delimiter">(</span><a title="Int" id="78512">num</a>:<span title="Int">Int</span><span class="delimiter">)</span> = <a href="#78243" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">currentStats</a>.<a href="#78283" title="(x$1: Int)Unit">puts</a> <span title="(x: Int)Int">+=</span> <a href="#78512" title="Int">num</a>
  <span class="comment">// end workload stats stuff</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(src: Option[edu.berkeley.cs.scads.comm.RemoteActorProxy], msg: edu.berkeley.cs.scads.comm.PartitionServiceOperation)Unit" id="78268">process</a><span class="delimiter">(</span><a title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]" id="78520">src</a>: <span title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">Option</span><span class="delimiter">[</span>RemoteActorProxy<span class="delimiter">]</span>, <a title="edu.berkeley.cs.scads.comm.PartitionServiceOperation" id="78521">msg</a>: <span title="edu.berkeley.cs.scads.comm.PartitionServiceOperation">PartitionServiceOperation</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit" id="78525">reply</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.MessageBody" id="78526">msg</a>: <span title="edu.berkeley.cs.scads.comm.MessageBody">MessageBody</span><span class="delimiter">)</span> = <a href="#78520" title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">src</a>.<span title="(f: edu.berkeley.cs.scads.comm.RemoteActorProxy =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#78531" title="edu.berkeley.cs.scads.comm.RemoteActorProxy">_</a> <a href="#79145" title="(body: edu.berkeley.cs.scads.comm.MessageBody)(implicit sender: edu.berkeley.cs.scads.comm.RemoteActorProxy)Unit">!</a> <a href="#78526" title="edu.berkeley.cs.scads.comm.MessageBody">msg</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#78521" title="edu.berkeley.cs.scads.comm.PartitionServiceOperation">msg</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">GetRequest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78535">key</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#78262" title="=&gt; java.util.Random">samplerRandom</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#78258" title="=&gt; Double">getSamplingRate</a><span class="delimiter">)</span> <a href="#78266" title="(num: Int)Unit">incrementGetCount</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(value: Option[Array[Byte]])edu.berkeley.cs.scads.comm.GetResponse">GetResponse</span><span class="delimiter">(</span><a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65755" title="(key: Array[Byte])Option[Array[Byte]]">get</a><span class="delimiter">(</span><a href="#78535" title="Array[Byte]">key</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">PutRequest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78543">key</a>,<a title="Option[Array[Byte]]" id="78544">value</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65756" title="(key: Array[Byte], value: Option[Array[Byte]])Unit">put</a><span class="delimiter">(</span><a href="#78543" title="Array[Byte]">key</a>,<a href="#78544" title="Option[Array[Byte]]">value</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#78262" title="=&gt; java.util.Random">samplerRandom</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#78260" title="=&gt; Double">putSamplingRate</a><span class="delimiter">)</span> <a href="#78267" title="(num: Int)Unit">incrementPutCount</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.PutResponse">PutResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">BulkUrlPutReqest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78575">parserBytes</a>, <a title="Seq[String]" id="78576">locations</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="java.io.ObjectInputStream" id="78577">ois</a> = <span title="java.io.ObjectInputStream" class="keyword">new</span> <span title="java.io.ObjectInputStream">ObjectInputStream</span><span class="delimiter">(</span><span title="java.io.ByteArrayInputStream" class="keyword">new</span> <span title="java.io.ByteArrayInputStream">ByteArrayInputStream</span><span class="delimiter">(</span><a href="#78575" title="Array[Byte]">parserBytes</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.RecParser" id="78578">parser</a> = <a href="#78577" title="java.io.ObjectInputStream">ois</a>.<span title="()java.lang.Object">readObject</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="edu.berkeley.cs.scads.storage.RecParser" class="delimiter">[</span><a href="#9816" title="edu.berkeley.cs.scads.storage.RecParser">RecParser</a><span class="delimiter">]</span>
          <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65758" title="(parser: edu.berkeley.cs.scads.storage.RecParser, locations: Seq[String])Unit">bulkUrlPut</a><span class="delimiter">(</span><a href="#78578" title="edu.berkeley.cs.scads.storage.RecParser">parser</a>,<a href="#78576" title="Seq[String]">locations</a><span class="delimiter">)</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.BulkPutResponse">BulkPutResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">BulkPutRequest</span><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.PutRequest]" id="78583">records</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65759" title="(records: Seq[edu.berkeley.cs.scads.comm.PutRequest])Unit">bulkPut</a><span class="delimiter">(</span><a href="#78583" title="Seq[edu.berkeley.cs.scads.comm.PutRequest]">records</a><span class="delimiter">)</span>
          <span class="comment">/*if (samplerRandom.nextDouble &lt;= putSamplingRate) incrementPutCount(reccount)*/</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.BulkPutResponse">BulkPutResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">GetRangeRequest</span><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="78585">minKey</a>, <a title="Option[Array[Byte]]" id="78586">maxKey</a>, <a title="Option[Int]" id="78587">limit</a>, <a title="Option[Int]" id="78588">offset</a>, <a title="Boolean" id="78589">ascending</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#78262" title="=&gt; java.util.Random">samplerRandom</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#78258" title="=&gt; Double">getSamplingRate</a><span class="delimiter">)</span> <a href="#78266" title="(num: Int)Unit">incrementGetCount</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="comment">/*reccount*/</span><span class="delimiter">)</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(records: Seq[edu.berkeley.cs.scads.comm.Record])edu.berkeley.cs.scads.comm.GetRangeResponse">GetRangeResponse</span><span class="delimiter">(</span><a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65760" title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]], limit: Option[Int], offset: Option[Int], ascending: Boolean)Seq[edu.berkeley.cs.scads.comm.Record]">getRange</a><span class="delimiter">(</span><a href="#78585" title="Option[Array[Byte]]">minKey</a>,<a href="#78586" title="Option[Array[Byte]]">maxKey</a>,<a href="#78587" title="Option[Int]">limit</a>,<a href="#78588" title="Option[Int]">offset</a>,<a href="#78589" title="Boolean">ascending</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">BatchRequest</span><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.MessageBody]" id="78632">ranges</a><span class="delimiter">)</span> =&gt;
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(ranges: Seq[edu.berkeley.cs.scads.comm.MessageBody])edu.berkeley.cs.scads.comm.BatchResponse">BatchResponse</span><span class="delimiter">(</span><a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65761" title="(ranges: Seq[edu.berkeley.cs.scads.comm.MessageBody])scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.comm.GetRangeResponse]">getBatch</a><span class="delimiter">(</span><a href="#78632" title="Seq[edu.berkeley.cs.scads.comm.MessageBody]">ranges</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">CountRangeRequest</span><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="78671">minKey</a>,<a title="Option[Array[Byte]]" id="78672">maxKey</a><span class="delimiter">)</span> =&gt; <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(count: Int)edu.berkeley.cs.scads.comm.CountRangeResponse">CountRangeResponse</span><span class="delimiter">(</span><a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65762" title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]])Int">countRange</a><span class="delimiter">(</span><a href="#78671" title="Option[Array[Byte]]">minKey</a>,<a href="#78672" title="Option[Array[Byte]]">maxKey</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">TestSetRequest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78727">key</a>, <a title="Option[Array[Byte]]" id="78728">value</a>, <a title="Option[Array[Byte]]" id="78729">expectedValue</a><span class="delimiter">)</span> =&gt; <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(success: Boolean)edu.berkeley.cs.scads.comm.TestSetResponse">TestSetResponse</span><span class="delimiter">(</span><a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65757" title="(key: Array[Byte], value: Option[Array[Byte]], expectedValue: Option[Array[Byte]])Boolean">testAndSet</a><span class="delimiter">(</span><a href="#78727" title="Array[Byte]">key</a>,<a href="#78728" title="Option[Array[Byte]]">value</a>,<a href="#78729" title="Option[Array[Byte]]">expectedValue</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">CursorScanRequest</span><span class="delimiter">(</span><a title="Option[Int]" id="78768">optCursorId</a>, <a title="Int" id="78769">recsPerMessage</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Unit" id="78770">bsm</a>:<a href="BdbParitionHandler.scala.html#9756" title="edu.berkeley.cs.scads.storage.BdbStorageManager">BdbStorageManager</a> =&gt; <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="#78772" title="(Option[Int], IndexedSeq[edu.berkeley.cs.scads.comm.Record])" class="delimiter">(</a><a href="#78771" title="Option[Int]" id="78772">cid</a>,<a href="#78771" title="IndexedSeq[edu.berkeley.cs.scads.comm.Record]" id="78773">recs</a><span class="delimiter">)</span> = <a href="#78770" title="edu.berkeley.cs.scads.storage.BdbStorageManager">bsm</a>.<a href="BdbParitionHandler.scala.html#65832" title="(optCursorId: Option[Int], recsPerMessage: Int)(Option[Int], IndexedSeq[edu.berkeley.cs.scads.comm.Record])">cursorScan</a><span title="(Option[Int], IndexedSeq[edu.berkeley.cs.scads.comm.Record]) @unchecked" class="delimiter">(</span><a href="#78768" title="Option[Int]">optCursorId</a>, <a href="#78769" title="Int">recsPerMessage</a><span class="delimiter">)</span>
              <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(cursorId: Option[Int], records: IndexedSeq[edu.berkeley.cs.scads.comm.Record])edu.berkeley.cs.scads.comm.CursorScanResponse">CursorScanResponse</span><span class="delimiter">(</span><a href="#78772" title="Option[Int]">cid</a>,<a href="#78773" title="IndexedSeq[edu.berkeley.cs.scads.comm.Record]">recs</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#78520" title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">src</a>.<span title="(f: edu.berkeley.cs.scads.comm.RemoteActorProxy =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#78791" title="edu.berkeley.cs.scads.comm.RemoteActorProxy">_</a> <a href="#79145" title="(body: edu.berkeley.cs.scads.comm.MessageBody)(implicit sender: edu.berkeley.cs.scads.comm.RemoteActorProxy)Unit">!</a> <span title="(cause: String, stacktrace: String)edu.berkeley.cs.scads.comm.ProcessingException">ProcessingException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;CursorScan only available for BdbStorageManagers&quot;)" class="string">&quot;CursorScan only available for BdbStorageManagers&quot;</span>,<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> 
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">CopyDataRequest</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.PartitionService" id="78841">src</a>, <a title="Boolean" id="78842">overwrite</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65763" title="(src: edu.berkeley.cs.scads.comm.PartitionService, overwrite: Boolean)Unit">copyData</a><span class="delimiter">(</span><a href="#78841" title="edu.berkeley.cs.scads.comm.PartitionService">src</a>,<a href="#78842" title="Boolean">overwrite</a><span class="delimiter">)</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.CopyDataResponse">CopyDataResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">GetResponsibilityRequest</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="(Option[Array[Byte]], Option[Array[Byte]])" id="78843">resp</a> = <a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65764" title="()(Option[Array[Byte]], Option[Array[Byte]])">getResponsibility</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(startKey: Option[Array[Byte]], endKey: Option[Array[Byte]])edu.berkeley.cs.scads.comm.GetResponsibilityResponse">GetResponsibilityResponse</span><span class="delimiter">(</span><a href="#78843" title="(Option[Array[Byte]], Option[Array[Byte]])">resp</a>.<span title="=&gt; Option[Array[Byte]]">_1</span>,<a href="#78843" title="(Option[Array[Byte]], Option[Array[Byte]])">resp</a>.<span title="=&gt; Option[Array[Byte]]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
	<span class="keyword">case</span> <span title="Unit">GetWorkloadStats</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a href="#78849" title="(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" class="delimiter">(</a><a href="#78848" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78849">stats</a>,<a href="#78848" title="Long" id="78850">clearedTime</a><span class="delimiter">)</span> = <a href="#78264" title="()(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)">getWorkloadStats</a><span title="(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long) @unchecked" class="delimiter">(</span><span class="delimiter">)</span>
	  <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(getCount: Int, putCount: Int, statsSince: Long)edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">GetWorkloadStatsResponse</span><span class="delimiter">(</span><a href="#78849" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">stats</a>.<a href="#78282" title="=&gt; Int">gets</a>, <a href="#78849" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">stats</a>.<a href="#78283" title="=&gt; Int">puts</a>, <a href="#78850" title="Long">clearedTime</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">AggRequest</span><span class="delimiter">(</span><a title="Seq[String]" id="78868">groups</a>,<a title="String" id="78869">keyType</a>,<a title="String" id="78870">valType</a>,<a title="Seq[edu.berkeley.cs.scads.comm.AggFilter]" id="78871">filters</a>,<a title="Seq[edu.berkeley.cs.scads.comm.AggOp]" id="78872">aggs</a><span class="delimiter">)</span> =&gt; 
          <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(results: Seq[edu.berkeley.cs.scads.comm.GroupedAgg])edu.berkeley.cs.scads.comm.AggReply">AggReply</span><span class="delimiter">(</span><a href="#79142" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65765" title="(groups: Seq[String], keyType: String, valType: String, filters: Seq[edu.berkeley.cs.scads.comm.AggFilter], aggregates: Seq[edu.berkeley.cs.scads.comm.AggOp])Seq[edu.berkeley.cs.scads.comm.GroupedAgg]">applyAggregate</a><span class="delimiter">(</span><a href="#78868" title="Seq[String]">groups</a>,<a href="#78869" title="String">keyType</a>,<a href="#78870" title="String">valType</a>,<a href="#78871" title="Seq[edu.berkeley.cs.scads.comm.AggFilter]">filters</a>,<a href="#78872" title="Seq[edu.berkeley.cs.scads.comm.AggOp]">aggs</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#78520" title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">src</a>.<span title="(f: edu.berkeley.cs.scads.comm.RemoteActorProxy =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#78878" title="edu.berkeley.cs.scads.comm.RemoteActorProxy">_</a> <a href="#79145" title="(body: edu.berkeley.cs.scads.comm.MessageBody)(implicit sender: edu.berkeley.cs.scads.comm.RemoteActorProxy)Unit">!</a> <span title="(cause: String, stacktrace: String)edu.berkeley.cs.scads.comm.ProcessingException">ProcessingException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Not Implemented&quot;)" class="string">&quot;Not Implemented&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="Unit" id="78884">r</a>:<a href="#9817" title="edu.berkeley.cs.scads.storage.RequestRejectedException">RequestRejectedException</a> =&gt; <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(reason: String, req: edu.berkeley.cs.scads.comm.MessageBody)edu.berkeley.cs.scads.comm.RequestRejected">RequestRejected</span><span class="delimiter">(</span><a href="#78884" title="edu.berkeley.cs.scads.storage.RequestRejectedException">r</a>.<span title="()java.lang.String">getMessage</span><span class="delimiter">(</span><span class="delimiter">)</span>,<a href="#78521" title="edu.berkeley.cs.scads.comm.PartitionServiceOperation">msg</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="Unit" id="78932">e</a>:<span title="Exception">Exception</span> =&gt; <span class="delimiter">{</span>
        <a href="#78238" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Exception processing request&quot;)" class="string">&quot;Exception processing request&quot;</span><span class="delimiter">)</span>
        <a href="#78932" title="Exception">e</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#78525" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(cause: String, stacktrace: String)edu.berkeley.cs.scads.comm.ProcessingException">ProcessingException</span><span class="delimiter">(</span><a href="#78932" title="Exception">e</a>.<span title="()java.lang.String">getMessage</span>, <a href="#78932" title="Exception">e</a>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  

<span class="delimiter">}</span>


        </pre>
    </body>
</html>