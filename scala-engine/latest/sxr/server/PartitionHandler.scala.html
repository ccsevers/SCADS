<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>server/PartitionHandler.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.storage

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> net.lag.logging.Logger
<span class="keyword">import</span> scala.collection.mutable.ArrayBuffer
<span class="keyword">import</span> java.io.<span class="delimiter">{</span>BufferedReader,ObjectInputStream,InputStream,InputStreamReader,ByteArrayInputStream<span class="delimiter">}</span>
<span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger

<span class="comment">// keep track of number of gets and puts</span>
case <span class="keyword">class</span> <a title="class PartitionWorkloadStats extends java.lang.Object with ScalaObject with Product with Serializable" id="79111">PartitionWorkloadStats</a><a href="#79111" title="ScalaObject" class="delimiter">(</a><span class="keyword">var</span> <a title="Int" id="78244">gets</a>:<span title="Int">Int</span>, <span class="keyword">var</span> <a title="Int" id="78245">puts</a>:<span title="Int">Int</span><span class="delimiter">)</span>

<span class="comment">// Used for bulk puts of urls</span>
<span class="keyword">abstract</span> <span class="keyword">trait</span> <a title="trait RecParser extends java.lang.Object with Serializable with ScalaObject" id="9812">RecParser</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Serializable">Serializable</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(location: String)Unit" id="49880">setLocation</a><span class="delimiter">(</span><a title="String" id="70046">location</a>:<span title="String">String</span><span class="delimiter">)</span>:<span title="Unit">Unit</span> = <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(in: java.io.InputStream)Unit" id="49881">setInput</a><span class="delimiter">(</span><a title="java.io.InputStream" id="70171">in</a>:<span title="java.io.InputStream">InputStream</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="()(AnyRef, AnyRef)" id="49882">getNext</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="(AnyRef, AnyRef)" class="delimiter">(</span>AnyRef,AnyRef<span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class RequestRejectedException extends java.lang.Exception with ScalaObject" id="9813">RequestRejectedException</a><a href="#9813" title="ScalaObject" class="delimiter">(</a><a title="String" id="74023">e</a>:<span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="java.lang.Exception">Exception</span><span class="delimiter">(</span><a href="#74023" title="String">e</a><span class="delimiter">)</span>

<span class="comment">/* Everything at this level is done in Array[Byte] packets as all these methods
 * get called as a result of receiving Avro messages and their responses
 * will also go out as Avro messages.  Converting these bytes to an internal
 * representation, or using them as is, is left to the StorageManager */</span>
<span class="keyword">abstract</span> <span class="keyword">trait</span> <a title="trait StorageManager extends java.lang.Object" id="9814">StorageManager</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(key: Array[Byte])Option[Array[Byte]]" id="65748">get</a><span class="delimiter">(</span><a title="Array[Byte]" id="69853">key</a>:<span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(key: Array[Byte], value: Option[Array[Byte]])Unit" id="65749">put</a><span class="delimiter">(</span><a title="Array[Byte]" id="69941">key</a>:<span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>,<a title="Option[Array[Byte]]" id="69942">value</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="(key: Array[Byte], value: Option[Array[Byte]], expectedValue: Option[Array[Byte]])Boolean" id="65750">testAndSet</a><span class="delimiter">(</span><a title="Array[Byte]" id="69955">key</a>:<span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="69956">value</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="69957">expectedValue</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Boolean">Boolean</span>
  <span class="comment">// bit odd to have PutRequest in here, but would probable be a performance hit to do it another way</span>
  <span class="keyword">def</span> <a title="(parser: edu.berkeley.cs.scads.storage.RecParser, locations: Seq[String])Unit" id="65751">bulkUrlPut</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.RecParser" id="70024">parser</a>:<a href="#9812" title="edu.berkeley.cs.scads.storage.RecParser">RecParser</a>, <a title="Seq[String]" id="70025">locations</a>:<span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(records: Seq[edu.berkeley.cs.scads.comm.PutRequest])Unit" id="65752">bulkPut</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.PutRequest]" id="70191">records</a>:<span title="Seq[edu.berkeley.cs.scads.comm.PutRequest]">Seq</span><span class="delimiter">[</span>PutRequest<span class="delimiter">]</span><span class="delimiter">)</span> 
  <span class="comment">// cursorscanrequest?</span>
  <span class="keyword">def</span> <a title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]], limit: Option[Int], offset: Option[Int], ascending: Boolean)Seq[edu.berkeley.cs.scads.comm.Record]" id="65753">getRange</a><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="70228">minKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="70229">maxKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Int]" id="70230">limit</a>:<span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Option[Int]" id="70231">offset</a>:<span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="Boolean" id="70232">ascending</a>:<span title="Boolean">Boolean</span><span class="delimiter">)</span>:<span title="Seq[edu.berkeley.cs.scads.comm.Record]">Seq</span><span class="delimiter">[</span>Record<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(ranges: Seq[edu.berkeley.cs.scads.comm.MessageBody])scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.comm.GetRangeResponse]" id="65754">getBatch</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.MessageBody]" id="70314">ranges</a>:<span title="Seq[edu.berkeley.cs.scads.comm.MessageBody]">Seq</span><span class="delimiter">[</span>MessageBody<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.comm.GetRangeResponse]">ArrayBuffer</span><span class="delimiter">[</span>GetRangeResponse<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]])Int" id="65755">countRange</a><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="70413">minKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Option[Array[Byte]]" id="70414">maxKey</a>:<span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Int">Int</span>
  <span class="keyword">def</span> <a title="(src: edu.berkeley.cs.scads.comm.PartitionService, overwrite: Boolean)Unit" id="65756">copyData</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.PartitionService" id="70433">src</a>:<span title="edu.berkeley.cs.scads.comm.PartitionService">PartitionService</span>, <a title="Boolean" id="70434">overwrite</a>:<span title="Boolean">Boolean</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()(Option[Array[Byte]], Option[Array[Byte]])" id="65757">getResponsibility</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="(Option[Array[Byte]], Option[Array[Byte]])" class="delimiter">(</span>Option<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span>,Option<span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="comment">//def deleteRange(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]], txn: Option[Transaction])</span>
  <span class="keyword">def</span> <a title="(groups: Seq[String], keyType: String, valType: String, filters: Seq[edu.berkeley.cs.scads.comm.AggFilter], aggregates: Seq[edu.berkeley.cs.scads.comm.AggOp])Seq[edu.berkeley.cs.scads.comm.GroupedAgg]" id="65758">applyAggregate</a><span class="delimiter">(</span><a title="Seq[String]" id="70512">groups</a>:<span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span>,
                     <a title="String" id="70513">keyType</a>:<span title="String">String</span>,
                     <a title="String" id="70514">valType</a>:<span title="String">String</span>,
                     <a title="Seq[edu.berkeley.cs.scads.comm.AggFilter]" id="70515">filters</a>:<span title="Seq[edu.berkeley.cs.scads.comm.AggFilter]">Seq</span><span class="delimiter">[</span>AggFilter<span class="delimiter">]</span>,
                     <a title="Seq[edu.berkeley.cs.scads.comm.AggOp]" id="70516">aggregates</a>:<span title="Seq[edu.berkeley.cs.scads.comm.AggOp]">Seq</span><span class="delimiter">[</span>AggOp<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="Seq[edu.berkeley.cs.scads.comm.GroupedAgg]">Seq</span><span class="delimiter">[</span>GroupedAgg<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="()Unit" id="65759">startup</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
  <span class="keyword">def</span> <a title="()Unit" id="65760">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span>
<span class="delimiter">}</span>


case <span class="keyword">class</span> <a title="class PartitionHandler extends java.lang.Object with edu.berkeley.cs.scads.comm.ServiceHandler[edu.berkeley.cs.scads.comm.PartitionServiceOperation] with ScalaObject with Product with Serializable" id="79107">PartitionHandler</a><a href="#79107" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.StorageManager" id="79104">manager</a>:<a href="#9814" title="edu.berkeley.cs.scads.storage.StorageManager">StorageManager</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.scads.comm.ServiceHandler[edu.berkeley.cs.scads.comm.PartitionServiceOperation]">ServiceHandler</span><span class="delimiter">[</span>PartitionServiceOperation<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="78200">logger</a> = <span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;PartitionHandler&quot;)" class="string">&quot;PartitionHandler&quot;</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="78202">startup</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span> = <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65759" title="()Unit">startup</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="78203">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="Unit">Unit</span> = <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65760" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>


  <span class="comment">// workload stats code</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78205">currentStats</a> = <a href="#79111" title="(gets: Int, puts: Int)edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78208">completedStats</a> = <a href="#79111" title="(gets: Int, puts: Int)edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Long" id="78211">statsClearedTime</a> = <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Int" id="78213">statWindowTime</a> = <span class="int">20</span><span title="Int(20000)">*</span><span class="int">1000</span> <span class="comment">// ms, how long a window to maintain stats for</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Int" id="78215">clearStatWindowsTime</a> = <span class="int">60</span><span title="Int(60000)">*</span><span class="int">1000</span> <span class="comment">// ms, keep long to keep stats around, in all windows</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="List[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]" id="78218">statWindows</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#78215" title="=&gt; Int">clearStatWindowsTime</a><span title="(x: Int)Int">/</span><a href="#78213" title="=&gt; Int">statWindowTime</a><span class="delimiter">)</span>
    .<span title="(f: Int =&gt; (java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger),scala.collection.immutable.IndexedSeq[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]])scala.collection.immutable.IndexedSeq[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger),scala.collection.immutable.IndexedSeq[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]]" class="delimiter">{</span><a title="Int" id="78399">_</a>=&gt;<span title="(_1: java.util.concurrent.atomic.AtomicInteger, _2: java.util.concurrent.atomic.AtomicInteger)(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)" class="delimiter">(</span><span title="()java.util.concurrent.atomic.AtomicInteger" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span>,<span title="()java.util.concurrent.atomic.AtomicInteger" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span><span class="delimiter">)</span><span class="delimiter">}</span>.<span title="=&gt; List[(java.util.concurrent.atomic.AtomicInteger, java.util.concurrent.atomic.AtomicInteger)]">toList</span> <span class="comment">// (get,put) for each window</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Double" id="78220">getSamplingRate</a> = <span title="Double(1.0)" class="double">1.0</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="Double" id="78222">putSamplingRate</a> = <span title="Double(1.0)" class="double">1.0</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.Random" id="78224">samplerRandom</a> = <span title="java.util.Random" class="keyword">new</span> java.util.<span title="java.util.Random">Random</span>

  <span class="keyword">def</span> <a title="()(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" id="78226">getWorkloadStats</a><span class="delimiter">(</span><span class="delimiter">)</span>:<span title="(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" class="delimiter">(</span>PartitionWorkloadStats,Long<span class="delimiter">)</span> = <span title="(_1: edu.berkeley.cs.scads.storage.PartitionWorkloadStats, _2: Long)(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" class="delimiter">(</span><a href="#78208" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">completedStats</a>,<a href="#78211" title="=&gt; Long">statsClearedTime</a><span class="delimiter">)</span>
  <span class="comment">/**
  * set the current stats as the last completed interval, used when stats are queried
  * zero out the current stats to start a new interval
  * return the old completed interval for archiving
  */</span>
  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78227">resetWorkloadStats</a><span class="delimiter">(</span><span class="delimiter">)</span>:<a href="#79111" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78465">ret</a> = <a href="#78208" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">completedStats</a>
    <a href="#78208" title="(x$1: edu.berkeley.cs.scads.storage.PartitionWorkloadStats)Unit">completedStats</a> = <a href="#78205" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">currentStats</a>
    <a href="#78211" title="(x$1: Long)Unit">statsClearedTime</a> = <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#78205" title="(x$1: edu.berkeley.cs.scads.storage.PartitionWorkloadStats)Unit">currentStats</a> = <a href="#79111" title="(gets: Int, puts: Int)edu.berkeley.cs.scads.storage.PartitionWorkloadStats">PartitionWorkloadStats</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <a href="#78465" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">ret</a>
  <span class="delimiter">}</span>
  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="(num: Int)Unit" id="78228">incrementGetCount</a><span class="delimiter">(</span><a title="Int" id="78466">num</a>:<span title="Int">Int</span><span class="delimiter">)</span> = <a href="#78205" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">currentStats</a>.<a href="#78244" title="(x$1: Int)Unit">gets</a> <span title="(x: Int)Int">+=</span> <a href="#78466" title="Int">num</a>
  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="(num: Int)Unit" id="78229">incrementPutCount</a><span class="delimiter">(</span><a title="Int" id="78474">num</a>:<span title="Int">Int</span><span class="delimiter">)</span> = <a href="#78205" title="=&gt; edu.berkeley.cs.scads.storage.PartitionWorkloadStats">currentStats</a>.<a href="#78245" title="(x$1: Int)Unit">puts</a> <span title="(x: Int)Int">+=</span> <a href="#78474" title="Int">num</a>
  <span class="comment">// end workload stats stuff</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(src: Option[edu.berkeley.cs.scads.comm.RemoteActorProxy], msg: edu.berkeley.cs.scads.comm.PartitionServiceOperation)Unit" id="78230">process</a><span class="delimiter">(</span><a title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]" id="78482">src</a>: <span title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">Option</span><span class="delimiter">[</span>RemoteActorProxy<span class="delimiter">]</span>, <a title="edu.berkeley.cs.scads.comm.PartitionServiceOperation" id="78483">msg</a>: <span title="edu.berkeley.cs.scads.comm.PartitionServiceOperation">PartitionServiceOperation</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit" id="78487">reply</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.MessageBody" id="78488">msg</a>: <span title="edu.berkeley.cs.scads.comm.MessageBody">MessageBody</span><span class="delimiter">)</span> = <a href="#78482" title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">src</a>.<span title="(f: edu.berkeley.cs.scads.comm.RemoteActorProxy =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#78493" title="edu.berkeley.cs.scads.comm.RemoteActorProxy">_</a> <a href="#79107" title="(body: edu.berkeley.cs.scads.comm.MessageBody)(implicit sender: edu.berkeley.cs.scads.comm.RemoteActorProxy)Unit">!</a> <a href="#78488" title="edu.berkeley.cs.scads.comm.MessageBody">msg</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#78483" title="edu.berkeley.cs.scads.comm.PartitionServiceOperation">msg</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">GetRequest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78497">key</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#78224" title="=&gt; java.util.Random">samplerRandom</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#78220" title="=&gt; Double">getSamplingRate</a><span class="delimiter">)</span> <a href="#78228" title="(num: Int)Unit">incrementGetCount</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(value: Option[Array[Byte]])edu.berkeley.cs.scads.comm.GetResponse">GetResponse</span><span class="delimiter">(</span><a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65748" title="(key: Array[Byte])Option[Array[Byte]]">get</a><span class="delimiter">(</span><a href="#78497" title="Array[Byte]">key</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">PutRequest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78505">key</a>,<a title="Option[Array[Byte]]" id="78506">value</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65749" title="(key: Array[Byte], value: Option[Array[Byte]])Unit">put</a><span class="delimiter">(</span><a href="#78505" title="Array[Byte]">key</a>,<a href="#78506" title="Option[Array[Byte]]">value</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#78224" title="=&gt; java.util.Random">samplerRandom</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#78222" title="=&gt; Double">putSamplingRate</a><span class="delimiter">)</span> <a href="#78229" title="(num: Int)Unit">incrementPutCount</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.PutResponse">PutResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">BulkUrlPutReqest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78537">parserBytes</a>, <a title="Seq[String]" id="78538">locations</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="java.io.ObjectInputStream" id="78539">ois</a> = <span title="java.io.ObjectInputStream" class="keyword">new</span> <span title="java.io.ObjectInputStream">ObjectInputStream</span><span class="delimiter">(</span><span title="java.io.ByteArrayInputStream" class="keyword">new</span> <span title="java.io.ByteArrayInputStream">ByteArrayInputStream</span><span class="delimiter">(</span><a href="#78537" title="Array[Byte]">parserBytes</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.RecParser" id="78540">parser</a> = <a href="#78539" title="java.io.ObjectInputStream">ois</a>.<span title="()java.lang.Object">readObject</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="edu.berkeley.cs.scads.storage.RecParser" class="delimiter">[</span><a href="#9812" title="edu.berkeley.cs.scads.storage.RecParser">RecParser</a><span class="delimiter">]</span>
          <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65751" title="(parser: edu.berkeley.cs.scads.storage.RecParser, locations: Seq[String])Unit">bulkUrlPut</a><span class="delimiter">(</span><a href="#78540" title="edu.berkeley.cs.scads.storage.RecParser">parser</a>,<a href="#78538" title="Seq[String]">locations</a><span class="delimiter">)</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.BulkPutResponse">BulkPutResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">BulkPutRequest</span><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.PutRequest]" id="78545">records</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65752" title="(records: Seq[edu.berkeley.cs.scads.comm.PutRequest])Unit">bulkPut</a><span class="delimiter">(</span><a href="#78545" title="Seq[edu.berkeley.cs.scads.comm.PutRequest]">records</a><span class="delimiter">)</span>
          <span class="comment">/*if (samplerRandom.nextDouble &lt;= putSamplingRate) incrementPutCount(reccount)*/</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.BulkPutResponse">BulkPutResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">GetRangeRequest</span><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="78547">minKey</a>, <a title="Option[Array[Byte]]" id="78548">maxKey</a>, <a title="Option[Int]" id="78549">limit</a>, <a title="Option[Int]" id="78550">offset</a>, <a title="Boolean" id="78551">ascending</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#78224" title="=&gt; java.util.Random">samplerRandom</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;=</span> <a href="#78220" title="=&gt; Double">getSamplingRate</a><span class="delimiter">)</span> <a href="#78228" title="(num: Int)Unit">incrementGetCount</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="comment">/*reccount*/</span><span class="delimiter">)</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(records: Seq[edu.berkeley.cs.scads.comm.Record])edu.berkeley.cs.scads.comm.GetRangeResponse">GetRangeResponse</span><span class="delimiter">(</span><a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65753" title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]], limit: Option[Int], offset: Option[Int], ascending: Boolean)Seq[edu.berkeley.cs.scads.comm.Record]">getRange</a><span class="delimiter">(</span><a href="#78547" title="Option[Array[Byte]]">minKey</a>,<a href="#78548" title="Option[Array[Byte]]">maxKey</a>,<a href="#78549" title="Option[Int]">limit</a>,<a href="#78550" title="Option[Int]">offset</a>,<a href="#78551" title="Boolean">ascending</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">BatchRequest</span><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.comm.MessageBody]" id="78594">ranges</a><span class="delimiter">)</span> =&gt;
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(ranges: Seq[edu.berkeley.cs.scads.comm.MessageBody])edu.berkeley.cs.scads.comm.BatchResponse">BatchResponse</span><span class="delimiter">(</span><a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65754" title="(ranges: Seq[edu.berkeley.cs.scads.comm.MessageBody])scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.comm.GetRangeResponse]">getBatch</a><span class="delimiter">(</span><a href="#78594" title="Seq[edu.berkeley.cs.scads.comm.MessageBody]">ranges</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">CountRangeRequest</span><span class="delimiter">(</span><a title="Option[Array[Byte]]" id="78633">minKey</a>,<a title="Option[Array[Byte]]" id="78634">maxKey</a><span class="delimiter">)</span> =&gt; <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(count: Int)edu.berkeley.cs.scads.comm.CountRangeResponse">CountRangeResponse</span><span class="delimiter">(</span><a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65755" title="(minKey: Option[Array[Byte]], maxKey: Option[Array[Byte]])Int">countRange</a><span class="delimiter">(</span><a href="#78633" title="Option[Array[Byte]]">minKey</a>,<a href="#78634" title="Option[Array[Byte]]">maxKey</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">TestSetRequest</span><span class="delimiter">(</span><a title="Array[Byte]" id="78689">key</a>, <a title="Option[Array[Byte]]" id="78690">value</a>, <a title="Option[Array[Byte]]" id="78691">expectedValue</a><span class="delimiter">)</span> =&gt; <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(success: Boolean)edu.berkeley.cs.scads.comm.TestSetResponse">TestSetResponse</span><span class="delimiter">(</span><a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65750" title="(key: Array[Byte], value: Option[Array[Byte]], expectedValue: Option[Array[Byte]])Boolean">testAndSet</a><span class="delimiter">(</span><a href="#78689" title="Array[Byte]">key</a>,<a href="#78690" title="Option[Array[Byte]]">value</a>,<a href="#78691" title="Option[Array[Byte]]">expectedValue</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">CursorScanRequest</span><span class="delimiter">(</span><a title="Option[Int]" id="78730">optCursorId</a>, <a title="Int" id="78731">recsPerMessage</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Unit" id="78732">bsm</a>:<a href="BdbParitionHandler.scala.html#9752" title="edu.berkeley.cs.scads.storage.BdbStorageManager">BdbStorageManager</a> =&gt; <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="#78734" title="(Option[Int], IndexedSeq[edu.berkeley.cs.scads.comm.Record])" class="delimiter">(</a><a href="#78733" title="Option[Int]" id="78734">cid</a>,<a href="#78733" title="IndexedSeq[edu.berkeley.cs.scads.comm.Record]" id="78735">recs</a><span class="delimiter">)</span> = <a href="#78732" title="edu.berkeley.cs.scads.storage.BdbStorageManager">bsm</a>.<a href="BdbParitionHandler.scala.html#65825" title="(optCursorId: Option[Int], recsPerMessage: Int)(Option[Int], IndexedSeq[edu.berkeley.cs.scads.comm.Record])">cursorScan</a><span title="(Option[Int], IndexedSeq[edu.berkeley.cs.scads.comm.Record]) @unchecked" class="delimiter">(</span><a href="#78730" title="Option[Int]">optCursorId</a>, <a href="#78731" title="Int">recsPerMessage</a><span class="delimiter">)</span>
              <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(cursorId: Option[Int], records: IndexedSeq[edu.berkeley.cs.scads.comm.Record])edu.berkeley.cs.scads.comm.CursorScanResponse">CursorScanResponse</span><span class="delimiter">(</span><a href="#78734" title="Option[Int]">cid</a>,<a href="#78735" title="IndexedSeq[edu.berkeley.cs.scads.comm.Record]">recs</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#78482" title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">src</a>.<span title="(f: edu.berkeley.cs.scads.comm.RemoteActorProxy =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#78753" title="edu.berkeley.cs.scads.comm.RemoteActorProxy">_</a> <a href="#79107" title="(body: edu.berkeley.cs.scads.comm.MessageBody)(implicit sender: edu.berkeley.cs.scads.comm.RemoteActorProxy)Unit">!</a> <span title="(cause: String, stacktrace: String)edu.berkeley.cs.scads.comm.ProcessingException">ProcessingException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;CursorScan only available for BdbStorageManagers&quot;)" class="string">&quot;CursorScan only available for BdbStorageManagers&quot;</span>,<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> 
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">CopyDataRequest</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.PartitionService" id="78803">src</a>, <a title="Boolean" id="78804">overwrite</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65756" title="(src: edu.berkeley.cs.scads.comm.PartitionService, overwrite: Boolean)Unit">copyData</a><span class="delimiter">(</span><a href="#78803" title="edu.berkeley.cs.scads.comm.PartitionService">src</a>,<a href="#78804" title="Boolean">overwrite</a><span class="delimiter">)</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="()edu.berkeley.cs.scads.comm.CopyDataResponse">CopyDataResponse</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">GetResponsibilityRequest</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="(Option[Array[Byte]], Option[Array[Byte]])" id="78805">resp</a> = <a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65757" title="()(Option[Array[Byte]], Option[Array[Byte]])">getResponsibility</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(startKey: Option[Array[Byte]], endKey: Option[Array[Byte]])edu.berkeley.cs.scads.comm.GetResponsibilityResponse">GetResponsibilityResponse</span><span class="delimiter">(</span><a href="#78805" title="(Option[Array[Byte]], Option[Array[Byte]])">resp</a>.<span title="=&gt; Option[Array[Byte]]">_1</span>,<a href="#78805" title="(Option[Array[Byte]], Option[Array[Byte]])">resp</a>.<span title="=&gt; Option[Array[Byte]]">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
	<span class="keyword">case</span> <span title="Unit">GetWorkloadStats</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a href="#78811" title="(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)" class="delimiter">(</a><a href="#78810" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats" id="78811">stats</a>,<a href="#78810" title="Long" id="78812">clearedTime</a><span class="delimiter">)</span> = <a href="#78226" title="()(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long)">getWorkloadStats</a><span title="(edu.berkeley.cs.scads.storage.PartitionWorkloadStats, Long) @unchecked" class="delimiter">(</span><span class="delimiter">)</span>
	  <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(getCount: Int, putCount: Int, statsSince: Long)edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">GetWorkloadStatsResponse</span><span class="delimiter">(</span><a href="#78811" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">stats</a>.<a href="#78244" title="=&gt; Int">gets</a>, <a href="#78811" title="edu.berkeley.cs.scads.storage.PartitionWorkloadStats">stats</a>.<a href="#78245" title="=&gt; Int">puts</a>, <a href="#78812" title="Long">clearedTime</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">AggRequest</span><span class="delimiter">(</span><a title="Seq[String]" id="78830">groups</a>,<a title="String" id="78831">keyType</a>,<a title="String" id="78832">valType</a>,<a title="Seq[edu.berkeley.cs.scads.comm.AggFilter]" id="78833">filters</a>,<a title="Seq[edu.berkeley.cs.scads.comm.AggOp]" id="78834">aggs</a><span class="delimiter">)</span> =&gt; 
          <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(results: Seq[edu.berkeley.cs.scads.comm.GroupedAgg])edu.berkeley.cs.scads.comm.AggReply">AggReply</span><span class="delimiter">(</span><a href="#79104" title="=&gt; edu.berkeley.cs.scads.storage.StorageManager">manager</a>.<a href="#65758" title="(groups: Seq[String], keyType: String, valType: String, filters: Seq[edu.berkeley.cs.scads.comm.AggFilter], aggregates: Seq[edu.berkeley.cs.scads.comm.AggOp])Seq[edu.berkeley.cs.scads.comm.GroupedAgg]">applyAggregate</a><span class="delimiter">(</span><a href="#78830" title="Seq[String]">groups</a>,<a href="#78831" title="String">keyType</a>,<a href="#78832" title="String">valType</a>,<a href="#78833" title="Seq[edu.berkeley.cs.scads.comm.AggFilter]">filters</a>,<a href="#78834" title="Seq[edu.berkeley.cs.scads.comm.AggOp]">aggs</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#78482" title="Option[edu.berkeley.cs.scads.comm.RemoteActorProxy]">src</a>.<span title="(f: edu.berkeley.cs.scads.comm.RemoteActorProxy =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#78840" title="edu.berkeley.cs.scads.comm.RemoteActorProxy">_</a> <a href="#79107" title="(body: edu.berkeley.cs.scads.comm.MessageBody)(implicit sender: edu.berkeley.cs.scads.comm.RemoteActorProxy)Unit">!</a> <span title="(cause: String, stacktrace: String)edu.berkeley.cs.scads.comm.ProcessingException">ProcessingException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Not Implemented&quot;)" class="string">&quot;Not Implemented&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="Unit" id="78846">r</a>:<a href="#9813" title="edu.berkeley.cs.scads.storage.RequestRejectedException">RequestRejectedException</a> =&gt; <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(reason: String, req: edu.berkeley.cs.scads.comm.MessageBody)edu.berkeley.cs.scads.comm.RequestRejected">RequestRejected</span><span class="delimiter">(</span><a href="#78846" title="edu.berkeley.cs.scads.storage.RequestRejectedException">r</a>.<span title="()java.lang.String">getMessage</span><span class="delimiter">(</span><span class="delimiter">)</span>,<a href="#78483" title="edu.berkeley.cs.scads.comm.PartitionServiceOperation">msg</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="Unit" id="78894">e</a>:<span title="Exception">Exception</span> =&gt; <span class="delimiter">{</span>
        <a href="#78200" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Exception processing request&quot;)" class="string">&quot;Exception processing request&quot;</span><span class="delimiter">)</span>
        <a href="#78894" title="Exception">e</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#78487" title="(msg: edu.berkeley.cs.scads.comm.MessageBody)Unit">reply</a><span class="delimiter">(</span><span title="(cause: String, stacktrace: String)edu.berkeley.cs.scads.comm.ProcessingException">ProcessingException</span><span class="delimiter">(</span><a href="#78894" title="Exception">e</a>.<span title="()java.lang.String">getMessage</span>, <a href="#78894" title="Exception">e</a>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  

<span class="delimiter">}</span>


        </pre>
    </body>
</html>