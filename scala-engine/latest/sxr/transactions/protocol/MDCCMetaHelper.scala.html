<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>transactions/protocol/MDCCMetaHelper.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.storage
<span class="keyword">package</span> transactions

<span class="keyword">import</span> scala.math.<span class="delimiter">{</span>min, max<span class="delimiter">}</span>
<span class="keyword">import</span> collection.mutable.<span class="delimiter">{</span>ArrayBuffer, ArraySeq<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object edu.berkeley.cs.scads.storage.transactions.MDCCMetaHelper" id="10403">MDCCMetaHelper</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean" id="95801">validateMeta</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100484">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100484" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100486">curRange</a> = <a href="#100484" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100487">restRange</a> = <a href="#100484" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a> <span title="(x: Boolean)Boolean">||</span> <a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Long">-</span> <a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#100484" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100484" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a>  <span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><a href="#100488" title="()Unit" class="delimiter">{</a>
      <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
      <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a><span class="delimiter">)</span>
      <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a><span class="delimiter">)</span>
      <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
      <a href="#100486" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a> =  <a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
      <a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a> = <a href="#100487" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">restRange</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
    <span class="delimiter">}</span>
    <span title="Nothing" class="keyword">return</span> <span title="Boolean(true)" class="keyword">true</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.MDCCBallot" id="95802">currentBallot</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100267">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a> <span class="delimiter">)</span> : <a href="../../Messages.scala.html#9662" title="edu.berkeley.cs.scads.storage.MDCCBallot">MDCCBallot</a> = <span class="delimiter">{</span>
    <a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#100267" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100559">range</a> = <a href="#100267" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
    <a href="../../Messages.scala.html#26709" title="(round: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallot">MDCCBallot</a><span class="delimiter">(</span><a href="#100267" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#100559" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">range</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>, <a href="#100559" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">range</a>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>, <a href="#100559" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">range</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95803">makeNextRoundFast</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100565">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span>: <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#100565" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100567">ballots</a> = <a href="#100565" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>
    <span class="keyword">val</span> <a title="Long" id="100568">nextRound</a> = <a href="#100565" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#100567" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100569">fastRound</a> = <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#100568" title="Long">nextRound</a>, <a href="#100568" title="Long">nextRound</a>, <a href="#100567" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>, <a href="#100567" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
    <a href="#100567" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a> = <a href="#95808" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100567" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#100569" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">fastRound</a><span class="delimiter">)</span>
    <a href="../../Messages.scala.html#26939" title="(currentRound: Long, ballots: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange])edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">(</span><a href="#100568" title="Long">nextRound</a>, <a href="#95807" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], curRound: Long)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">adjustRound</a><span class="delimiter">(</span><a href="#100567" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#100568" title="Long">nextRound</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95804">makeNextRoundClassic</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100595">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="edu.berkeley.cs.scads.storage.SCADSService" id="100596">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span>: <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100598">next</a> = <a href="#95805" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, startRound: Long, endRound: Long, r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCMetadata">makeClassicRounds</a><span class="delimiter">(</span><a href="#100595" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>, <a href="#100595" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>, <a href="#100595" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>, <a href="#100596" title="edu.berkeley.cs.scads.storage.SCADSService">r</a><span class="delimiter">)</span>
    <a href="#100598" title="edu.berkeley.cs.scads.storage.MDCCMetadata">next</a>.<a href="../../Messages.scala.html#26908" title="(x$1: Long)Unit">currentRound</a> <span title="(x: Int)Long">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#100598" title="edu.berkeley.cs.scads.storage.MDCCMetadata">next</a>.<a href="../../Messages.scala.html#26911" title="(x$1: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange])Unit">ballots</a> =  <a href="#95807" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], curRound: Long)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">adjustRound</a><span class="delimiter">(</span><a href="#100598" title="edu.berkeley.cs.scads.storage.MDCCMetadata">next</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#100598" title="edu.berkeley.cs.scads.storage.MDCCMetadata">next</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
    <a href="#100598" title="edu.berkeley.cs.scads.storage.MDCCMetadata">next</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, startRound: Long, endRound: Long, r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95805">makeClassicRounds</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100599">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="Long" id="100600">startRound</a>: <span title="Long">Long</span>, <a title="Long" id="100601">endRound</a>: <span title="Long">Long</span>, <a title="edu.berkeley.cs.scads.storage.SCADSService" id="100602">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>  = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#100599" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100619">ballots</a> = <a href="#100599" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100620">classicRound</a> = <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#100600" title="Long">startRound</a>, <a href="#100601" title="Long">endRound</a>, <span title="Int(0)" class="int">0</span>, <a href="#100602" title="edu.berkeley.cs.scads.storage.SCADSService">r</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <a href="#100619" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a> = <a href="#95808" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100619" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#100620" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">classicRound</a><span class="delimiter">)</span> <span class="comment">//sets the vote</span>
    <a href="../../Messages.scala.html#26939" title="(currentRound: Long, ballots: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange])edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">(</span><a href="#100599" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#100619" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95806">increaseRound</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100627">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#100627" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../Messages.scala.html#26939" title="(currentRound: Long, ballots: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange])edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">(</span><a href="#100627" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>, <a href="#95807" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], curRound: Long)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">adjustRound</a><span class="delimiter">(</span><a href="#100627" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#100627" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], curRound: Long)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="95807">adjustRound</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100592">ranges</a> : <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span>, <a title="Long" id="100593">curRound</a>: <span title="Long">Long</span><span class="delimiter">)</span> : <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" class="keyword">if</span><span class="delimiter">(</span><a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#100593" title="Long">curRound</a><span class="delimiter">)</span><span class="delimiter">{</span>
      <a href="#95807" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], curRound: Long)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">adjustRound</a><span class="delimiter">(</span><a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>, <a href="#100593" title="Long">curRound</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="keyword">else</span> <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" class="keyword">if</span> <span class="delimiter">(</span><a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#100593" title="Long">curRound</a><span class="delimiter">)</span> <span class="delimiter">{</span>
       <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><span title="(x: Long, y: Long)Long">max</span><span class="delimiter">(</span><a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a>, <a href="#100593" title="Long">curRound</a><span class="delimiter">)</span>, <a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a>,  <a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>, <a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>, <a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span> <a href="#100653" title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],edu.berkeley.cs.scads.storage.MDCCBallotRange,Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]])Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">+:</a> <a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
    <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
      <a href="#100592" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="95808">replace</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100589">ranges</a> : <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span>, <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100590">newRange</a>: <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">)</span>: <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100704">nRange</a> = <a href="#95809" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, inserted: Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100589" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>, <a href="#100590" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
    <a href="#100590" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>.<a href="../../Messages.scala.html#26780" title="(x$1: Int)Unit">vote</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#100704" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">nRange</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Insert the newRange into ranges and increases the vote count
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, inserted: Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="95809">replace</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100585">ranges</a> : <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span>, <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100586">newRange</a>: <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a>, <a title="Boolean" id="100587">inserted</a>  : <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span><span class="delimiter">{</span>
        <span title="Nothing" class="keyword">if</span> <span class="delimiter">(</span><a href="#100587" title="Boolean">inserted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Nothing" class="keyword">return</span> <span title="object Nil">Nil</span>
        <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
          <span title="Nothing" class="keyword">return</span> <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a> <a href="#100716" title="(x: edu.berkeley.cs.scads.storage.MDCCBallotRange)List[edu.berkeley.cs.scads.storage.MDCCBallotRange]">::</a> <span title="object Nil">Nil</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="Long" id="100713">nStart</a> = <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a>
      <span class="keyword">val</span> <a title="Long" id="100714">nEnd</a> = <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a>
      <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100715">head</a> = <a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#100713" title="Long">nStart</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Nothing" class="keyword">return</span> <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a> <a href="#100724" title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],edu.berkeley.cs.scads.storage.MDCCBallotRange,Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]])Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">+:</a> <a href="#95809" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, inserted: Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>, <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>, <a href="#100587" title="Boolean">inserted</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>.<a href="../../Messages.scala.html#26780" title="(x$1: Int)Unit">vote</a> = <span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#100587" title="Boolean">inserted</a><span class="delimiter">)</span> <span class="delimiter">{</span>
       <span title="Nothing" class="keyword">if</span> <span class="delimiter">(</span><a href="#100713" title="Long">nStart</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a><span class="delimiter">)</span><span class="delimiter">{</span>
        <span title="Nothing" class="keyword">return</span> <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a> <a href="#100781" title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],edu.berkeley.cs.scads.storage.MDCCBallotRange,Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]])Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">+:</a>  <a href="#95809" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, inserted: Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>, <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
       <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
        <span title="Nothing" class="keyword">return</span> <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a>, <a href="#100713" title="Long">nStart</a> <span title="(x: Int)Long">-</span> <span title="Int(1)" class="int">1</span>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span> <a href="#100828" title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],edu.berkeley.cs.scads.storage.MDCCBallotRange,Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]])Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">+:</a> <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a> <a href="#100833" title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],edu.berkeley.cs.scads.storage.MDCCBallotRange,Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]])Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">+:</a>  <a href="#95809" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, inserted: Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>, <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
       <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" class="keyword">if</span> <span class="delimiter">(</span><a href="#100714" title="Long">nEnd</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Nothing" class="keyword">return</span> <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#100714" title="Long">nEnd</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>, <a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span> <a href="#100926" title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],edu.berkeley.cs.scads.storage.MDCCBallotRange,Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]])Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">+:</a> <a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
      <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
        <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" class="keyword">if</span> <span class="delimiter">(</span><a href="#100715" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">head</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">==</span> <a href="#100714" title="Long">nEnd</a><span class="delimiter">)</span><span class="delimiter">{</span>
          <span title="Nothing" class="keyword">return</span> <a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
        <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
          <span title="Nothing" class="keyword">return</span> <a href="#95809" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, inserted: Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100585" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>, <a href="#100586" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

  <span class="delimiter">}</span>

   <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, startRound: Long, endRound: Long, fast: Boolean)(implicit r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCBallotRange" id="95810">getOwnershipRange</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100982">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="Long" id="100983">startRound</a> : <span title="Long">Long</span>, <a title="Long" id="100984">endRound</a> :<span title="Long">Long</span>, <a title="Boolean" id="100985">fast</a> : <span title="Boolean">Boolean</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="edu.berkeley.cs.scads.storage.SCADSService" id="100986">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="100988">ballots</a> = <a href="#100982" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="100989">newRange</a> = <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#100983" title="Long">startRound</a>, <a href="#100984" title="Long">endRound</a>, <span title="Int(0)" class="int">0</span>, <a href="#100986" title="edu.berkeley.cs.scads.storage.SCADSService">r</a>, <a href="#100985" title="Boolean">fast</a><span class="delimiter">)</span>
    <a href="#100988" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a> = <a href="#95808" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#100988" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#100989" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a><span class="delimiter">)</span>
    <a href="#100989" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a>
   <span class="delimiter">}</span>

   <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)(implicit r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCBallotRange" id="95811">getOwnershipRange</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="100994">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="edu.berkeley.cs.scads.storage.SCADSService" id="100995">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#100994" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#100994" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#100994" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#100994" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#100995" title="edu.berkeley.cs.scads.storage.SCADSService">r</a>, <a href="#100994" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
   <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, startRound: Long, endRound: Long, fast: Boolean)(implicit r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95812">getOwnership</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101005">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="Long" id="101006">startRound</a>: <span title="Long">Long</span>, <a title="Long" id="101007">endRound</a>: <span title="Long">Long</span>, <a title="Boolean" id="101008">fast</a> : <span title="Boolean">Boolean</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="edu.berkeley.cs.scads.storage.SCADSService" id="101009">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#101008" title="Boolean">fast</a> <span title="(x: Boolean)Boolean">||</span> <a href="#101007" title="Long">endRound</a> <span title="(x: Long)Long">-</span> <a href="#101006" title="Long">startRound</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>  <span class="comment">//it is not possible to have more than one fast round assigned</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#101006" title="Long">startRound</a> <span title="(x: Long)Boolean">==</span> <a href="#101005" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#101008" title="Boolean">fast</a> <span title="(x: Boolean)Boolean">==</span> <a href="#101005" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span> <span class="comment">//you are not allowed to change the current type</span>
    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="101011">ballots</a> = <a href="#101005" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101012">newRange</a> = <a href="../../Messages.scala.html#26838" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#101006" title="Long">startRound</a>, <a href="#101007" title="Long">endRound</a>, <span title="Int(0)" class="int">0</span>, <a href="#101009" title="edu.berkeley.cs.scads.storage.SCADSService">r</a>, <a href="#101008" title="Boolean">fast</a><span class="delimiter">)</span>

    <a href="#101011" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a> = <a href="#95808" title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], newRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">replace</a><span class="delimiter">(</span><a href="#101011" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>, <a href="#101012" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">newRange</a><span class="delimiter">)</span>
    <a href="../../Messages.scala.html#26939" title="(currentRound: Long, ballots: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange])edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">(</span><a href="#101005" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#101011" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(lMeta: edu.berkeley.cs.scads.storage.MDCCMetadata, rMeta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95813">combine</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101039">lMeta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101040">rMeta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>  = <span class="delimiter">{</span>

    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="101042">left</a>= <a href="#101039" title="edu.berkeley.cs.scads.storage.MDCCMetadata">lMeta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>
    <span class="keyword">var</span> <a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="101043">right</a> = <a href="#101040" title="edu.berkeley.cs.scads.storage.MDCCMetadata">rMeta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="101044">result</a>  = <span title="[A](elems: A*)scala.collection.mutable.ArrayBuffer[A]">ArrayBuffer</span><span title="(elems: edu.berkeley.cs.scads.storage.MDCCBallotRange*)scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]" class="delimiter">[</span><a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101045">curRange</a> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">var</span> <a title="Long" id="101046">firstRound</a> =  <span title="(x: Long, y: Long)Long">max</span><span class="delimiter">(</span><a href="#101039" title="edu.berkeley.cs.scads.storage.MDCCMetadata">lMeta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#101040" title="edu.berkeley.cs.scads.storage.MDCCMetadata">rMeta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Long" id="101047">curRound</a> : <span title="Long">Long</span> =  <a href="#101046" title="Long">firstRound</a>
    <span class="keyword">var</span> <a title="Long" id="101048">nextRound</a> : <span title="Long">Long</span> = <span title="Long(0L)" class="int">0</span>

    <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">{</span>
      <a href="#101049" title="Unit" class="keyword">if</a> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#101047" title="Long">curRound</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a> = <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
      <span class="delimiter">}</span><span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#101047" title="Long">curRound</a><span class="delimiter">)</span><span class="delimiter">{</span>
        <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a> = <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">tail</span>
      <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101075">dominant</a> =
          <span title="edu.berkeley.cs.scads.storage.MDCCBallotRange" class="keyword">if</span> <span class="delimiter">(</span><a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#101048" title="Long">nextRound</a> = <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>
            <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
          <span class="delimiter">}</span><span class="keyword">else</span> <span title="edu.berkeley.cs.scads.storage.MDCCBallotRange" class="keyword">if</span><span class="delimiter">(</span><a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#101048" title="Long">nextRound</a> = <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>
            <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span title="edu.berkeley.cs.scads.storage.MDCCBallotRange" class="keyword">if</span> <span class="delimiter">(</span><a href="#101047" title="Long">curRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a><span class="delimiter">)</span><span class="delimiter">{</span> <span class="comment">//Right is dominant</span>
            <a href="#101048" title="Long">nextRound</a> = <span title="(x: Long, y: Long)Long">min</span><span class="delimiter">(</span><a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a>, <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
          <span class="delimiter">}</span><span class="keyword">else</span> <span title="edu.berkeley.cs.scads.storage.MDCCBallotRange" class="keyword">if</span> <span class="delimiter">(</span><a href="#101047" title="Long">curRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a><span class="delimiter">)</span><span class="delimiter">{</span>  <span class="comment">//Left is dominant</span>
            <a href="#101048" title="Long">nextRound</a> = <span title="(x: Long, y: Long)Long">min</span><span class="delimiter">(</span><a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a>, <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
          <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
            <a href="#101048" title="Long">nextRound</a> = <span title="(x: Long, y: Long)Long">min</span><span class="delimiter">(</span><a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span>, <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Int)Long">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <span title="edu.berkeley.cs.scads.storage.MDCCBallotRange" class="keyword">if</span> <span class="delimiter">(</span><a href="#95822" title="(lRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, rRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Int">compareMetadataRound</a><span class="delimiter">(</span><a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>, <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">{</span>
              <a href="#101043" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">right</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
            <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
              <a href="#101042" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">left</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span><span class="delimiter">{</span>
          <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a> = <a href="#101075" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">dominant</a>.<a href="../../Messages.scala.html#26789" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">copy</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26774" title="(x$1: Long)Unit">startRound</a> = <a href="#101047" title="Long">curRound</a>
          <a href="#101047" title="Long">curRound</a> = <a href="#101048" title="Long">nextRound</a>
        <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#95822" title="(lRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, rRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Int">compareMetadataRound</a><span class="delimiter">(</span><a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>,<a href="#101075" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">dominant</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span> <span class="delimiter">)</span><span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101169">copy</a> = <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101170">curRange</a>.<a href="../../Messages.scala.html#26812" title="Long" id="101175">copy</a><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#101169" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">copy</a>.<a href="../../Messages.scala.html#26777" title="(x$1: Long)Unit">endRound</a> = <a href="#101047" title="Long">curRound</a> <span title="(x: Int)Long">-</span> <span title="Int(1)" class="int">1</span>
            <a href="#101044" title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]">result</a> <span title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)result.type">+=</span> <a href="#101169" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">copy</a>
            <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a> = <a href="#101075" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">dominant</a>.<a href="../../Messages.scala.html#26789" title="(startRound: Long, endRound: Long, vote: Int, server: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange">copy</a><span class="delimiter">(</span><span class="delimiter">)</span>
            <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26774" title="(x$1: Long)Unit">startRound</a> = <a href="#101047" title="Long">curRound</a>
          <span class="delimiter">}</span>
          <a href="#101047" title="Long">curRound</a> = <a href="#101048" title="Long">nextRound</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>.<a href="../../Messages.scala.html#26777" title="(x$1: Long)Unit">endRound</a> = <a href="#101047" title="Long">curRound</a> <span title="(x: Int)Long">-</span> <span title="Int(1)" class="int">1</span>
    <a href="#101044" title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]">result</a> <span title="(elem: edu.berkeley.cs.scads.storage.MDCCBallotRange)result.type">+=</span> <a href="#101045" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">curRange</a>
    <a href="#101044" title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]">result</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26774" title="(x$1: Long)Unit">startRound</a> = <span title="(x: Long, y: Long)Long">max</span><span class="delimiter">(</span><a href="#101046" title="Long">firstRound</a>, <a href="#101044" title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]">result</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a><span class="delimiter">)</span>
    <a href="../../Messages.scala.html#26939" title="(currentRound: Long, ballots: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange])edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">(</span><a href="#101046" title="Long">firstRound</a>, <a href="#101044" title="scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.storage.MDCCBallotRange]">result</a><span class="delimiter">)</span>

  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)(implicit r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCMetadata" id="95814">getOwnership</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101203">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="edu.berkeley.cs.scads.storage.SCADSService" id="101204">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>  = <span class="delimiter">{</span>
    <a href="#95812" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, startRound: Long, endRound: Long, fast: Boolean)(implicit r: edu.berkeley.cs.scads.storage.SCADSService)edu.berkeley.cs.scads.storage.MDCCMetadata">getOwnership</a><span class="delimiter">(</span><a href="#101203" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>, <a href="#101203" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#101203" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a>, <a href="#101203" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#101204" title="edu.berkeley.cs.scads.storage.SCADSService">r</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ranges: Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange], startRound: Long, endRound: Long, r: edu.berkeley.cs.scads.storage.SCADSService, fast: Boolean)edu.berkeley.cs.scads.storage.MDCCBallotRange" id="95815">buildRange</a><span class="delimiter">(</span><a title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="101211">ranges</a> : <span title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">Seq</span><span class="delimiter">[</span>MDCCBallotRange<span class="delimiter">]</span>, <a title="Long" id="101212">startRound</a>: <span title="Long">Long</span>, <a title="Long" id="101213">endRound</a>: <span title="Long">Long</span>, <a title="edu.berkeley.cs.scads.storage.SCADSService" id="101214">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a>, <a title="Boolean" id="101215">fast</a> : <span title="Boolean">Boolean</span><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="101217">maxVote</a> = <a href="#101211" title="Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ranges</a>.<span title="(f: edu.berkeley.cs.scads.storage.MDCCBallotRange =&gt; Int)(implicit cmp: Ordering[Int])edu.berkeley.cs.scads.storage.MDCCBallotRange">maxBy</span><span title="object scala.math.Ordering.Int" class="delimiter">(</span><a href="#101227" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">_</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a><span class="delimiter">)</span>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#101217" title="Int">maxVote</a> <span title="(x: Long)Boolean">&lt;</span> Long.<span title="Long(9223372036854775807L)">MaxValue</span><span class="delimiter">)</span>
    <span title="edu.berkeley.cs.scads.storage.MDCCBallotRange" class="keyword">new</span> <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">(</span><a href="#101212" title="Long">startRound</a>, <a href="#101213" title="Long">endRound</a>, <a href="#101217" title="Int">maxVote</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#101214" title="edu.berkeley.cs.scads.storage.SCADSService">r</a>, <a href="#101215" title="Boolean">fast</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.MDCCBallotRange" id="95816">curRange</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101293">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#101293" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#101293" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#101293" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#101293" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">&gt;=</span> <a href="#101293" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
    <span title="Nothing" class="keyword">return</span> <a href="#101293" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata, startRound: Long, endRound: Long)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]" id="95817">getRange</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101317">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="Long" id="101318">startRound</a>: <span title="Long">Long</span>, <a title="Long" id="101319">endRound</a>: <span title="Long">Long</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#101317" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="(p: edu.berkeley.cs.scads.storage.MDCCBallotRange =&gt; Boolean)Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">filter</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101327">r</a> =&gt; <span class="delimiter">(</span><a href="#101318" title="Long">startRound</a> <span title="(x: Long)Boolean">&lt;=</span>  <a href="#101327" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">r</a>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#101327" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">r</a>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">&lt;=</span> <a href="#101319" title="Long">endRound</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)(implicit r: edu.berkeley.cs.scads.storage.SCADSService)Boolean" id="95818">isMaster</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101336">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="edu.berkeley.cs.scads.storage.SCADSService" id="101337">r</a>: <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#95820" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.SCADSService">getMaster</a><span class="delimiter">(</span><a href="#101336" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#101337" title="edu.berkeley.cs.scads.storage.SCADSService">r</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean" id="95819">fastRound</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101347">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#101347" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#101347" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)edu.berkeley.cs.scads.storage.SCADSService" id="95820">getMaster</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101340">meta</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <a href="../../Messages.scala.html#9492" title="edu.berkeley.cs.scads.storage.SCADSService">SCADSService</a> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#101340" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#101340" title="edu.berkeley.cs.scads.storage.MDCCMetadata">meta</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns 0 if both are equal
   * -1 if metaL is smaller
   * 1  if metaL is bigger
   * -2 if it is undefined
   */</span>
  <span class="keyword">def</span> <a title="(metaL: edu.berkeley.cs.scads.storage.MDCCMetadata, metaR: edu.berkeley.cs.scads.storage.MDCCMetadata)Int" id="95821">compareMetadata</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="95824">metaL</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="95825">metaR</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span> : <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="101355">status</a> : <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#95824" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#95825" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
      <a href="#101355" title="Int">status</a> =  -<span title="Int(-1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#95824" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Long)Boolean">&gt;</span> <a href="#95825" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
      <a href="#101355" title="Int">status</a> =  <span title="Int(1)" class="int">1</span>

    <span class="keyword">val</span> <a title="Seq[(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)]" id="101356">validationPairs</a> = <a href="#95824" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="(that: scala.collection.GenIterable[edu.berkeley.cs.scads.storage.MDCCBallotRange])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange],(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange),Seq[(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)]])Seq[(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)]">zip</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange),Seq[(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)]]" class="delimiter">(</span><a href="#95825" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a><span class="delimiter">)</span>
    <a href="#101356" title="Seq[(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)]">validationPairs</a>.<span title="(f: (edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange) =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span> <a title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)" id="101430">p</a> =&gt;  <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#101430" title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)">p</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">_1</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a> <span title="(x: Long)Boolean">!=</span> <a href="#101430" title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)">p</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">_2</span>.<a href="../../Messages.scala.html#26773" title="=&gt; Long">startRound</a>  <span title="(x: Boolean)Boolean">||</span> <a href="#101430" title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)">p</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">_1</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a> <span title="(x: Long)Boolean">!=</span> <a href="#101430" title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)">p</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">_2</span>.<a href="../../Messages.scala.html#26776" title="=&gt; Long">endRound</a><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">return</span> -<span title="Int(-2)" class="int">2</span>
        <span class="keyword">val</span> <a title="Int" id="101431">cmp</a> = <a href="#95822" title="(lRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, rRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Int">compareMetadataRound</a><span class="delimiter">(</span><a href="#101430" title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)">p</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">_1</span>, <a href="#101430" title="(edu.berkeley.cs.scads.storage.MDCCBallotRange, edu.berkeley.cs.scads.storage.MDCCBallotRange)">p</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">_2</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#101355" title="Int">status</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
          <a href="#101355" title="Int">status</a> = <a href="#101431" title="Int">cmp</a>
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#101355" title="Int">status</a> <span title="(x: Int)Boolean">!=</span> <a href="#101431" title="Int">cmp</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Nothing" class="keyword">return</span> -<span title="Int(-2)" class="int">2</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
    <span title="Nothing" class="keyword">return</span> <a href="#101355" title="Int">status</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(lRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, rRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Int" id="95822">compareMetadataRound</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101148">lRange</a> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a>, <a title="edu.berkeley.cs.scads.storage.MDCCBallotRange" id="101149">rRange</a> : <a href="../../Messages.scala.html#9665" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">MDCCBallotRange</a><span class="delimiter">)</span> : <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#101148" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">lRange</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#101149" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">rRange</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#101148" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">lRange</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#101149" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">rRange</a>.<a href="../../Messages.scala.html#26785" title="=&gt; Boolean">fast</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> -<span title="Int(-1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#101148" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">lRange</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#101149" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">rRange</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> -<span title="Int(-1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#101148" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">lRange</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#101149" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">rRange</a>.<a href="../../Messages.scala.html#26779" title="=&gt; Int">vote</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">else</span>
      <span title="Nothing" class="keyword">return</span> <a href="#101148" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">lRange</a>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">toString</span>.<span title="(other: String)Int">compare</span><span class="delimiter">(</span><a href="#101149" title="edu.berkeley.cs.scads.storage.MDCCBallotRange">rRange</a>.<a href="../../Messages.scala.html#26782" title="=&gt; edu.berkeley.cs.scads.storage.SCADSService">server</a>.<span title="()String">toString</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(metaL: edu.berkeley.cs.scads.storage.MDCCMetadata, metaR: edu.berkeley.cs.scads.storage.MDCCMetadata)Int" id="95823">compareCurrentRound</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101480">metaL</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a>, <a title="edu.berkeley.cs.scads.storage.MDCCMetadata" id="101481">metaR</a> : <a href="../../Messages.scala.html#9668" title="edu.berkeley.cs.scads.storage.MDCCMetadata">MDCCMetadata</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#101480" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#95801" title="(meta: edu.berkeley.cs.scads.storage.MDCCMetadata)Boolean">validateMeta</a><span class="delimiter">(</span><a href="#101481" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#101480" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#101481" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> -<span title="Int(-1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#101480" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a> <span title="(x: Long)Boolean">&gt;</span> <a href="#101481" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a>.<a href="../../Messages.scala.html#26907" title="=&gt; Long">currentRound</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">else</span>
      <a href="#95822" title="(lRange: edu.berkeley.cs.scads.storage.MDCCBallotRange, rRange: edu.berkeley.cs.scads.storage.MDCCBallotRange)Int">compareMetadataRound</a><span class="delimiter">(</span><a href="#101480" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaL</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span>, <a href="#101481" title="edu.berkeley.cs.scads.storage.MDCCMetadata">metaR</a>.<a href="../../Messages.scala.html#26910" title="=&gt; Seq[edu.berkeley.cs.scads.storage.MDCCBallotRange]">ballots</a>.<span title="=&gt; edu.berkeley.cs.scads.storage.MDCCBallotRange">head</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>