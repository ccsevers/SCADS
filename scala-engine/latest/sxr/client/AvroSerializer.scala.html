<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>client/AvroSerializer.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.storage

<span class="keyword">import</span> java.io._

<span class="keyword">import</span> edu.berkeley.cs.avro.marker._
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._

<span class="keyword">import</span> org.apache.avro._
<span class="keyword">import</span> generic._
<span class="keyword">import</span> io._
<span class="keyword">import</span> specific._

<span class="keyword">import</span> edu.berkeley.cs.avro.runtime.SchemaCompare

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class AvroReaderWriter[T &lt;: org.apache.avro.generic.IndexedRecord] extends java.lang.Object with ScalaObject" id="9502">AvroReaderWriter</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.generic.IndexedRecord" id="9503">T</a> &lt;: IndexedRecord<span class="delimiter">]</span><a href="#9502" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Option[org.apache.avro.Schema]" id="31505">remoteSchema</a>: <span title="Option[org.apache.avro.Schema]">Option</span><span class="delimiter">[</span>Schema<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; org.apache.avro.io.DatumReader[T]" id="31477">reader</a>: <span title="org.apache.avro.io.DatumReader[T]">DatumReader</span><span class="delimiter">[</span>T<span class="delimiter">]</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; org.apache.avro.io.DatumWriter[T]" id="31478">writer</a>: <span title="org.apache.avro.io.DatumWriter[T]">DatumWriter</span><span class="delimiter">[</span>T<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; org.apache.avro.Schema" id="31479">schema</a>: <span title="org.apache.avro.Schema">Schema</span>

  <a href="#31505" title="=&gt; Option[org.apache.avro.Schema]">remoteSchema</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Unit">None</span> =&gt; <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span> <span class="comment">// What to do here</span>
    <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><a title="org.apache.avro.Schema" id="31509">rs</a><span class="delimiter">)</span> =&gt; <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><span title="object edu.berkeley.cs.avro.runtime.SchemaCompare">SchemaCompare</span>.<span title="(s1: org.apache.avro.Schema, s2: org.apache.avro.Schema)Boolean">typesEqual</span><span class="delimiter">(</span><a href="#31479" title="=&gt; org.apache.avro.Schema">schema</a>,<a href="#31509" title="org.apache.avro.Schema">rs</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.RuntimeException" class="keyword">new</span> <span title="java.lang.RuntimeException">RuntimeException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Local and remote schemas do not have the same types&quot;)" class="string">&quot;Local and remote schemas do not have the same types&quot;</span><span class="delimiter">)</span>
    <span class="comment">// NB: test checks for the string in the message above, so change the test if you change the message</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Int" id="31480">bufferSize</a> = <span title="Int(128)" class="int">128</span>

  <span class="keyword">def</span> <a title="=&gt; T" id="31482">newInstance</a>: <a href="#9503" title="T">T</a>

  <span class="keyword">def</span> <a title="(rec: T)Array[Byte]" id="31483">serialize</a><span class="delimiter">(</span><a title="T" id="31520">rec</a>: <a href="#9503" title="T">T</a><span class="delimiter">)</span>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="31522">baos</a> = <span title="(x$1: Int)java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span><span class="delimiter">(</span><a href="#31480" title="=&gt; Int">bufferSize</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.BinaryEncoder" id="31523">enc</a>  = <span title="object org.apache.avro.io.EncoderFactory">EncoderFactory</span>.<span title="()org.apache.avro.io.EncoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: java.io.OutputStream, x$2: org.apache.avro.io.BinaryEncoder)org.apache.avro.io.BinaryEncoder">binaryEncoder</span><span class="delimiter">(</span><a href="#31522" title="java.io.ByteArrayOutputStream">baos</a>,<span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <a href="#31478" title="=&gt; org.apache.avro.io.DatumWriter[T]">writer</a>.<span title="(x$1: T, x$2: org.apache.avro.io.Encoder)Unit">write</span><span class="delimiter">(</span><a href="#31520" title="T">rec</a>, <a href="#31523" title="org.apache.avro.io.BinaryEncoder">enc</a><span class="delimiter">)</span>
    <a href="#31523" title="org.apache.avro.io.BinaryEncoder">enc</a>.<span title="()Unit">flush</span>
    <a href="#31522" title="java.io.ByteArrayOutputStream">baos</a>.<span title="()Array[Byte]">toByteArray</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(bytes: Array[Byte])T" id="31484">deserialize</a><span class="delimiter">(</span><a title="Array[Byte]" id="31646">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#9503" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.BinaryDecoder" id="31648">dec</a> = <span title="object org.apache.avro.io.DecoderFactory">DecoderFactory</span>.<span title="()org.apache.avro.io.DecoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: java.io.InputStream, x$2: org.apache.avro.io.BinaryDecoder)org.apache.avro.io.BinaryDecoder">directBinaryDecoder</span><span class="delimiter">(</span><span title="java.io.ByteArrayInputStream" class="keyword">new</span> <span title="java.io.ByteArrayInputStream">ByteArrayInputStream</span><span class="delimiter">(</span><a href="#31646" title="Array[Byte]">bytes</a><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <a href="#31477" title="=&gt; org.apache.avro.io.DatumReader[T]">reader</a>.<span title="(x$1: T, x$2: org.apache.avro.io.Decoder)T">read</span><span class="delimiter">(</span><a href="#31482" title="=&gt; T">newInstance</a>, <a href="#31648" title="org.apache.avro.io.BinaryDecoder">dec</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(stream: java.io.InputStream)T" id="31485">deserialize</a><span class="delimiter">(</span><a title="java.io.InputStream" id="31852">stream</a>: <span title="java.io.InputStream">InputStream</span><span class="delimiter">)</span>: <a href="#9503" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.BinaryDecoder" id="31854">dec</a> = <span title="object org.apache.avro.io.DecoderFactory">DecoderFactory</span>.<span title="()org.apache.avro.io.DecoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: java.io.InputStream, x$2: org.apache.avro.io.BinaryDecoder)org.apache.avro.io.BinaryDecoder">directBinaryDecoder</span><span class="delimiter">(</span><a href="#31852" title="java.io.InputStream">stream</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <a href="#31477" title="=&gt; org.apache.avro.io.DatumReader[T]">reader</a>.<span title="(x$1: T, x$2: org.apache.avro.io.Decoder)T">read</span><span class="delimiter">(</span><a href="#31482" title="=&gt; T">newInstance</a>, <a href="#31854" title="org.apache.avro.io.BinaryDecoder">dec</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(schema: org.apache.avro.Schema)org.apache.avro.generic.IndexedRecord" id="31486">newRecord</a><span class="delimiter">(</span><a title="org.apache.avro.Schema" id="31855">schema</a>: <span title="org.apache.avro.Schema">Schema</span><span class="delimiter">)</span>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span> =
    <span title="org.apache.avro.generic.GenericData.Record" class="keyword">new</span> <span title="object org.apache.avro.generic.GenericData">GenericData</span>.<span title="org.apache.avro.generic.GenericData.Record">Record</span><span class="delimiter">(</span><a href="#31855" title="org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class AvroGenericReaderWriter[T &gt;: org.apache.avro.generic.GenericRecord &lt;: org.apache.avro.generic.IndexedRecord] extends edu.berkeley.cs.scads.storage.AvroReaderWriter[T] with ScalaObject" id="9504">AvroGenericReaderWriter</a><span class="delimiter">[</span><a title="&gt;: org.apache.avro.generic.GenericRecord &lt;: org.apache.avro.generic.IndexedRecord" id="9505">T</a> &gt;: GenericRecord &lt;: IndexedRecord<span class="delimiter">]</span><a href="#9504" title="ScalaObject" class="delimiter">(</a><a title="Option[org.apache.avro.Schema]" id="32071">_remoteSchema</a>: <span title="Option[org.apache.avro.Schema]">Option</span><span class="delimiter">[</span>Schema<span class="delimiter">]</span>, <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="32072">schema</a>: <span title="org.apache.avro.Schema">Schema</span><span class="delimiter">)</span> 
  <span class="keyword">extends</span> <a href="#9502" title="edu.berkeley.cs.scads.storage.AvroReaderWriter[T]">AvroReaderWriter</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#32071" title="Option[org.apache.avro.Schema]">_remoteSchema</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#32072" title="=&gt; org.apache.avro.Schema">schema</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.apache.avro.generic.GenericDatumReader[T]" id="31867">reader</a> = <span title="(x$1: org.apache.avro.Schema)org.apache.avro.generic.GenericDatumReader[T]" class="keyword">new</span> <span title="org.apache.avro.generic.GenericDatumReader[T]">GenericDatumReader</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#32072" title="=&gt; org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.apache.avro.generic.GenericDatumWriter[T]" id="31869">writer</a> = <span title="(x$1: org.apache.avro.Schema)org.apache.avro.generic.GenericDatumWriter[T]" class="keyword">new</span> <span title="org.apache.avro.generic.GenericDatumWriter[T]">GenericDatumWriter</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#32072" title="=&gt; org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; org.apache.avro.generic.GenericData.Record" id="31871">newInstance</a> = <span title="org.apache.avro.generic.GenericData.Record" class="keyword">new</span> <span title="object org.apache.avro.generic.GenericData">GenericData</span>.<span title="org.apache.avro.generic.GenericData.Record">Record</span><span class="delimiter">(</span><a href="#32072" title="=&gt; org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class AvroSpecificReaderWriter[T &lt;: org.apache.avro.specific.SpecificRecord] extends edu.berkeley.cs.scads.storage.AvroReaderWriter[T] with ScalaObject" id="9506">AvroSpecificReaderWriter</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9507">T</a> &lt;: SpecificRecord<span class="delimiter">]</span><a href="#9506" title="ScalaObject" class="delimiter">(</a><a title="Option[org.apache.avro.Schema]" id="33076">_remoteSchema</a>: <span title="Option[org.apache.avro.Schema]">Option</span><span class="delimiter">[</span>Schema<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[T]" id="33077">tpe</a>: <span title="Manifest[T]">Manifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="#9502" title="edu.berkeley.cs.scads.storage.AvroReaderWriter[T]">AvroReaderWriter</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#33076" title="Option[org.apache.avro.Schema]">_remoteSchema</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Class[T]" id="32085">recClz</a> = <a href="#33077" title="Manifest[T]">tpe</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[T]" class="delimiter">[</span><span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="32087">schema</a> = <a href="#32085" title="=&gt; Class[T]">recClz</a>.<span title="()T">newInstance</span>.<span title="()org.apache.avro.Schema">getSchema</span>
  <span class="keyword">val</span> <a title="org.apache.avro.specific.SpecificData" id="32088">specificData</a> = <span title="(x$1: java.lang.ClassLoader)org.apache.avro.specific.SpecificData" class="keyword">new</span> <span title="org.apache.avro.specific.SpecificData">SpecificData</span><span class="delimiter">(</span><a href="#9506" title="AvroSpecificReaderWriter.this.type" class="keyword">this</a>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.ClassLoader">getClassLoader</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.apache.avro.specific.SpecificDatumReader[T]" id="32090">reader</a> = <span title="(x$1: org.apache.avro.Schema, x$2: org.apache.avro.Schema, x$3: org.apache.avro.specific.SpecificData)org.apache.avro.specific.SpecificDatumReader[T]" class="keyword">new</span> <span title="org.apache.avro.specific.SpecificDatumReader[T]">SpecificDatumReader</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#32086" title="=&gt; org.apache.avro.Schema">schema</a>, <a href="#32086" title="=&gt; org.apache.avro.Schema">schema</a>, <a href="#32088" title="=&gt; org.apache.avro.specific.SpecificData">specificData</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="org.apache.avro.specific.SpecificDatumWriter[T]" id="32092">writer</a> = <span title="(x$1: org.apache.avro.Schema)org.apache.avro.specific.SpecificDatumWriter[T]" class="keyword">new</span> <span title="org.apache.avro.specific.SpecificDatumWriter[T]">SpecificDatumWriter</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#32086" title="=&gt; org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; T" id="32094">newInstance</a> = <a href="#32085" title="=&gt; Class[T]">recClz</a>.<span title="()T">newInstance</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(schema: org.apache.avro.Schema)org.apache.avro.generic.IndexedRecord" id="32095">newRecord</a><span class="delimiter">(</span><a title="org.apache.avro.Schema" id="33082">schema</a>: <span title="org.apache.avro.Schema">Schema</span><span class="delimiter">)</span>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.lang.Class[_]" id="33084">c</a> = <a href="#32088" title="=&gt; org.apache.avro.specific.SpecificData">specificData</a>.<span title="(x$1: org.apache.avro.Schema)java.lang.Class[_]">getClass</span><span class="delimiter">(</span><a href="#33082" title="org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
    <span title="org.apache.avro.generic.IndexedRecord" class="keyword">if</span><span class="delimiter">(</span><a href="#33084" title="java.lang.Class[_]">c</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
      <span title="org.apache.avro.generic.GenericData.Record" class="keyword">new</span> <span title="object org.apache.avro.generic.GenericData">GenericData</span>.<span title="org.apache.avro.generic.GenericData.Record">Record</span><span class="delimiter">(</span><a href="#33082" title="org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <a href="#33084" title="java.lang.Class[_]">c</a>.<span title="()Any">newInstance</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.apache.avro.generic.IndexedRecord" class="delimiter">[</span><span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait AvroKeyValueSerializerLike[K &lt;: org.apache.avro.generic.IndexedRecord, V &lt;: org.apache.avro.generic.IndexedRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.KeyValueSerializer[K,V] with edu.berkeley.cs.scads.storage.GlobalMetadata with ScalaObject" id="9508">AvroKeyValueSerializerLike</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.generic.IndexedRecord" id="9509">K</a> &lt;: IndexedRecord, <a title="&gt;: Nothing &lt;: org.apache.avro.generic.IndexedRecord" id="9510">V</a> &lt;: IndexedRecord<span class="delimiter">]</span>
  <span title="ScalaObject" class="keyword">extends</span> <a href="Interfaces.scala.html#9603" title="edu.berkeley.cs.scads.storage.KeyValueSerializer[K,V]">KeyValueSerializer</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> 
  <span class="keyword">with</span> <a href="Interfaces.scala.html#9616" title="edu.berkeley.cs.scads.storage.GlobalMetadata">GlobalMetadata</a> <span class="delimiter">{</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[K]" id="33105">keyReaderWriter</a>: <a href="#9502" title="edu.berkeley.cs.scads.storage.AvroReaderWriter[K]">AvroReaderWriter</a><span class="delimiter">[</span>K<span class="delimiter">]</span> 
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[V]" id="33106">valueReaderWriter</a>: <a href="#9502" title="edu.berkeley.cs.scads.storage.AvroReaderWriter[V]">AvroReaderWriter</a><span class="delimiter">[</span>V<span class="delimiter">]</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(bytes: Array[Byte])K" id="33107">bytesToKey</a><span class="delimiter">(</span><a title="Array[Byte]" id="33117">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#9509" title="K">K</a> = 
    <a href="#33105" title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[K]">keyReaderWriter</a>.<a href="#31484" title="(bytes: Array[Byte])K">deserialize</a><span class="delimiter">(</span><a href="#33117" title="Array[Byte]">bytes</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(bytes: Array[Byte])V" id="33108">bytesToValue</a><span class="delimiter">(</span><a title="Array[Byte]" id="33124">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#9510" title="V">V</a> =
    <a href="#33106" title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[V]">valueReaderWriter</a>.<a href="#31484" title="(bytes: Array[Byte])V">deserialize</a><span class="delimiter">(</span><a href="#33124" title="Array[Byte]">bytes</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(k: Array[Byte], v: Array[Byte])(K, V)" id="33109">bytesToBulk</a><span class="delimiter">(</span><a title="Array[Byte]" id="33131">k</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="33132">v</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(K, V)" class="delimiter">(</span>K, V<span class="delimiter">)</span> =
    <span title="(_1: K, _2: V)(K, V)" class="delimiter">(</span><a href="#33107" title="(bytes: Array[Byte])K">bytesToKey</a><span class="delimiter">(</span><a href="#33131" title="Array[Byte]">k</a><span class="delimiter">)</span>, <a href="#33108" title="(bytes: Array[Byte])V">bytesToValue</a><span class="delimiter">(</span><a href="#33132" title="Array[Byte]">v</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: K)Array[Byte]" id="33110">keyToBytes</a><span class="delimiter">(</span><a title="K" id="33142">key</a>: <a href="#9509" title="K">K</a><span class="delimiter">)</span>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> =
    <a href="#33105" title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[K]">keyReaderWriter</a>.<a href="#31483" title="(rec: K)Array[Byte]">serialize</a><span class="delimiter">(</span><a href="#33142" title="K">key</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(value: V)Array[Byte]" id="33111">valueToBytes</a><span class="delimiter">(</span><a title="V" id="33147">value</a>: <a href="#9510" title="V">V</a><span class="delimiter">)</span>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = 
    <a href="#33106" title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[V]">valueReaderWriter</a>.<a href="#31483" title="(rec: V)Array[Byte]">serialize</a><span class="delimiter">(</span><a href="#33147" title="V">value</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(b: (K, V))(Array[Byte], Array[Byte])" id="33112">bulkToBytes</a><span class="delimiter">(</span><a title="(K, V)" id="33152">b</a>: <span title="(K, V)" class="delimiter">(</span>K, V<span class="delimiter">)</span><span class="delimiter">)</span>: <span title="(Array[Byte], Array[Byte])" class="delimiter">(</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span> =
    <span title="(_1: Array[Byte], _2: Array[Byte])(Array[Byte], Array[Byte])" class="delimiter">(</span><a href="#33110" title="(key: K)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#33152" title="(K, V)">b</a>.<span title="=&gt; K">_1</span><span class="delimiter">)</span>, <a href="#33111" title="(value: V)Array[Byte]">valueToBytes</a><span class="delimiter">(</span><a href="#33152" title="(K, V)">b</a>.<span title="=&gt; V">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; K" id="33113">newKeyInstance</a> = <a href="#33105" title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[K]">keyReaderWriter</a>.<a href="#31482" title="=&gt; K">newInstance</a>
  
  <span class="keyword">def</span> <a title="(schema: org.apache.avro.Schema)org.apache.avro.generic.IndexedRecord" id="33114">newRecord</a><span class="delimiter">(</span><a title="org.apache.avro.Schema" id="33165">schema</a>: <span title="org.apache.avro.Schema">Schema</span><span class="delimiter">)</span> = <a href="#33105" title="=&gt; edu.berkeley.cs.scads.storage.AvroReaderWriter[K]">keyReaderWriter</a>.<a href="#31486" title="(schema: org.apache.avro.Schema)org.apache.avro.generic.IndexedRecord">newRecord</a><span class="delimiter">(</span><a href="#33165" title="org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait AvroGenericKeyValueSerializer extends java.lang.Object with edu.berkeley.cs.scads.storage.AvroKeyValueSerializerLike[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9511">AvroGenericKeyValueSerializer</a> 
  <span title="ScalaObject" class="keyword">extends</span> <a href="#9508" title="edu.berkeley.cs.scads.storage.AvroKeyValueSerializerLike[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">AvroKeyValueSerializerLike</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.GenericRecord]" id="33171">keyReaderWriter</a> = <span title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.GenericRecord]" class="keyword">new</span> <a href="#9504" title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.GenericRecord]">AvroGenericReaderWriter</a><span class="delimiter">[</span>GenericRecord<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13634" title="=&gt; org.apache.avro.Schema">remoteKeySchema</a><span class="delimiter">)</span>, <a href="Interfaces.scala.html#13631" title="=&gt; org.apache.avro.Schema">keySchema</a><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.GenericRecord]" id="33173">valueReaderWriter</a> = <span title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.GenericRecord]" class="keyword">new</span> <a href="#9504" title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.GenericRecord]">AvroGenericReaderWriter</a><span class="delimiter">[</span>GenericRecord<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13635" title="=&gt; org.apache.avro.Schema">remoteValueSchema</a><span class="delimiter">)</span>, <a href="Interfaces.scala.html#13632" title="=&gt; org.apache.avro.Schema">valueSchema</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait AvroIndexedKeyValueSerializer extends java.lang.Object with edu.berkeley.cs.scads.storage.AvroKeyValueSerializerLike[org.apache.avro.generic.IndexedRecord,org.apache.avro.generic.IndexedRecord] with ScalaObject" id="9512">AvroIndexedKeyValueSerializer</a> 
  <span title="ScalaObject" class="keyword">extends</span> <a href="#9508" title="edu.berkeley.cs.scads.storage.AvroKeyValueSerializerLike[org.apache.avro.generic.IndexedRecord,org.apache.avro.generic.IndexedRecord]">AvroKeyValueSerializerLike</a><span class="delimiter">[</span>IndexedRecord, IndexedRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" id="33184">keyReaderWriter</a> = <span title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" class="keyword">new</span> <a href="#9504" title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">AvroGenericReaderWriter</a><span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13634" title="=&gt; org.apache.avro.Schema">remoteKeySchema</a><span class="delimiter">)</span>, <a href="Interfaces.scala.html#13631" title="=&gt; org.apache.avro.Schema">keySchema</a><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" id="33186">valueReaderWriter</a> = <span title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" class="keyword">new</span> <a href="#9504" title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">AvroGenericReaderWriter</a><span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13635" title="=&gt; org.apache.avro.Schema">remoteValueSchema</a><span class="delimiter">)</span>, <a href="Interfaces.scala.html#13632" title="=&gt; org.apache.avro.Schema">valueSchema</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait AvroSpecificKeyValueSerializer[K &lt;: org.apache.avro.specific.SpecificRecord, V &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.AvroKeyValueSerializerLike[K,V] with ScalaObject" id="9513">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9514">K</a> &lt;: SpecificRecord, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9515">V</a> &lt;: SpecificRecord<span class="delimiter">]</span>
  <span title="ScalaObject" class="keyword">extends</span> <a href="#9508" title="edu.berkeley.cs.scads.storage.AvroKeyValueSerializerLike[K,V]">AvroKeyValueSerializerLike</a><span class="delimiter">[</span>K, V<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Manifest[K]" id="33196">keyManifest</a>: <span title="Manifest[K]">Manifest</span><span class="delimiter">[</span>K<span class="delimiter">]</span>
  <span class="keyword">implicit</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Manifest[V]" id="33197">valueManifest</a>: <span title="Manifest[V]">Manifest</span><span class="delimiter">[</span>V<span class="delimiter">]</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[K]" id="33199">keyReaderWriter</a> = <a href="#33196" title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[K]" class="keyword">new</a> <a href="#9506" title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[K]">AvroSpecificReaderWriter</a><span class="delimiter">[</span>K<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13634" title="=&gt; org.apache.avro.Schema">remoteKeySchema</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[V]" id="33201">valueReaderWriter</a> = <a href="#33197" title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[V]" class="keyword">new</a> <a href="#9506" title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[V]">AvroSpecificReaderWriter</a><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13635" title="=&gt; org.apache.avro.Schema">remoteValueSchema</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="33203">keySchema</a> = 
    <a href="#33196" title="=&gt; Manifest[K]">keyManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[K]" class="delimiter">[</span><span title="Class[K]">Class</span><span class="delimiter">[</span>K<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()K">newInstance</span>.<span title="()org.apache.avro.Schema">getSchema</span>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="33205">valueSchema</a> =
    <a href="#33197" title="=&gt; Manifest[V]">valueManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[V]" class="delimiter">[</span><span title="Class[V]">Class</span><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()V">newInstance</span>.<span title="()org.apache.avro.Schema">getSchema</span>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.lang.String" id="33207">valueClass</a> =
    <a href="#33197" title="=&gt; Manifest[V]">valueManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[V]" class="delimiter">[</span><span title="Class[V]">Class</span><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()java.lang.String">getName</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait AvroPairSerializer[P &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with edu.berkeley.cs.scads.storage.PairSerializer[P] with edu.berkeley.cs.scads.storage.PairGlobalMetadata with ScalaObject" id="9516">AvroPairSerializer</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="9517">P</a> &lt;: AvroPair<span class="delimiter">]</span>
  <span title="ScalaObject" class="keyword">extends</span> <a href="Interfaces.scala.html#9606" title="edu.berkeley.cs.scads.storage.PairSerializer[P]">PairSerializer</a><span class="delimiter">[</span>P<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Interfaces.scala.html#9617" title="edu.berkeley.cs.scads.storage.PairGlobalMetadata">PairGlobalMetadata</a> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" id="33228">keyReaderWriter</a> = <span title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" class="keyword">new</span> <a href="#9504" title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">AvroGenericReaderWriter</a><span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13634" title="=&gt; org.apache.avro.Schema">remoteKeySchema</a><span class="delimiter">)</span>, <a href="#33241" title="=&gt; org.apache.avro.Schema">keySchema</a><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" id="33230">valueReaderWriter</a> = <span title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]" class="keyword">new</span> <a href="#9504" title="edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">AvroGenericReaderWriter</a><span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span><span class="delimiter">(</span><span title="(x: org.apache.avro.Schema)Some[org.apache.avro.Schema]">Some</span><span class="delimiter">(</span><a href="Interfaces.scala.html#13635" title="=&gt; org.apache.avro.Schema">remoteValueSchema</a><span class="delimiter">)</span>, <a href="#33243" title="=&gt; org.apache.avro.Schema">valueSchema</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Manifest[P]" id="33231">pairManifest</a>: <span title="Manifest[P]">Manifest</span><span class="delimiter">[</span>P<span class="delimiter">]</span>

  <span class="comment">// TODO: need to recreate the pair schema from key/value schema, for schema validation</span>
  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[P]" id="33233">pairReaderWriter</a> = <a href="#33231" title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[P]" class="keyword">new</a> <a href="#9506" title="edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[P]">AvroSpecificReaderWriter</a><span class="delimiter">[</span>P<span class="delimiter">]</span><span class="delimiter">(</span><span title="object None">None</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(bytes: Array[Byte])org.apache.avro.generic.IndexedRecord" id="33234">bytesToKey</a><span class="delimiter">(</span><a title="Array[Byte]" id="33274">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span> = 
    <a href="#33227" title="=&gt; edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">keyReaderWriter</a>.<a href="#31484" title="(bytes: Array[Byte])org.apache.avro.generic.IndexedRecord">deserialize</a><span class="delimiter">(</span><a href="#33274" title="Array[Byte]">bytes</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(bytes: Array[Byte])org.apache.avro.generic.IndexedRecord" id="33235">bytesToValue</a><span class="delimiter">(</span><a title="Array[Byte]" id="33280">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span> =
    <a href="#33229" title="=&gt; edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">valueReaderWriter</a>.<a href="#31484" title="(bytes: Array[Byte])org.apache.avro.generic.IndexedRecord">deserialize</a><span class="delimiter">(</span><a href="#33280" title="Array[Byte]">bytes</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: Array[Byte], value: Array[Byte])P" id="33236">bytesToBulk</a><span class="delimiter">(</span><a title="Array[Byte]" id="33286">key</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span>, <a title="Array[Byte]" id="33287">value</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#9517" title="P">P</a> = <span class="delimiter">{</span>
    <span class="comment">// We could create an input stream here which concats key and value w/o</span>
    <span class="comment">// copying, but that is probably more work than is worth, since</span>
    <span class="comment">// System.arraycopy is alreay pretty optimized</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="33289">bytes</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#33286" title="Array[Byte]">key</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">+</span> <a href="#33287" title="Array[Byte]">value</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span>
    <span title="object java.lang.System">System</span>.<span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span><a href="#33286" title="Array[Byte]">key</a>, <span title="Int(0)" class="int">0</span>, <a href="#33289" title="Array[Byte]">bytes</a>, <span title="Int(0)" class="int">0</span>, <a href="#33286" title="Array[Byte]">key</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span>
    <span title="object java.lang.System">System</span>.<span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span><a href="#33287" title="Array[Byte]">value</a>, <span title="Int(0)" class="int">0</span>, <a href="#33289" title="Array[Byte]">bytes</a>, <a href="#33286" title="Array[Byte]">key</a>.<span title="=&gt; Int">length</span>, <a href="#33287" title="Array[Byte]">value</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span>
    <a href="#33232" title="=&gt; edu.berkeley.cs.scads.storage.AvroSpecificReaderWriter[P]">pairReaderWriter</a>.<a href="#31484" title="(bytes: Array[Byte])P">deserialize</a><span class="delimiter">(</span><a href="#33289" title="Array[Byte]">bytes</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]" id="33237">keyToBytes</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="33464">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> =
    <a href="#33227" title="=&gt; edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">keyReaderWriter</a>.<a href="#31483" title="(rec: org.apache.avro.generic.IndexedRecord)Array[Byte]">serialize</a><span class="delimiter">(</span><a href="#33464" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(value: org.apache.avro.generic.IndexedRecord)Array[Byte]" id="33238">valueToBytes</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="33468">value</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = 
    <a href="#33229" title="=&gt; edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">valueReaderWriter</a>.<a href="#31483" title="(rec: org.apache.avro.generic.IndexedRecord)Array[Byte]">serialize</a><span class="delimiter">(</span><a href="#33468" title="org.apache.avro.generic.IndexedRecord">value</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(b: P)(Array[Byte], Array[Byte])" id="33239">bulkToBytes</a><span class="delimiter">(</span><a title="P" id="33472">b</a>: <a href="#9517" title="P">P</a><span class="delimiter">)</span>: <span title="(Array[Byte], Array[Byte])" class="delimiter">(</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span> = 
    <span title="(_1: Array[Byte], _2: Array[Byte])(Array[Byte], Array[Byte])" class="delimiter">(</span><a href="#33237" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#33472" title="P">b</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span><span class="delimiter">)</span>, <a href="#33238" title="(value: org.apache.avro.generic.IndexedRecord)Array[Byte]">valueToBytes</a><span class="delimiter">(</span><a href="#33472" title="P">b</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">value</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; org.apache.avro.generic.GenericData.Record" id="33240">newKeyInstance</a> = <a href="#33227" title="=&gt; edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">keyReaderWriter</a>.<a href="#31871" title="=&gt; org.apache.avro.generic.GenericData.Record">newInstance</a>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="33242">keySchema</a> = 
    <a href="#33231" title="=&gt; Manifest[P]">pairManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[P]" class="delimiter">[</span><span title="Class[P]">Class</span><span class="delimiter">[</span>P<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()P">newInstance</span>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>.<span title="()org.apache.avro.Schema">getSchema</span>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="33244">valueSchema</a> = 
    <a href="#33231" title="=&gt; Manifest[P]">pairManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[P]" class="delimiter">[</span><span title="Class[P]">Class</span><span class="delimiter">[</span>P<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()P">newInstance</span>.<span title="=&gt; org.apache.avro.generic.GenericRecord">value</span>.<span title="()org.apache.avro.Schema">getSchema</span>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.lang.String" id="33246">valueClass</a> =
    <a href="#33231" title="=&gt; Manifest[P]">pairManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[P]" class="delimiter">[</span><span title="Class[P]">Class</span><span class="delimiter">[</span>P<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()java.lang.String">getName</span>

  <span class="keyword">override</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="33248">pairSchema</a> = 
    <a href="#33231" title="=&gt; Manifest[P]">pairManifest</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[P]" class="delimiter">[</span><span title="Class[P]">Class</span><span class="delimiter">[</span>P<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="()P">newInstance</span>.<span title="()org.apache.avro.Schema">getSchema</span>

  <span class="keyword">def</span> <a title="(schema: org.apache.avro.Schema)org.apache.avro.generic.IndexedRecord" id="33249">newRecord</a><span class="delimiter">(</span><a title="org.apache.avro.Schema" id="33484">schema</a>: <span title="org.apache.avro.Schema">Schema</span><span class="delimiter">)</span> = <a href="#33227" title="=&gt; edu.berkeley.cs.scads.storage.AvroGenericReaderWriter[org.apache.avro.generic.IndexedRecord]">keyReaderWriter</a>.<a href="#31486" title="(schema: org.apache.avro.Schema)org.apache.avro.generic.IndexedRecord">newRecord</a><span class="delimiter">(</span><a href="#33484" title="org.apache.avro.Schema">schema</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>