<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>client/Examples.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.storage

<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.util._

<span class="keyword">import</span> org.apache.avro._
<span class="keyword">import</span> generic._
<span class="keyword">import</span> specific._

<span class="keyword">import</span> java.util.Comparator

<span class="comment">// TODO: change Manifest to ClassManifest</span>
<span class="keyword">class</span> <a title="class GenericNamespace extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer with edu.berkeley.cs.scads.storage.RangeKeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9541">GenericNamespace</a><a href="#9541" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="String" id="38440">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="38441">cluster</a>: <a href="ScadsCluster.scala.html#9679" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="38442">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="38443">keySchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="38444">valueSchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="String" id="38445">valueClass</a>: <span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9623" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
    <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9691" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9730" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9662" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9646" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9511" title="edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer">AvroGenericKeyValueSerializer</a>
  <span class="keyword">with</span> <a href="Stores.scala.html#9718" title="edu.berkeley.cs.scads.storage.RangeKeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">RangeKeyValueStore</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="comment">/** this is a HACK for now, to handle integration with the director */</span>
  <span class="keyword">def</span> <a title="=&gt; edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" id="37931">typedRoutingTable</a>: <a href="../util/RangeTable.scala.html#9980" title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeTable</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" id="38493">_rt</a> = <a href="Routable.scala.html#37974" title="=&gt; edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">routingTable</a>
    <span class="keyword">val</span> <a title="Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" id="38494">newRTable</a> = <a href="#38493" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">_rt</a>.<a href="../util/RangeTable.scala.html#38455" title="(xs: Array[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]])scala.collection.mutable.ArrayOps[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]]">rTable</a>.<span title="(f: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService] =&gt; edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService])(implicit bf: scala.collection.generic.CanBuildFrom[Array[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]],edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService],Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]])Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]">map</span><span title="(implicit m: scala.reflect.ClassManifest[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]])scala.collection.generic.CanBuildFrom[Array[_],edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService],Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]]" class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" id="39864">rt</a> =&gt; <span title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9983" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#39864" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">rt</a>.<a href="../util/RangeTable.scala.html#38934" title="=&gt; Option[Array[Byte]]">startKey</a>.<span title="(f: Array[Byte] =&gt; org.apache.avro.generic.GenericRecord)Option[org.apache.avro.generic.GenericRecord]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33107" title="(bytes: Array[Byte])org.apache.avro.generic.GenericRecord">bytesToKey</a><span class="delimiter">)</span>, <a href="#39864" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">rt</a>.<a href="../util/RangeTable.scala.html#38936" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">values</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="keyComp extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" id="38495">keyComp</a> = <a href="#39961" title="java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" id="39961">Comparator</a><span class="delimiter">[</span>RangeType<span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(lhs: edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService], rhs: edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService])Int" id="39963">compare</a><span class="delimiter">(</span>
          <a title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" id="39964">lhs</a>: <a href="../util/RangeTable.scala.html#9983" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span>, 
          <a title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" id="39965">rhs</a>: <a href="../util/RangeTable.scala.html#9983" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
        <a href="#38493" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">_rt</a>.<a href="../util/RangeTable.scala.html#38457" title="=&gt; java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]]">keyComparator</a>.<span title="(x$1: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService], x$2: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService])Int">compare</span><span class="delimiter">(</span>
          <span title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9983" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#39964" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">lhs</a>.<a href="../util/RangeTable.scala.html#38934" title="=&gt; Option[org.apache.avro.generic.GenericRecord]">startKey</a>.<span title="(f: org.apache.avro.generic.GenericRecord =&gt; Array[Byte])Option[Array[Byte]]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33110" title="(key: org.apache.avro.generic.GenericRecord)Array[Byte]">keyToBytes</a><span class="delimiter">)</span>, <a href="#39964" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">lhs</a>.<a href="../util/RangeTable.scala.html#38936" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">values</a><span class="delimiter">)</span>,
          <span title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9983" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#39965" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">rhs</a>.<a href="../util/RangeTable.scala.html#38934" title="=&gt; Option[org.apache.avro.generic.GenericRecord]">startKey</a>.<span title="(f: org.apache.avro.generic.GenericRecord =&gt; Array[Byte])Option[Array[Byte]]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33110" title="(key: org.apache.avro.generic.GenericRecord)Array[Byte]">keyToBytes</a><span class="delimiter">)</span>, <a href="#39965" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">rhs</a>.<a href="../util/RangeTable.scala.html#38936" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">values</a><span class="delimiter">)</span>
        <span class="delimiter">)</span> 
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9980" title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeTable</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#38494" title="Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]">newRTable</a>, <a href="#38495" title="keyComp extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]">keyComp</a>, <a href="#38493" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">_rt</a>.<a href="../util/RangeTable.scala.html#38459" title="=&gt; (Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.PartitionService]) =&gt; Boolean">mergeCondition</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="37932">statslogger</a> = net.lag.logging.<span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;statsprotocol&quot;)" class="string">&quot;statsprotocol&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
  * For each range represented by me, get the worklad stats from all the partitions
  * Add stats from partitions that cover the same range, dividing by the quorum amount
  * (Do this to get &quot;logical&quot; workload to a partition)
  * Return mapping of startkey to tuple of (gets,puts)
  * TODO: is this assuming that the read/write quorum will never change?
  */</span>
  <span class="keyword">def</span> <a title="(time: Long)Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" id="37934">getWorkloadStats</a><span class="delimiter">(</span><a title="Long" id="40027">time</a>:<span title="Long">Long</span><span class="delimiter">)</span>:<span title="Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">Map</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>GenericRecord<span class="delimiter">]</span>, <span class="delimiter">(</span>Long,Long<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="40236">haveStats</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[edu.berkeley.cs.scads.storage.RangeDesc]" id="40237">ranges</a> = <a href="Routable.scala.html#38002" title="(startKey: Option[Array[Byte]], endKey: Option[Array[Byte]])Seq[edu.berkeley.cs.scads.storage.RangeDesc]">serversForKeyRange</a><span class="delimiter">(</span><span title="object None">None</span>,<span title="object None">None</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]" id="40238">requests</a> = <span class="keyword">for</span> <span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.RangeDesc" id="40259">fullrange</a> &lt;- <a href="#40237" title="(f: edu.berkeley.cs.scads.storage.RangeDesc =&gt; (Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.RangeDesc],(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture]),Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]])Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]">ranges</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span title="(_1: Option[Array[Byte]], _2: Option[Array[Byte]], _3: Seq[edu.berkeley.cs.scads.comm.PartitionService], _4: Seq[edu.berkeley.cs.scads.comm.MessageFuture])(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])" class="delimiter">(</span><a href="#40259" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27800" title="=&gt; Option[Array[Byte]]">startKey</a>,<a href="#40259" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27802" title="=&gt; Option[Array[Byte]]">endKey</a>, <a href="#40259" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27804" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">servers</a>, <span class="keyword">for</span> <span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.PartitionService" id="40284">partition</a> &lt;- <a href="#40259" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27804" title="(f: edu.berkeley.cs.scads.comm.PartitionService =&gt; edu.berkeley.cs.scads.comm.MessageFuture)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.comm.PartitionService],edu.berkeley.cs.scads.comm.MessageFuture,Seq[edu.berkeley.cs.scads.comm.MessageFuture]])Seq[edu.berkeley.cs.scads.comm.MessageFuture]">servers</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span><a href="#40284" title="edu.berkeley.cs.scads.comm.PartitionService">partition</a> <span title="(body: edu.berkeley.cs.scads.comm.MessageBody)edu.berkeley.cs.scads.comm.MessageFuture">!!</span> <span title="()edu.berkeley.cs.scads.comm.GetWorkloadStats">GetWorkloadStats</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">}</span> <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" id="40239">result</a> = <span title="(elems: (Option[org.apache.avro.generic.GenericRecord], (Long, Long))*)scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">Map</span><span class="delimiter">(</span> <a href="#40238" title="Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]">requests</a>.<span title="(f: (Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture]) =&gt; (Option[org.apache.avro.generic.GenericRecord], (Long, Long)))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])],(Option[org.apache.avro.generic.GenericRecord], (Long, Long)),Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]])Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(Option[org.apache.avro.generic.GenericRecord], (Long, Long)),Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]]" class="delimiter">(</span><a title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])" id="40396">range</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Long" id="40397">gets</a> = <span title="Long(0L)" class="long">0L</span>; <span class="keyword">var</span> <a title="Long" id="40398">puts</a> = <span title="Long(0L)" class="long">0L</span>
      <span class="keyword">val</span> <a title="Int" id="40399">readDivisor</a> = <a href="#40396" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture]">_4</span>.<span title="=&gt; Int">size</span><span class="comment">//scala.math.ceil(range._4.size * readQuorum).toLong</span>
      <span class="keyword">val</span> <a title="Int" id="40400">writeDivisor</a> = <a href="#40396" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture]">_4</span>.<span title="=&gt; Int">size</span><span class="comment">//scala.math.ceil(range._4.size * writeQuorum).toLong</span>

      <a href="#40396" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture]">_4</span>.<span title="(f: edu.berkeley.cs.scads.comm.MessageFuture =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.MessageFuture" id="40417">resp</a> =&gt; <span class="delimiter">{</span> <span class="keyword">val</span> <a href="#40419" title="(Long, Long, Long)" class="delimiter">(</a><a href="#40418" title="Long" id="40419">getcount</a>,<a href="#40418" title="Long" id="40420">putcount</a>,<a href="#40418" title="Long" id="40421">statstime</a><span class="delimiter">)</span> = <a href="#40417" title="edu.berkeley.cs.scads.comm.MessageFuture">resp</a>.<span title="()edu.berkeley.cs.scads.comm.MessageBody">get</span> <span title="(Long, Long, Long)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="(Long, Long, Long)" id="40424">r</a>:<span title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">GetWorkloadStatsResponse</span> =&gt; <span title="(_1: Long, _2: Long, _3: Long)(Long, Long, Long)" class="delimiter">(</span><a href="#40424" title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">r</a>.<span title="=&gt; Int">getCount</span>.<span title="=&gt; Long">toLong</span>,<a href="#40424" title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">r</a>.<span title="=&gt; Int">putCount</span>.<span title="=&gt; Long">toLong</span>,<a href="#40424" title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">r</a>.<span title="=&gt; Long">statsSince</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>; <span class="keyword">case</span> <span title="(Long, Long, Long)">_</span> =&gt; <span title="(_1: Long, _2: Long, _3: Long)(Long, Long, Long)" class="delimiter">(</span><span title="Long(0L)" class="long">0L</span>,<span title="Long(0L)" class="long">0L</span>,<span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>; <a href="#40397" title="Long">gets</a> <span title="(x: Long)Long">+=</span> <a href="#40419" title="Long">getcount</a>; <a href="#40398" title="Long">puts</a> <span title="(x: Long)Long">+=</span> <a href="#40420" title="Long">putcount</a>; <a href="#37932" title="=&gt; net.lag.logging.Logger">statslogger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;workload stats for: %s&quot;)" class="string">&quot;workload stats for: %s&quot;</span>,<a href="#40421" title="Long">statstime</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>; <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#40421" title="Long">statstime</a> <span title="(x: Long)Boolean">&gt;=</span> <a href="#40027" title="Long">time</a><span class="delimiter">)</span> <a href="#40236" title="Boolean">haveStats</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">}</span> <span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#40396" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Option[Array[Byte]]">_1</span>.<span title="(f: Array[Byte] =&gt; org.apache.avro.generic.GenericRecord)Option[org.apache.avro.generic.GenericRecord]">map</span><span title="(x: Option[org.apache.avro.generic.GenericRecord])ArrowAssoc[Option[org.apache.avro.generic.GenericRecord]]" class="delimiter">(</span><a href="AvroSerializer.scala.html#33107" title="(bytes: Array[Byte])org.apache.avro.generic.GenericRecord">bytesToKey</a><span class="delimiter">)</span> <span title="(y: (Long, Long))(Option[org.apache.avro.generic.GenericRecord], (Long, Long))">-&gt;</span> <span class="delimiter">(</span> <a href="#40397" title="Long">gets</a><span title="(x: Int)Long">/</span><a href="#40399" title="Int">readDivisor</a> , <a href="#40398" title="Long">puts</a><span title="(x: Int)Long">/</span><a href="#40400" title="Int">writeDivisor</a> <span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>:_* <span class="delimiter">)</span>

    <span title="Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#40236" title="Boolean">haveStats</a><span class="delimiter">)</span> <a href="#40239" title="scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">result</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class GenericHashNamespace extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable with edu.berkeley.cs.scads.storage.QuorumProtocol with edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer with edu.berkeley.cs.scads.storage.KeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9542">GenericHashNamespace</a><a href="#9542" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="String" id="40668">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40669">cluster</a>: <a href="ScadsCluster.scala.html#9679" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40670">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="40671">keySchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="40672">valueSchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="String" id="40673">valueClass</a>: <span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9623" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9691" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9730" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9661" title="edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable">DefaultHashKeyRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9645" title="edu.berkeley.cs.scads.storage.QuorumProtocol">QuorumProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9511" title="edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer">AvroGenericKeyValueSerializer</a>
  <span class="keyword">with</span> <a href="Stores.scala.html#9713" title="edu.berkeley.cs.scads.storage.KeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">KeyValueStore</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span>

<span class="keyword">class</span> <a title="class SpecificNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AnalyticsProtocol with edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value] with edu.berkeley.cs.scads.storage.RangeKeyValueStore[Key,Value] with ScalaObject" id="9543">SpecificNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9544">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9545">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40715">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40716">cluster</a>: <a href="ScadsCluster.scala.html#9679" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40717">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9623" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9691" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9730" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9662" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9646" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AnalyticsProtocol.scala.html#9490" title="edu.berkeley.cs.scads.storage.AnalyticsProtocol">AnalyticsProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9513" title="edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value]">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9718" title="edu.berkeley.cs.scads.storage.RangeKeyValueStore[Key,Value]">RangeKeyValueStore</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="40692">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40689" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9544" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="40694">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40690" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9545" title="Value">Value</a><span class="delimiter">]</span> 

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.GenericNamespace" id="40697">genericNamespace</a>: <a href="#9541" title="edu.berkeley.cs.scads.storage.GenericNamespace">GenericNamespace</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.GenericNamespace" id="40724">generic</a> = <span title="edu.berkeley.cs.scads.storage.GenericNamespace" class="keyword">new</span> <a href="#9541" title="edu.berkeley.cs.scads.storage.GenericNamespace">GenericNamespace</a><span class="delimiter">(</span><a href="#40715" title="=&gt; String">name</a>, <a href="#40716" title="=&gt; edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>, <a href="#40717" title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</a>, <a href="AvroSerializer.scala.html#33202" title="=&gt; org.apache.avro.Schema">keySchema</a>, <a href="AvroSerializer.scala.html#33204" title="=&gt; org.apache.avro.Schema">valueSchema</a>, <a href="AvroSerializer.scala.html#33206" title="=&gt; java.lang.String">valueClass</a><span class="delimiter">)</span>
    <a href="#40724" title="edu.berkeley.cs.scads.storage.GenericNamespace">generic</a>.<a href="Namespace.scala.html#13615" title="()Unit">open</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#40724" title="edu.berkeley.cs.scads.storage.GenericNamespace">generic</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SpecificInMemoryNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends edu.berkeley.cs.scads.storage.SpecificNamespace[Key,Value] with ScalaObject" id="9546">SpecificInMemoryNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9547">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9548">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40766">imname</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40767">imcluster</a>: <a href="ScadsCluster.scala.html#9679" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40768">imroot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#9543" title="edu.berkeley.cs.scads.storage.SpecificNamespace[Key,Value]">SpecificNamespace</a><span class="delimiter">[</span>Key,Value<span class="delimiter">]</span><span class="delimiter">(</span><a href="#40766" title="String">imname</a>,<a href="#40767" title="edu.berkeley.cs.scads.storage.ScadsCluster">imcluster</a>,<a href="#40768" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">imroot</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="40746">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40743" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9547" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="40748">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40744" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9548" title="Value">Value</a><span class="delimiter">]</span> 

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="40750">partitionType</a>:<span title="String">String</span> = <span title="java.lang.String(&quot;inmemory&quot;)" class="string">&quot;inmemory&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SpecificHashNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable with edu.berkeley.cs.scads.storage.QuorumProtocol with edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value] with edu.berkeley.cs.scads.storage.KeyValueStore[Key,Value] with ScalaObject" id="9549">SpecificHashNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9550">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9551">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40814">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40815">cluster</a>: <a href="ScadsCluster.scala.html#9679" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40816">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9623" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9691" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9730" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9661" title="edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable">DefaultHashKeyRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9645" title="edu.berkeley.cs.scads.storage.QuorumProtocol">QuorumProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9513" title="edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value]">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9713" title="edu.berkeley.cs.scads.storage.KeyValueStore[Key,Value]">KeyValueStore</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="40795">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40792" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9550" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="40797">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40793" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9551" title="Value">Value</a><span class="delimiter">]</span> 

<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class PairNamespace[Pair &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AvroPairSerializer[Pair] with edu.berkeley.cs.scads.storage.RecordStore[Pair] with edu.berkeley.cs.scads.storage.IndexManager[Pair] with edu.berkeley.cs.scads.storage.DebuggingClient with edu.berkeley.cs.scads.storage.NamespaceIterator[Pair] with ScalaObject" id="9552">PairNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="9553">Pair</a> &lt;: AvroPair : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40888">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40889">cluster</a>: <a href="ScadsCluster.scala.html#9679" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40890">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9623" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9691" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9730" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a> 
  <span class="keyword">with</span> <a href="Routable.scala.html#9662" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9646" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9516" title="edu.berkeley.cs.scads.storage.AvroPairSerializer[Pair]">AvroPairSerializer</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9721" title="edu.berkeley.cs.scads.storage.RecordStore[Pair]">RecordStore</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="IndexManager.scala.html#9579" title="edu.berkeley.cs.scads.storage.IndexManager[Pair]">IndexManager</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Debugging.scala.html#9530" title="edu.berkeley.cs.scads.storage.DebuggingClient">DebuggingClient</a> 
  <span class="keyword">with</span> <a href="NamespaceIterator.scala.html#9629" title="edu.berkeley.cs.scads.storage.NamespaceIterator[Pair]">NamespaceIterator</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span> <span class="delimiter">{</span>
  
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Pair]" id="40835">pairManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40833" title="(implicit m: Manifest[Pair])Manifest[Pair]" class="delimiter">[</a><a href="#9553" title="Pair">Pair</a><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]" id="40837">asyncGetRecord</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="40896">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]">ScadsFuture</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Pair<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="40913">keyBytes</a> = <a href="AvroSerializer.scala.html#33237" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#40896" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>
    <a href="QuorumProtocol.scala.html#13543" title="(key: Array[Byte])edu.berkeley.cs.scads.comm.ScadsFuture[Option[Array[Byte]]]">asyncGetBytes</a><span class="delimiter">(</span><a href="#40913" title="Array[Byte]">keyBytes</a><span class="delimiter">)</span> <span title="(f: Option[Array[Byte]] =&gt; Option[Pair])edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]">map</span> <span class="delimiter">(</span><a href="#40931" title="Option[Array[Byte]]">_</a>.<span title="(f: Array[Byte] =&gt; Pair)Option[Pair]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33236" title="(key: Array[Byte], value: Array[Byte])Pair">bytesToBulk</a><span class="delimiter">(</span><a href="#40913" title="Array[Byte]">keyBytes</a>, <a href="#40936" title="Array[Byte]">_</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)Option[Pair]" id="40838">getRecord</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="40939">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="Option[Pair]">Option</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="40943">keyBytes</a> = <a href="AvroSerializer.scala.html#33237" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#40939" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>

    <a href="QuorumProtocol.scala.html#13542" title="(key: Array[Byte])Option[Array[Byte]]">getBytes</a><span class="delimiter">(</span><a href="#40943" title="Array[Byte]">keyBytes</a><span class="delimiter">)</span>.<span title="(f: Array[Byte] =&gt; Pair)Option[Pair]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33236" title="(key: Array[Byte], value: Array[Byte])Pair">bytesToBulk</a><span class="delimiter">(</span><a href="#40943" title="Array[Byte]">keyBytes</a>, <a href="#40951" title="Array[Byte]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pairRec: Pair)Unit" id="40839">put</a><span class="delimiter">(</span><a title="Pair" id="40953">pairRec</a>: <a href="#9553" title="Pair">Pair</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="IndexManager.scala.html#40855" title="(key: org.apache.avro.generic.IndexedRecord, value: Option[org.apache.avro.generic.IndexedRecord])Unit">put</a><span class="delimiter">(</span><a href="#40953" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>, <span title="(x: org.apache.avro.generic.GenericRecord)Some[org.apache.avro.generic.GenericRecord]">Some</span><span class="delimiter">(</span><a href="#40953" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">value</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pairRec: Pair)Unit" id="40840">delete</a><span class="delimiter">(</span><a title="Pair" id="41063">pairRec</a>: <a href="#9553" title="Pair">Pair</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="IndexManager.scala.html#40855" title="(key: org.apache.avro.generic.IndexedRecord, value: Option[org.apache.avro.generic.IndexedRecord])Unit">put</a><span class="delimiter">(</span><a href="#41063" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>, <span title="object None">None</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>