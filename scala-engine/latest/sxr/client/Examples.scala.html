<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>client/Examples.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.storage

<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.util._

<span class="keyword">import</span> org.apache.avro._
<span class="keyword">import</span> generic._
<span class="keyword">import</span> specific._

<span class="keyword">import</span> java.util.Comparator

<span class="comment">// TODO: change Manifest to ClassManifest</span>
<span class="keyword">class</span> <a title="class GenericNamespace extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer with edu.berkeley.cs.scads.storage.RangeKeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9543">GenericNamespace</a><a href="#9543" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="String" id="38436">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="38437">cluster</a>: <a href="ScadsCluster.scala.html#9681" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="38438">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="38439">keySchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="38440">valueSchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="String" id="38441">valueClass</a>: <span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9625" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
    <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9693" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9732" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9664" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9648" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9513" title="edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer">AvroGenericKeyValueSerializer</a>
  <span class="keyword">with</span> <a href="Stores.scala.html#9720" title="edu.berkeley.cs.scads.storage.RangeKeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">RangeKeyValueStore</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="comment">/** this is a HACK for now, to handle integration with the director */</span>
  <span class="keyword">def</span> <a title="=&gt; edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" id="37927">typedRoutingTable</a>: <a href="../util/RangeTable.scala.html#9978" title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeTable</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" id="38489">_rt</a> = <a href="Routable.scala.html#37970" title="=&gt; edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">routingTable</a>
    <span class="keyword">val</span> <a title="Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" id="38490">newRTable</a> = <a href="#38489" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">_rt</a>.<a href="../util/RangeTable.scala.html#38451" title="(xs: Array[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]])scala.collection.mutable.ArrayOps[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]]">rTable</a>.<span title="(f: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService] =&gt; edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService])(implicit bf: scala.collection.generic.CanBuildFrom[Array[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]],edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService],Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]])Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]">map</span><span title="(implicit m: scala.reflect.ClassManifest[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]])scala.collection.generic.CanBuildFrom[Array[_],edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService],Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]]" class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" id="39860">rt</a> =&gt; <span title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9981" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#39860" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">rt</a>.<a href="../util/RangeTable.scala.html#38930" title="=&gt; Option[Array[Byte]]">startKey</a>.<span title="(f: Array[Byte] =&gt; org.apache.avro.generic.GenericRecord)Option[org.apache.avro.generic.GenericRecord]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33103" title="(bytes: Array[Byte])org.apache.avro.generic.GenericRecord">bytesToKey</a><span class="delimiter">)</span>, <a href="#39860" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">rt</a>.<a href="../util/RangeTable.scala.html#38932" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">values</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="keyComp extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" id="38491">keyComp</a> = <a href="#39957" title="java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]" id="39957">Comparator</a><span class="delimiter">[</span>RangeType<span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(lhs: edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService], rhs: edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService])Int" id="39959">compare</a><span class="delimiter">(</span>
          <a title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" id="39960">lhs</a>: <a href="../util/RangeTable.scala.html#9981" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span>, 
          <a title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" id="39961">rhs</a>: <a href="../util/RangeTable.scala.html#9981" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
        <a href="#38489" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">_rt</a>.<a href="../util/RangeTable.scala.html#38453" title="=&gt; java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]]">keyComparator</a>.<span title="(x$1: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService], x$2: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService])Int">compare</span><span class="delimiter">(</span>
          <span title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9981" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#39960" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">lhs</a>.<a href="../util/RangeTable.scala.html#38930" title="=&gt; Option[org.apache.avro.generic.GenericRecord]">startKey</a>.<span title="(f: org.apache.avro.generic.GenericRecord =&gt; Array[Byte])Option[Array[Byte]]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33106" title="(key: org.apache.avro.generic.GenericRecord)Array[Byte]">keyToBytes</a><span class="delimiter">)</span>, <a href="#39960" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">lhs</a>.<a href="../util/RangeTable.scala.html#38932" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">values</a><span class="delimiter">)</span>,
          <span title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9981" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">RangeType</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#39961" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">rhs</a>.<a href="../util/RangeTable.scala.html#38930" title="=&gt; Option[org.apache.avro.generic.GenericRecord]">startKey</a>.<span title="(f: org.apache.avro.generic.GenericRecord =&gt; Array[Byte])Option[Array[Byte]]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33106" title="(key: org.apache.avro.generic.GenericRecord)Array[Byte]">keyToBytes</a><span class="delimiter">)</span>, <a href="#39961" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">rhs</a>.<a href="../util/RangeTable.scala.html#38932" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">values</a><span class="delimiter">)</span>
        <span class="delimiter">)</span> 
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]" class="keyword">new</span> <a href="../util/RangeTable.scala.html#9978" title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]">RangeTable</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#38490" title="Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]">newRTable</a>, <a href="#38491" title="keyComp extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.comm.PartitionService]]">keyComp</a>, <a href="#38489" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.comm.PartitionService]">_rt</a>.<a href="../util/RangeTable.scala.html#38455" title="=&gt; (Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.PartitionService]) =&gt; Boolean">mergeCondition</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="37928">statslogger</a> = net.lag.logging.<span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;statsprotocol&quot;)" class="string">&quot;statsprotocol&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
  * For each range represented by me, get the worklad stats from all the partitions
  * Add stats from partitions that cover the same range, dividing by the quorum amount
  * (Do this to get &quot;logical&quot; workload to a partition)
  * Return mapping of startkey to tuple of (gets,puts)
  * TODO: is this assuming that the read/write quorum will never change?
  */</span>
  <span class="keyword">def</span> <a title="(time: Long)Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" id="37930">getWorkloadStats</a><span class="delimiter">(</span><a title="Long" id="40023">time</a>:<span title="Long">Long</span><span class="delimiter">)</span>:<span title="Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">Map</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>GenericRecord<span class="delimiter">]</span>, <span class="delimiter">(</span>Long,Long<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="40232">haveStats</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[edu.berkeley.cs.scads.storage.RangeDesc]" id="40233">ranges</a> = <a href="Routable.scala.html#37998" title="(startKey: Option[Array[Byte]], endKey: Option[Array[Byte]])Seq[edu.berkeley.cs.scads.storage.RangeDesc]">serversForKeyRange</a><span class="delimiter">(</span><span title="object None">None</span>,<span title="object None">None</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]" id="40234">requests</a> = <span class="keyword">for</span> <span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.RangeDesc" id="40255">fullrange</a> &lt;- <a href="#40233" title="(f: edu.berkeley.cs.scads.storage.RangeDesc =&gt; (Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.RangeDesc],(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture]),Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]])Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]">ranges</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span title="(_1: Option[Array[Byte]], _2: Option[Array[Byte]], _3: Seq[edu.berkeley.cs.scads.comm.PartitionService], _4: Seq[edu.berkeley.cs.scads.comm.MessageFuture])(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])" class="delimiter">(</span><a href="#40255" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27796" title="=&gt; Option[Array[Byte]]">startKey</a>,<a href="#40255" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27798" title="=&gt; Option[Array[Byte]]">endKey</a>, <a href="#40255" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27800" title="=&gt; Seq[edu.berkeley.cs.scads.comm.PartitionService]">servers</a>, <span class="keyword">for</span> <span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.PartitionService" id="40280">partition</a> &lt;- <a href="#40255" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#27800" title="(f: edu.berkeley.cs.scads.comm.PartitionService =&gt; edu.berkeley.cs.scads.comm.MessageFuture)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.comm.PartitionService],edu.berkeley.cs.scads.comm.MessageFuture,Seq[edu.berkeley.cs.scads.comm.MessageFuture]])Seq[edu.berkeley.cs.scads.comm.MessageFuture]">servers</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span><a href="#40280" title="edu.berkeley.cs.scads.comm.PartitionService">partition</a> <span title="(body: edu.berkeley.cs.scads.comm.MessageBody)edu.berkeley.cs.scads.comm.MessageFuture">!!</span> <span title="()edu.berkeley.cs.scads.comm.GetWorkloadStats">GetWorkloadStats</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">}</span> <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" id="40235">result</a> = <span title="(elems: (Option[org.apache.avro.generic.GenericRecord], (Long, Long))*)scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">Map</span><span class="delimiter">(</span> <a href="#40234" title="Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])]">requests</a>.<span title="(f: (Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture]) =&gt; (Option[org.apache.avro.generic.GenericRecord], (Long, Long)))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])],(Option[org.apache.avro.generic.GenericRecord], (Long, Long)),Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]])Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(Option[org.apache.avro.generic.GenericRecord], (Long, Long)),Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]]" class="delimiter">(</span><a title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])" id="40392">range</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Long" id="40393">gets</a> = <span title="Long(0L)" class="long">0L</span>; <span class="keyword">var</span> <a title="Long" id="40394">puts</a> = <span title="Long(0L)" class="long">0L</span>
      <span class="keyword">val</span> <a title="Int" id="40395">readDivisor</a> = <a href="#40392" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture]">_4</span>.<span title="=&gt; Int">size</span><span class="comment">//scala.math.ceil(range._4.size * readQuorum).toLong</span>
      <span class="keyword">val</span> <a title="Int" id="40396">writeDivisor</a> = <a href="#40392" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture]">_4</span>.<span title="=&gt; Int">size</span><span class="comment">//scala.math.ceil(range._4.size * writeQuorum).toLong</span>

      <a href="#40392" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture]">_4</span>.<span title="(f: edu.berkeley.cs.scads.comm.MessageFuture =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.MessageFuture" id="40413">resp</a> =&gt; <span class="delimiter">{</span> <span class="keyword">val</span> <a href="#40415" title="(Long, Long, Long)" class="delimiter">(</a><a href="#40414" title="Long" id="40415">getcount</a>,<a href="#40414" title="Long" id="40416">putcount</a>,<a href="#40414" title="Long" id="40417">statstime</a><span class="delimiter">)</span> = <a href="#40413" title="edu.berkeley.cs.scads.comm.MessageFuture">resp</a>.<span title="()edu.berkeley.cs.scads.comm.MessageBody">get</span> <span title="(Long, Long, Long)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="(Long, Long, Long)" id="40420">r</a>:<span title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">GetWorkloadStatsResponse</span> =&gt; <span title="(_1: Long, _2: Long, _3: Long)(Long, Long, Long)" class="delimiter">(</span><a href="#40420" title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">r</a>.<span title="=&gt; Int">getCount</span>.<span title="=&gt; Long">toLong</span>,<a href="#40420" title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">r</a>.<span title="=&gt; Int">putCount</span>.<span title="=&gt; Long">toLong</span>,<a href="#40420" title="edu.berkeley.cs.scads.comm.GetWorkloadStatsResponse">r</a>.<span title="=&gt; Long">statsSince</span>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>; <span class="keyword">case</span> <span title="(Long, Long, Long)">_</span> =&gt; <span title="(_1: Long, _2: Long, _3: Long)(Long, Long, Long)" class="delimiter">(</span><span title="Long(0L)" class="long">0L</span>,<span title="Long(0L)" class="long">0L</span>,<span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>; <a href="#40393" title="Long">gets</a> <span title="(x: Long)Long">+=</span> <a href="#40415" title="Long">getcount</a>; <a href="#40394" title="Long">puts</a> <span title="(x: Long)Long">+=</span> <a href="#40416" title="Long">putcount</a>; <a href="#37928" title="=&gt; net.lag.logging.Logger">statslogger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;workload stats for: %s&quot;)" class="string">&quot;workload stats for: %s&quot;</span>,<a href="#40417" title="Long">statstime</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>; <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#40417" title="Long">statstime</a> <span title="(x: Long)Boolean">&gt;=</span> <a href="#40023" title="Long">time</a><span class="delimiter">)</span> <a href="#40232" title="Boolean">haveStats</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">}</span> <span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#40392" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.comm.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture])">range</a>.<span title="=&gt; Option[Array[Byte]]">_1</span>.<span title="(f: Array[Byte] =&gt; org.apache.avro.generic.GenericRecord)Option[org.apache.avro.generic.GenericRecord]">map</span><span title="(x: Option[org.apache.avro.generic.GenericRecord])ArrowAssoc[Option[org.apache.avro.generic.GenericRecord]]" class="delimiter">(</span><a href="AvroSerializer.scala.html#33103" title="(bytes: Array[Byte])org.apache.avro.generic.GenericRecord">bytesToKey</a><span class="delimiter">)</span> <span title="(y: (Long, Long))(Option[org.apache.avro.generic.GenericRecord], (Long, Long))">-&gt;</span> <span class="delimiter">(</span> <a href="#40393" title="Long">gets</a><span title="(x: Int)Long">/</span><a href="#40395" title="Int">readDivisor</a> , <a href="#40394" title="Long">puts</a><span title="(x: Int)Long">/</span><a href="#40396" title="Int">writeDivisor</a> <span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>:_* <span class="delimiter">)</span>

    <span title="Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#40232" title="Boolean">haveStats</a><span class="delimiter">)</span> <a href="#40235" title="scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">result</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class GenericHashNamespace extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable with edu.berkeley.cs.scads.storage.QuorumProtocol with edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer with edu.berkeley.cs.scads.storage.KeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9544">GenericHashNamespace</a><a href="#9544" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="String" id="40664">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40665">cluster</a>: <a href="ScadsCluster.scala.html#9681" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40666">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="40667">keySchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="40668">valueSchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="String" id="40669">valueClass</a>: <span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9625" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9693" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9732" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9663" title="edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable">DefaultHashKeyRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9647" title="edu.berkeley.cs.scads.storage.QuorumProtocol">QuorumProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9513" title="edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer">AvroGenericKeyValueSerializer</a>
  <span class="keyword">with</span> <a href="Stores.scala.html#9715" title="edu.berkeley.cs.scads.storage.KeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">KeyValueStore</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span>

<span class="keyword">class</span> <a title="class SpecificNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AnalyticsProtocol with edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value] with edu.berkeley.cs.scads.storage.RangeKeyValueStore[Key,Value] with ScalaObject" id="9545">SpecificNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9546">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9547">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40711">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40712">cluster</a>: <a href="ScadsCluster.scala.html#9681" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40713">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9625" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9693" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9732" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9664" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9648" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AnalyticsProtocol.scala.html#9492" title="edu.berkeley.cs.scads.storage.AnalyticsProtocol">AnalyticsProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9515" title="edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value]">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9720" title="edu.berkeley.cs.scads.storage.RangeKeyValueStore[Key,Value]">RangeKeyValueStore</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="40688">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40685" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9546" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="40690">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40686" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9547" title="Value">Value</a><span class="delimiter">]</span> 

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.GenericNamespace" id="40693">genericNamespace</a>: <a href="#9543" title="edu.berkeley.cs.scads.storage.GenericNamespace">GenericNamespace</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.GenericNamespace" id="40720">generic</a> = <span title="edu.berkeley.cs.scads.storage.GenericNamespace" class="keyword">new</span> <a href="#9543" title="edu.berkeley.cs.scads.storage.GenericNamespace">GenericNamespace</a><span class="delimiter">(</span><a href="#40711" title="=&gt; String">name</a>, <a href="#40712" title="=&gt; edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>, <a href="#40713" title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</a>, <a href="AvroSerializer.scala.html#33198" title="=&gt; org.apache.avro.Schema">keySchema</a>, <a href="AvroSerializer.scala.html#33200" title="=&gt; org.apache.avro.Schema">valueSchema</a>, <a href="AvroSerializer.scala.html#33202" title="=&gt; java.lang.String">valueClass</a><span class="delimiter">)</span>
    <a href="#40720" title="edu.berkeley.cs.scads.storage.GenericNamespace">generic</a>.<a href="Namespace.scala.html#13611" title="()Unit">open</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#40720" title="edu.berkeley.cs.scads.storage.GenericNamespace">generic</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SpecificInMemoryNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends edu.berkeley.cs.scads.storage.SpecificNamespace[Key,Value] with ScalaObject" id="9548">SpecificInMemoryNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9549">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9550">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40762">imname</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40763">imcluster</a>: <a href="ScadsCluster.scala.html#9681" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40764">imroot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#9545" title="edu.berkeley.cs.scads.storage.SpecificNamespace[Key,Value]">SpecificNamespace</a><span class="delimiter">[</span>Key,Value<span class="delimiter">]</span><span class="delimiter">(</span><a href="#40762" title="String">imname</a>,<a href="#40763" title="edu.berkeley.cs.scads.storage.ScadsCluster">imcluster</a>,<a href="#40764" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">imroot</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="40742">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40739" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9549" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="40744">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40740" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9550" title="Value">Value</a><span class="delimiter">]</span> 

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="40746">partitionType</a>:<span title="String">String</span> = <span title="java.lang.String(&quot;inmemory&quot;)" class="string">&quot;inmemory&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SpecificHashNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable with edu.berkeley.cs.scads.storage.QuorumProtocol with edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value] with edu.berkeley.cs.scads.storage.KeyValueStore[Key,Value] with ScalaObject" id="9551">SpecificHashNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9552">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9553">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40810">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40811">cluster</a>: <a href="ScadsCluster.scala.html#9681" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40812">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9625" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9693" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9732" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9663" title="edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable">DefaultHashKeyRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9647" title="edu.berkeley.cs.scads.storage.QuorumProtocol">QuorumProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9515" title="edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value]">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9715" title="edu.berkeley.cs.scads.storage.KeyValueStore[Key,Value]">KeyValueStore</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="40791">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40788" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9552" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="40793">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40789" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9553" title="Value">Value</a><span class="delimiter">]</span> 

<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class PairNamespace[Pair &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AvroPairSerializer[Pair] with edu.berkeley.cs.scads.storage.RecordStore[Pair] with edu.berkeley.cs.scads.storage.IndexManager[Pair] with edu.berkeley.cs.scads.storage.DebuggingClient with edu.berkeley.cs.scads.storage.NamespaceIterator[Pair] with ScalaObject" id="9554">PairNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="9555">Pair</a> &lt;: AvroPair : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="40884">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="40885">cluster</a>: <a href="ScadsCluster.scala.html#9681" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="40886">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9625" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9693" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9732" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a> 
  <span class="keyword">with</span> <a href="Routable.scala.html#9664" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9648" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9518" title="edu.berkeley.cs.scads.storage.AvroPairSerializer[Pair]">AvroPairSerializer</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9723" title="edu.berkeley.cs.scads.storage.RecordStore[Pair]">RecordStore</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="IndexManager.scala.html#9581" title="edu.berkeley.cs.scads.storage.IndexManager[Pair]">IndexManager</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Debugging.scala.html#9532" title="edu.berkeley.cs.scads.storage.DebuggingClient">DebuggingClient</a> 
  <span class="keyword">with</span> <a href="NamespaceIterator.scala.html#9631" title="edu.berkeley.cs.scads.storage.NamespaceIterator[Pair]">NamespaceIterator</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span> <span class="delimiter">{</span>
  
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Pair]" id="40831">pairManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#40829" title="(implicit m: Manifest[Pair])Manifest[Pair]" class="delimiter">[</a><a href="#9555" title="Pair">Pair</a><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]" id="40833">asyncGetRecord</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="40892">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]">ScadsFuture</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Pair<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="40909">keyBytes</a> = <a href="AvroSerializer.scala.html#33233" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#40892" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>
    <a href="QuorumProtocol.scala.html#13539" title="(key: Array[Byte])edu.berkeley.cs.scads.comm.ScadsFuture[Option[Array[Byte]]]">asyncGetBytes</a><span class="delimiter">(</span><a href="#40909" title="Array[Byte]">keyBytes</a><span class="delimiter">)</span> <span title="(f: Option[Array[Byte]] =&gt; Option[Pair])edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]">map</span> <span class="delimiter">(</span><a href="#40927" title="Option[Array[Byte]]">_</a>.<span title="(f: Array[Byte] =&gt; Pair)Option[Pair]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33232" title="(key: Array[Byte], value: Array[Byte])Pair">bytesToBulk</a><span class="delimiter">(</span><a href="#40909" title="Array[Byte]">keyBytes</a>, <a href="#40932" title="Array[Byte]">_</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)Option[Pair]" id="40834">getRecord</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="40935">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="Option[Pair]">Option</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="40939">keyBytes</a> = <a href="AvroSerializer.scala.html#33233" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#40935" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>

    <a href="QuorumProtocol.scala.html#13538" title="(key: Array[Byte])Option[Array[Byte]]">getBytes</a><span class="delimiter">(</span><a href="#40939" title="Array[Byte]">keyBytes</a><span class="delimiter">)</span>.<span title="(f: Array[Byte] =&gt; Pair)Option[Pair]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#33232" title="(key: Array[Byte], value: Array[Byte])Pair">bytesToBulk</a><span class="delimiter">(</span><a href="#40939" title="Array[Byte]">keyBytes</a>, <a href="#40947" title="Array[Byte]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pairRec: Pair)Unit" id="40835">put</a><span class="delimiter">(</span><a title="Pair" id="40949">pairRec</a>: <a href="#9555" title="Pair">Pair</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="IndexManager.scala.html#40851" title="(key: org.apache.avro.generic.IndexedRecord, value: Option[org.apache.avro.generic.IndexedRecord])Unit">put</a><span class="delimiter">(</span><a href="#40949" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>, <span title="(x: org.apache.avro.generic.GenericRecord)Some[org.apache.avro.generic.GenericRecord]">Some</span><span class="delimiter">(</span><a href="#40949" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">value</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pairRec: Pair)Unit" id="40836">delete</a><span class="delimiter">(</span><a title="Pair" id="41059">pairRec</a>: <a href="#9555" title="Pair">Pair</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="IndexManager.scala.html#40851" title="(key: org.apache.avro.generic.IndexedRecord, value: Option[org.apache.avro.generic.IndexedRecord])Unit">put</a><span class="delimiter">(</span><a href="#41059" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>, <span title="object None">None</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>