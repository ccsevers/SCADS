<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>client/Examples.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> storage

<span class="keyword">import</span> client._

<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.util._

<span class="keyword">import</span> org.apache.avro._
<span class="keyword">import</span> generic._
<span class="keyword">import</span> specific._

<span class="keyword">import</span> java.util.Comparator

<span class="comment">// TODO: change Manifest to ClassManifest</span>
<span class="keyword">class</span> <a title="class GenericNamespace extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer with edu.berkeley.cs.scads.storage.RangeKeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9789">GenericNamespace</a><a href="#9789" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="String" id="42174">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="42175">cluster</a>: <a href="ScadsCluster.scala.html#9930" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="42176">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="42177">keySchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="42178">valueSchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="String" id="42179">valueClass</a>: <span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9873" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
    <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9942" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9981" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9913" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9897" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9758" title="edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer">AvroGenericKeyValueSerializer</a>
  <span class="keyword">with</span> <a href="Stores.scala.html#9969" title="edu.berkeley.cs.scads.storage.RangeKeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">RangeKeyValueStore</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="comment">/** this is a HACK for now, to handle integration with the director */</span>
  <span class="keyword">def</span> <a title="=&gt; edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]" id="41668">typedRoutingTable</a>: <a href="util/RangeTable.scala.html#10593" title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">RangeTable</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]" id="42307">_rt</a> = <a href="Routable.scala.html#41711" title="=&gt; edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">routingTable</a>
    <span class="keyword">val</span> <a title="Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]" id="42308">newRTable</a> = <a href="#42307" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">_rt</a>.<a href="util/RangeTable.scala.html#46932" title="(xs: Array[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]])scala.collection.mutable.ArrayOps[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]]">rTable</a>.<span title="(f: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService] =&gt; edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService])(implicit bf: scala.collection.generic.CanBuildFrom[Array[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]],edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService],Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]])Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]">map</span><span title="(implicit m: scala.reflect.ClassManifest[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]])scala.collection.generic.CanBuildFrom[Array[_],edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService],Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]]" class="delimiter">(</span><a title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]" id="43709">rt</a> =&gt; <span title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]" class="keyword">new</span> <a href="util/RangeTable.scala.html#115763" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#43709" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">rt</a>.<a href="util/RangeTable.scala.html#115756" title="=&gt; Option[Array[Byte]]">startKey</a>.<span title="(f: Array[Byte] =&gt; org.apache.avro.generic.GenericRecord)Option[org.apache.avro.generic.GenericRecord]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#36281" title="(bytes: Array[Byte])org.apache.avro.generic.GenericRecord">bytesToKey</a><span class="delimiter">)</span>, <a href="#43709" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">rt</a>.<a href="util/RangeTable.scala.html#115757" title="=&gt; Seq[edu.berkeley.cs.scads.storage.PartitionService]">values</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="keyComp extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]" id="42309">keyComp</a> = <a href="#43792" title="java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]" id="43792">Comparator</a><span class="delimiter">[</span>RangeType<span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(lhs: edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService], rhs: edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService])Int" id="43794">compare</a><span class="delimiter">(</span>
          <a title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]" id="43795">lhs</a>: <a href="util/RangeTable.scala.html#115763" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span>, 
          <a title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]" id="43796">rhs</a>: <a href="util/RangeTable.scala.html#115763" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">RangeType</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
        <a href="#42307" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">_rt</a>.<a href="util/RangeTable.scala.html#46933" title="=&gt; java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]]">keyComparator</a>.<span title="(x$1: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService], x$2: edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService])Int">compare</span><span class="delimiter">(</span>
          <span title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]" class="keyword">new</span> <a href="util/RangeTable.scala.html#115763" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">RangeType</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#43795" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">lhs</a>.<a href="util/RangeTable.scala.html#115756" title="=&gt; Option[org.apache.avro.generic.GenericRecord]">startKey</a>.<span title="(f: org.apache.avro.generic.GenericRecord =&gt; Array[Byte])Option[Array[Byte]]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#36284" title="(key: org.apache.avro.generic.GenericRecord)Array[Byte]">keyToBytes</a><span class="delimiter">)</span>, <a href="#43795" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">lhs</a>.<a href="util/RangeTable.scala.html#115757" title="=&gt; Seq[edu.berkeley.cs.scads.storage.PartitionService]">values</a><span class="delimiter">)</span>,
          <span title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]" class="keyword">new</span> <a href="util/RangeTable.scala.html#115763" title="edu.berkeley.cs.scads.util.RangeType[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">RangeType</a><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span>, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#43796" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">rhs</a>.<a href="util/RangeTable.scala.html#115756" title="=&gt; Option[org.apache.avro.generic.GenericRecord]">startKey</a>.<span title="(f: org.apache.avro.generic.GenericRecord =&gt; Array[Byte])Option[Array[Byte]]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#36284" title="(key: org.apache.avro.generic.GenericRecord)Array[Byte]">keyToBytes</a><span class="delimiter">)</span>, <a href="#43796" title="edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">rhs</a>.<a href="util/RangeTable.scala.html#115757" title="=&gt; Seq[edu.berkeley.cs.scads.storage.PartitionService]">values</a><span class="delimiter">)</span>
        <span class="delimiter">)</span> 
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]" class="keyword">new</span> <a href="util/RangeTable.scala.html#10593" title="edu.berkeley.cs.scads.util.RangeTable[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]">RangeTable</a><span class="delimiter">[</span>GenericRecord, PartitionService<span class="delimiter">]</span><span class="delimiter">(</span><a href="#42308" title="Array[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]">newRTable</a>, <a href="#42309" title="keyComp extends java.lang.Object with java.util.Comparator[edu.berkeley.cs.scads.util.RangeType[org.apache.avro.generic.GenericRecord,edu.berkeley.cs.scads.storage.PartitionService]]">keyComp</a>, <a href="#42307" title="edu.berkeley.cs.scads.util.RangeTable[Array[Byte],edu.berkeley.cs.scads.storage.PartitionService]">_rt</a>.<a href="util/RangeTable.scala.html#46934" title="=&gt; (Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.storage.PartitionService]) =&gt; Boolean">mergeCondition</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="41669">statslogger</a> = net.lag.logging.<span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;statsprotocol&quot;)" class="string">&quot;statsprotocol&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
  * For each range represented by me, get the worklad stats from all the partitions
  * Add stats from partitions that cover the same range, dividing by the quorum amount
  * (Do this to get &quot;logical&quot; workload to a partition)
  * Return mapping of startkey to tuple of (gets,puts)
  * TODO: is this assuming that the read/write quorum will never change?
  */</span>
  <span class="keyword">def</span> <a title="(time: Long)Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" id="41671">getWorkloadStats</a><span class="delimiter">(</span><a title="Long" id="43849">time</a>:<span title="Long">Long</span><span class="delimiter">)</span>:<span title="Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">Map</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>GenericRecord<span class="delimiter">]</span>, <span class="delimiter">(</span>Long,Long<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="44058">haveStats</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">val</span> <a title="Seq[edu.berkeley.cs.scads.storage.RangeDesc]" id="44059">ranges</a> = <a href="Routable.scala.html#41739" title="(startKey: Option[Array[Byte]], endKey: Option[Array[Byte]])Seq[edu.berkeley.cs.scads.storage.RangeDesc]">serversForKeyRange</a><span class="delimiter">(</span><span title="object None">None</span>,<span title="object None">None</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])]" id="44060">requests</a> = <span class="keyword">for</span> <span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.RangeDesc" id="44081">fullrange</a> &lt;- <a href="#44059" title="(f: edu.berkeley.cs.scads.storage.RangeDesc =&gt; (Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.RangeDesc],(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]),Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])]])Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])]">ranges</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span title="(_1: Option[Array[Byte]], _2: Option[Array[Byte]], _3: Seq[edu.berkeley.cs.scads.storage.PartitionService], _4: Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])" class="delimiter">(</span><a href="#44081" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#31375" title="=&gt; Option[Array[Byte]]">startKey</a>,<a href="#44081" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#31377" title="=&gt; Option[Array[Byte]]">endKey</a>, <a href="#44081" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#31379" title="=&gt; Seq[edu.berkeley.cs.scads.storage.PartitionService]">servers</a>, <span class="keyword">for</span> <span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.PartitionService" id="44106">partition</a> &lt;- <a href="#44081" title="edu.berkeley.cs.scads.storage.RangeDesc">fullrange</a>.<a href="Interfaces.scala.html#31379" title="(f: edu.berkeley.cs.scads.storage.PartitionService =&gt; edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.storage.PartitionService],edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage],Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]])Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]">servers</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span><a href="#44106" title="edu.berkeley.cs.scads.storage.PartitionService">partition</a> <span title="(body: edu.berkeley.cs.scads.storage.StorageMessage)edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]">!!</span> <a href="../Messages.scala.html#23789" title="()edu.berkeley.cs.scads.storage.GetWorkloadStats">GetWorkloadStats</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">}</span> <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" id="44061">result</a> = <span title="(elems: (Option[org.apache.avro.generic.GenericRecord], (Long, Long))*)scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">Map</span><span class="delimiter">(</span> <a href="#44060" title="Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])]">requests</a>.<span title="(f: (Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]) =&gt; (Option[org.apache.avro.generic.GenericRecord], (Long, Long)))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])],(Option[org.apache.avro.generic.GenericRecord], (Long, Long)),Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]])Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(Option[org.apache.avro.generic.GenericRecord], (Long, Long)),Seq[(Option[org.apache.avro.generic.GenericRecord], (Long, Long))]]" class="delimiter">(</span><a title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])" id="44214">range</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Long" id="44215">gets</a> = <span title="Long(0L)" class="long">0L</span>; <span class="keyword">var</span> <a title="Long" id="44216">puts</a> = <span title="Long(0L)" class="long">0L</span>
      <span class="keyword">val</span> <a title="Int" id="44217">readDivisor</a> = <a href="#44214" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]">_4</span>.<span title="=&gt; Int">size</span><span class="comment">//scala.math.ceil(range._4.size * readQuorum).toLong</span>
      <span class="keyword">val</span> <a title="Int" id="44218">writeDivisor</a> = <a href="#44214" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]">_4</span>.<span title="=&gt; Int">size</span><span class="comment">//scala.math.ceil(range._4.size * writeQuorum).toLong</span>

      <a href="#44214" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])">range</a>.<span title="=&gt; Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]]">_4</span>.<span title="(f: edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage] =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]" id="44235">resp</a> =&gt; <span class="delimiter">{</span> <span class="keyword">val</span> <a href="#44237" title="(Long, Long, Long)" class="delimiter">(</a><a href="#44236" title="Long" id="44237">getcount</a>,<a href="#44236" title="Long" id="44238">putcount</a>,<a href="#44236" title="Long" id="44239">statstime</a><span class="delimiter">)</span> = <a href="#44235" title="edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]">resp</a>.<span title="()edu.berkeley.cs.scads.storage.StorageMessage">get</span> <span title="(Long, Long, Long)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="(Long, Long, Long)" id="44242">r</a>:<a href="../Messages.scala.html#9631" title="edu.berkeley.cs.scads.storage.GetWorkloadStatsResponse">GetWorkloadStatsResponse</a> =&gt; <span title="(_1: Long, _2: Long, _3: Long)(Long, Long, Long)" class="delimiter">(</span><a href="#44242" title="edu.berkeley.cs.scads.storage.GetWorkloadStatsResponse">r</a>.<a href="../Messages.scala.html#23805" title="=&gt; Int">getCount</a>.<span title="=&gt; Long">toLong</span>,<a href="#44242" title="edu.berkeley.cs.scads.storage.GetWorkloadStatsResponse">r</a>.<a href="../Messages.scala.html#23808" title="=&gt; Int">putCount</a>.<span title="=&gt; Long">toLong</span>,<a href="#44242" title="edu.berkeley.cs.scads.storage.GetWorkloadStatsResponse">r</a>.<a href="../Messages.scala.html#23811" title="=&gt; Long">statsSince</a>.<span title="=&gt; Long">toLong</span><span class="delimiter">)</span>; <span class="keyword">case</span> <span title="(Long, Long, Long)">_</span> =&gt; <span title="(_1: Long, _2: Long, _3: Long)(Long, Long, Long)" class="delimiter">(</span><span title="Long(0L)" class="long">0L</span>,<span title="Long(0L)" class="long">0L</span>,<span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>; <a href="#44215" title="Long">gets</a> <span title="(x: Long)Long">+=</span> <a href="#44237" title="Long">getcount</a>; <a href="#44216" title="Long">puts</a> <span title="(x: Long)Long">+=</span> <a href="#44238" title="Long">putcount</a>; <a href="#41669" title="=&gt; net.lag.logging.Logger">statslogger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;workload stats for: %s&quot;)" class="string">&quot;workload stats for: %s&quot;</span>,<a href="#44239" title="Long">statstime</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>; <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#44239" title="Long">statstime</a> <span title="(x: Long)Boolean">&gt;=</span> <a href="#43849" title="Long">time</a><span class="delimiter">)</span> <a href="#44058" title="Boolean">haveStats</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">}</span> <span class="delimiter">)</span>
      <span class="delimiter">(</span><a href="#44214" title="(Option[Array[Byte]], Option[Array[Byte]], Seq[edu.berkeley.cs.scads.storage.PartitionService], Seq[edu.berkeley.cs.scads.comm.MessageFuture[edu.berkeley.cs.scads.storage.StorageMessage]])">range</a>.<span title="=&gt; Option[Array[Byte]]">_1</span>.<span title="(f: Array[Byte] =&gt; org.apache.avro.generic.GenericRecord)Option[org.apache.avro.generic.GenericRecord]">map</span><span title="(x: Option[org.apache.avro.generic.GenericRecord])ArrowAssoc[Option[org.apache.avro.generic.GenericRecord]]" class="delimiter">(</span><a href="AvroSerializer.scala.html#36281" title="(bytes: Array[Byte])org.apache.avro.generic.GenericRecord">bytesToKey</a><span class="delimiter">)</span> <span title="(y: (Long, Long))(Option[org.apache.avro.generic.GenericRecord], (Long, Long))">-&gt;</span> <span class="delimiter">(</span> <a href="#44215" title="Long">gets</a><span title="(x: Int)Long">/</span><a href="#44217" title="Int">readDivisor</a> , <a href="#44216" title="Long">puts</a><span title="(x: Int)Long">/</span><a href="#44218" title="Int">writeDivisor</a> <span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>:_* <span class="delimiter">)</span>

    <span title="Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#44058" title="Boolean">haveStats</a><span class="delimiter">)</span> <a href="#44061" title="scala.collection.immutable.Map[Option[org.apache.avro.generic.GenericRecord],(Long, Long)]">result</a> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class GenericHashNamespace extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable with edu.berkeley.cs.scads.storage.QuorumProtocol with edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer with edu.berkeley.cs.scads.storage.KeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord] with ScalaObject" id="9790">GenericHashNamespace</a><a href="#9790" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="String" id="44486">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="44487">cluster</a>: <a href="ScadsCluster.scala.html#9930" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="44488">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="44489">keySchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="org.apache.avro.Schema" id="44490">valueSchema</a>: <span title="org.apache.avro.Schema">Schema</span>,
    <span class="keyword">val</span> <a title="String" id="44491">valueClass</a>: <span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9873" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9942" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9981" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9912" title="edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable">DefaultHashKeyRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9896" title="edu.berkeley.cs.scads.storage.QuorumProtocol">QuorumProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9758" title="edu.berkeley.cs.scads.storage.AvroGenericKeyValueSerializer">AvroGenericKeyValueSerializer</a>
  <span class="keyword">with</span> <a href="Stores.scala.html#9964" title="edu.berkeley.cs.scads.storage.KeyValueStore[org.apache.avro.generic.GenericRecord,org.apache.avro.generic.GenericRecord]">KeyValueStore</a><span class="delimiter">[</span>GenericRecord, GenericRecord<span class="delimiter">]</span>

<span class="keyword">class</span> <a title="class SpecificNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AnalyticsProtocol with edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value] with edu.berkeley.cs.scads.storage.RangeKeyValueStore[Key,Value] with ScalaObject" id="9791">SpecificNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9792">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9793">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="44533">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="44534">cluster</a>: <a href="ScadsCluster.scala.html#9930" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="44535">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9873" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9942" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9981" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9913" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9897" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AnalyticsProtocol.scala.html#9737" title="edu.berkeley.cs.scads.storage.AnalyticsProtocol">AnalyticsProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9760" title="edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value]">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9969" title="edu.berkeley.cs.scads.storage.RangeKeyValueStore[Key,Value]">RangeKeyValueStore</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="44510">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44507" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9792" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="44512">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44508" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9793" title="Value">Value</a><span class="delimiter">]</span> 

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.GenericNamespace" id="44515">genericNamespace</a>: <a href="#9789" title="edu.berkeley.cs.scads.storage.GenericNamespace">GenericNamespace</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.GenericNamespace" id="44542">generic</a> = <span title="edu.berkeley.cs.scads.storage.GenericNamespace" class="keyword">new</span> <a href="#9789" title="edu.berkeley.cs.scads.storage.GenericNamespace">GenericNamespace</a><span class="delimiter">(</span><a href="#44533" title="=&gt; String">name</a>, <a href="#44534" title="=&gt; edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>, <a href="#44535" title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</a>, <a href="AvroSerializer.scala.html#36376" title="=&gt; org.apache.avro.Schema">keySchema</a>, <a href="AvroSerializer.scala.html#36378" title="=&gt; org.apache.avro.Schema">valueSchema</a>, <a href="AvroSerializer.scala.html#36380" title="=&gt; java.lang.String">valueClass</a><span class="delimiter">)</span>
    <a href="#44542" title="edu.berkeley.cs.scads.storage.GenericNamespace">generic</a>.<a href="Namespace.scala.html#27924" title="()Unit">open</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#44542" title="edu.berkeley.cs.scads.storage.GenericNamespace">generic</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SpecificInMemoryNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends edu.berkeley.cs.scads.storage.SpecificNamespace[Key,Value] with ScalaObject" id="9794">SpecificInMemoryNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9795">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9796">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="44584">imname</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="44585">imcluster</a>: <a href="ScadsCluster.scala.html#9930" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="44586">imroot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#9791" title="edu.berkeley.cs.scads.storage.SpecificNamespace[Key,Value]">SpecificNamespace</a><span class="delimiter">[</span>Key,Value<span class="delimiter">]</span><span class="delimiter">(</span><a href="#44584" title="String">imname</a>,<a href="#44585" title="edu.berkeley.cs.scads.storage.ScadsCluster">imcluster</a>,<a href="#44586" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">imroot</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="44564">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44561" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9795" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="44566">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44562" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9796" title="Value">Value</a><span class="delimiter">]</span> 

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="44568">partitionType</a>:<span title="String">String</span> = <span title="java.lang.String(&quot;inmemory&quot;)" class="string">&quot;inmemory&quot;</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SpecificHashNamespace[Key &lt;: org.apache.avro.specific.SpecificRecord, Value &lt;: org.apache.avro.specific.SpecificRecord] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable with edu.berkeley.cs.scads.storage.QuorumProtocol with edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value] with edu.berkeley.cs.scads.storage.KeyValueStore[Key,Value] with ScalaObject" id="9797">SpecificHashNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9798">Key</a> &lt;: SpecificRecord : Manifest, <a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="9799">Value</a> &lt;: SpecificRecord : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="44632">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="44633">cluster</a>: <a href="ScadsCluster.scala.html#9930" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="44634">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9873" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9942" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9981" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a>
  <span class="keyword">with</span> <a href="Routable.scala.html#9912" title="edu.berkeley.cs.scads.storage.DefaultHashKeyRoutable">DefaultHashKeyRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9896" title="edu.berkeley.cs.scads.storage.QuorumProtocol">QuorumProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9760" title="edu.berkeley.cs.scads.storage.AvroSpecificKeyValueSerializer[Key,Value]">AvroSpecificKeyValueSerializer</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9964" title="edu.berkeley.cs.scads.storage.KeyValueStore[Key,Value]">KeyValueStore</a><span class="delimiter">[</span>Key, Value<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Key]" id="44613">keyManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44610" title="(implicit m: Manifest[Key])Manifest[Key]" class="delimiter">[</a><a href="#9798" title="Key">Key</a><span class="delimiter">]</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Value]" id="44615">valueManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44611" title="(implicit m: Manifest[Value])Manifest[Value]" class="delimiter">[</a><a href="#9799" title="Value">Value</a><span class="delimiter">]</span> 

<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class PairNamespace[Pair &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.SimpleRecordMetadata with edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata with edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable with edu.berkeley.cs.scads.storage.QuorumRangeProtocol with edu.berkeley.cs.scads.storage.AvroPairSerializer[Pair] with edu.berkeley.cs.scads.storage.RecordStore[Pair] with edu.berkeley.cs.scads.storage.client.index.IndexManager[Pair] with edu.berkeley.cs.scads.storage.DebuggingClient with edu.berkeley.cs.scads.storage.NamespaceIterator[Pair] with ScalaObject" id="9800">PairNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="9801">Pair</a> &lt;: AvroPair : Manifest<span class="delimiter">]</span><span class="delimiter">(</span>
    <span class="keyword">val</span> <a title="String" id="44706">name</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="44707">cluster</a>: <a href="ScadsCluster.scala.html#9930" title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</a>,
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="44708">root</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="Namespace.scala.html#9873" title="edu.berkeley.cs.scads.storage.Namespace">Namespace</a>
  <span class="keyword">with</span> <a href="SimpleRecordMetadata.scala.html#9942" title="edu.berkeley.cs.scads.storage.SimpleRecordMetadata">SimpleRecordMetadata</a>
  <span class="keyword">with</span> <a href="ZooKeeperGlobalMetadata.scala.html#9981" title="edu.berkeley.cs.scads.storage.ZooKeeperGlobalMetadata">ZooKeeperGlobalMetadata</a> 
  <span class="keyword">with</span> <a href="Routable.scala.html#9913" title="edu.berkeley.cs.scads.storage.DefaultKeyRangeRoutable">DefaultKeyRangeRoutable</a>
  <span class="keyword">with</span> <a href="QuorumProtocol.scala.html#9897" title="edu.berkeley.cs.scads.storage.QuorumRangeProtocol">QuorumRangeProtocol</a>
  <span class="keyword">with</span> <a href="AvroSerializer.scala.html#9763" title="edu.berkeley.cs.scads.storage.AvroPairSerializer[Pair]">AvroPairSerializer</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Stores.scala.html#9972" title="edu.berkeley.cs.scads.storage.RecordStore[Pair]">RecordStore</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> index.<a href="IndexManager.scala.html#9829" title="edu.berkeley.cs.scads.storage.client.index.IndexManager[Pair]">IndexManager</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
  <span class="keyword">with</span> <a href="Debugging.scala.html#9777" title="edu.berkeley.cs.scads.storage.DebuggingClient">DebuggingClient</a> 
  <span class="keyword">with</span> <a href="NamespaceIterator.scala.html#9879" title="edu.berkeley.cs.scads.storage.NamespaceIterator[Pair]">NamespaceIterator</a><span class="delimiter">[</span>Pair<span class="delimiter">]</span> <span class="delimiter">{</span>
  
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Manifest[Pair]" id="44653">pairManifest</a> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#44651" title="(implicit m: Manifest[Pair])Manifest[Pair]" class="delimiter">[</a><a href="#9801" title="Pair">Pair</a><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]" id="44655">asyncGetRecord</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="44714">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]">ScadsFuture</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Pair<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="44731">keyBytes</a> = <a href="AvroSerializer.scala.html#36411" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#44714" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>
    <a href="QuorumProtocol.scala.html#27859" title="(key: Array[Byte])edu.berkeley.cs.scads.comm.ScadsFuture[Option[Array[Byte]]]">asyncGetBytes</a><span class="delimiter">(</span><a href="#44731" title="Array[Byte]">keyBytes</a><span class="delimiter">)</span> <span title="(f: Option[Array[Byte]] =&gt; Option[Pair])edu.berkeley.cs.scads.comm.ScadsFuture[Option[Pair]]">map</span> <span class="delimiter">(</span><a href="#44754" title="Option[Array[Byte]]">_</a>.<span title="(f: Array[Byte] =&gt; Pair)Option[Pair]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#36410" title="(key: Array[Byte], value: Array[Byte])Pair">bytesToBulk</a><span class="delimiter">(</span><a href="#44731" title="Array[Byte]">keyBytes</a>, <a href="#44759" title="Array[Byte]">_</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(key: org.apache.avro.generic.IndexedRecord)Option[Pair]" id="44656">getRecord</a><span class="delimiter">(</span><a title="org.apache.avro.generic.IndexedRecord" id="44762">key</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span><span class="delimiter">)</span>: <span title="Option[Pair]">Option</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[Byte]" id="44766">keyBytes</a> = <a href="AvroSerializer.scala.html#36411" title="(key: org.apache.avro.generic.IndexedRecord)Array[Byte]">keyToBytes</a><span class="delimiter">(</span><a href="#44762" title="org.apache.avro.generic.IndexedRecord">key</a><span class="delimiter">)</span>

    <a href="QuorumProtocol.scala.html#27858" title="(key: Array[Byte])Option[Array[Byte]]">getBytes</a><span class="delimiter">(</span><a href="#44766" title="Array[Byte]">keyBytes</a><span class="delimiter">)</span>.<span title="(f: Array[Byte] =&gt; Pair)Option[Pair]">map</span><span class="delimiter">(</span><a href="AvroSerializer.scala.html#36410" title="(key: Array[Byte], value: Array[Byte])Pair">bytesToBulk</a><span class="delimiter">(</span><a href="#44766" title="Array[Byte]">keyBytes</a>, <a href="#44774" title="Array[Byte]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pairRec: Pair)Unit" id="44657">put</a><span class="delimiter">(</span><a title="Pair" id="44776">pairRec</a>: <a href="#9801" title="Pair">Pair</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="IndexManager.scala.html#44681" title="(key: org.apache.avro.generic.IndexedRecord, value: Option[org.apache.avro.generic.IndexedRecord])Unit">put</a><span class="delimiter">(</span><a href="#44776" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>, <span title="(x: org.apache.avro.generic.GenericRecord)Some[org.apache.avro.generic.GenericRecord]">Some</span><span class="delimiter">(</span><a href="#44776" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">value</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pairRec: Pair)Unit" id="44658">delete</a><span class="delimiter">(</span><a title="Pair" id="44886">pairRec</a>: <a href="#9801" title="Pair">Pair</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="IndexManager.scala.html#44681" title="(key: org.apache.avro.generic.IndexedRecord, value: Option[org.apache.avro.generic.IndexedRecord])Unit">put</a><span class="delimiter">(</span><a href="#44886" title="Pair">pairRec</a>.<span title="=&gt; org.apache.avro.generic.GenericRecord">key</span>, <span title="object None">None</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>