<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>AvroChannelManager.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.comm

<span class="keyword">import</span> java.nio._
<span class="keyword">import</span> java.nio.channels._
<span class="keyword">import</span> java.net.InetSocketAddress

<span class="keyword">import</span> org.apache.avro.io._
<span class="keyword">import</span> org.apache.avro.specific._
<span class="keyword">import</span> org.apache.avro.generic.IndexedRecord

case <span class="keyword">class</span> <a title="class RemoteNode extends java.lang.Object with ScalaObject with Product with Serializable" id="21046">RemoteNode</a><a href="#21046" title="ScalaObject" class="delimiter">(</a><a title="String" id="21041">hostname</a>:<span title="String">String</span>, <a title="Int" id="21042">port</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.net.InetSocketAddress" id="10351">socketAddress</a> = <span title="(x$1: java.lang.String, x$2: Int)java.net.InetSocketAddress" class="keyword">new</span> <span title="java.net.InetSocketAddress">InetSocketAddress</span><span class="delimiter">(</span><a href="#21041" title="=&gt; String">hostname</a>, <a href="#21042" title="=&gt; Int">port</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; java.net.InetSocketAddress" id="10353">getInetSocketAddress</a>:<span title="java.net.InetSocketAddress">InetSocketAddress</span> = <a href="#10351" title="=&gt; java.net.InetSocketAddress">socketAddress</a>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait AvroChannelManager[SendMsgType &lt;: org.apache.avro.generic.IndexedRecord, RecvMsgType &lt;: org.apache.avro.generic.IndexedRecord] extends java.lang.Object" id="9478">AvroChannelManager</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.generic.IndexedRecord" id="9479">SendMsgType</a> &lt;: IndexedRecord, <a title="&gt;: Nothing &lt;: org.apache.avro.generic.IndexedRecord" id="9480">RecvMsgType</a> &lt;: IndexedRecord<span class="delimiter">]</span> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="comment">/**
   * Send message to dest immediately.  Probably by calling sendMessageBulk and flush.
   * A new connection should be opened if one doesn't exist.
   */</span>
  <span class="keyword">def</span> <a title="(dest: edu.berkeley.cs.scads.comm.RemoteNode, msg: SendMsgType)Unit" id="21012">sendMessage</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.RemoteNode" id="21024">dest</a>: <a href="#21046" title="edu.berkeley.cs.scads.comm.RemoteNode">RemoteNode</a>, <a title="SendMsgType" id="21025">msg</a>: <a href="#9479" title="SendMsgType">SendMsgType</a><span class="delimiter">)</span>: <span title="Unit">Unit</span>

  <span class="comment">/**
   * Batch message for sending by serializing it into a buffer.
   * The message should be actually sent either when the buffer
   * is full or when flush is explicitly called.
   */</span>
  <span class="keyword">def</span> <a title="(dest: edu.berkeley.cs.scads.comm.RemoteNode, msg: SendMsgType)Unit" id="21013">sendMessageBulk</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.RemoteNode" id="21033">dest</a>: <a href="#21046" title="edu.berkeley.cs.scads.comm.RemoteNode">RemoteNode</a>, <a title="SendMsgType" id="21034">msg</a>: <a href="#9479" title="SendMsgType">SendMsgType</a><span class="delimiter">)</span>: <span title="Unit">Unit</span>

  <span class="comment">/**
   * Transmit any messages that are currently waiting in the sendbuffer.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="21014">flush</a>: <span title="Unit">Unit</span>

  <span class="comment">/**
   * Open a listening socket on the specified port
   */</span>
  <span class="keyword">def</span> <a title="(port: Int)Unit" id="21015">startListener</a><span class="delimiter">(</span><a title="Int" id="21035">port</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>

  <span class="comment">/**
   * Abstract method to be implemented by the user
   */</span>
  <span class="keyword">def</span> <a title="(src: edu.berkeley.cs.scads.comm.RemoteNode, msg: RecvMsgType)Unit" id="21016">receiveMessage</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.comm.RemoteNode" id="21036">src</a>: <a href="#21046" title="edu.berkeley.cs.scads.comm.RemoteNode">RemoteNode</a>, <a title="RecvMsgType" id="21037">msg</a>: <a href="#9480" title="RecvMsgType">RecvMsgType</a><span class="delimiter">)</span>:<span title="Unit">Unit</span>
<span class="delimiter">}</span>

<span class="comment">/*
class PrintAvroChannelManager[SendMsg &lt;: SpecificRecord, RecvMsg &lt;: SpecificRecord]
(implicit sendManifest: scala.reflect.Manifest[SendMsg],
recvManifest: scala.reflect.Manifest[RecvMsg])
extends NioAvroChannelManagerBase[SendMsg, RecvMsg] {
    override def receiveMessage(src: RemoteNode, msg: RecvMsg):Unit = {
        println(&quot;src: &quot; + src)
        println(&quot;msg: &quot; + msg)
    }
}

class EchoAvroChannelManager[EchoMsg &lt;: SpecificRecord]
(implicit sendManifest: scala.reflect.Manifest[EchoMsg])
extends NioAvroChannelManagerBase[EchoMsg, EchoMsg] {
    override def receiveMessage(src: RemoteNode, msg: EchoMsg):Unit = {
        println(&quot;src: &quot; + src)
        println(&quot;msg: &quot; + msg)
        sendMessage(src, msg)
    }
}

class DiscardAvroChannelManager[SendMsg &lt;: SpecificRecord, RecvMsg &lt;: SpecificRecord]
(implicit sendManifest: scala.reflect.Manifest[SendMsg],
recvManifest: scala.reflect.Manifest[RecvMsg])
extends NioAvroChannelManagerBase[SendMsg, RecvMsg] {
    override def receiveMessage(src: RemoteNode, msg: RecvMsg):Unit = {
        // no op
    }
}
*/</span>

        </pre>
    </body>
</html>