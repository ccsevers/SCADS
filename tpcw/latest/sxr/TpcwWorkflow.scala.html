<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TpcwWorkflow.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.piql.tpcw

<span class="keyword">import</span> net.lag.logging.Logger

<span class="keyword">import</span> scala.util.Random
<span class="keyword">import</span> collection.mutable.HashMap
<span class="keyword">import</span> collection.<span title="object scala.collection.JavaConversions">JavaConversions</span>._

<span class="keyword">import</span> java.util.UUID

<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.Utils

<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._

<span class="comment">/**
 * Warning: Workflow is not threadsafe for now
 */</span>
<span class="keyword">class</span> <a title="class TpcwWorkflow extends java.lang.Object with ScalaObject" id="9704">TpcwWorkflow</a><a href="#9704" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="49633">client</a>: <a href="TpcwClient.scala.html#9634" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a>, <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwLoader" id="49634">data</a>: <a href="TpcwLoader.scala.html#9650" title="edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">TpcwLoader</a>, <span class="keyword">val</span> <a title="Option[Int]" id="49637">randomSeed</a>: <span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="object None">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="49590">logger</a> = <span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;edu.berkeley.cs.scads.piql.TpcwWorkflow&quot;)" class="string">&quot;edu.berkeley.cs.scads.piql.TpcwWorkflow&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.util.Random" id="49592">random</a> = <a href="#49637" title="=&gt; Option[Int]">randomSeed</a>.<span title="(f: Int =&gt; scala.util.Random)Option[scala.util.Random]">map</span><span class="delimiter">(</span><span title="(seed: Int)scala.util.Random" class="keyword">new</span> <span title="scala.util.Random">Random</span><span class="delimiter">(</span><a href="#50987" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; scala.util.Random)scala.util.Random">getOrElse</span><span class="delimiter">(</span><span title="()scala.util.Random" class="keyword">new</span> <span title="scala.util.Random">Random</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="Int" id="49594">perPage</a> = <span title="Int(50)" class="int">50</span>

  <span class="comment">/** All possible subjects */</span>
  <span class="keyword">val</span> <a title="Array[java.lang.String]" id="49596">subjects</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36556" title="()Array[java.lang.String]">getSubjects</a>

  <span class="comment">/** All possible ship types */</span>
  <span class="keyword">val</span> <a title="Array[java.lang.String]" id="49598">shipTypes</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36559" title="()Array[java.lang.String]">getShipTypes</a>

  <span class="comment">/** All possible credit card types */</span>
  <span class="keyword">val</span> <a title="Array[java.lang.String]" id="49600">ccTypes</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36558" title="()Array[java.lang.String]">getCreditCards</a>

  case <span class="keyword">class</span> <a title="class Action extends java.lang.Object with ScalaObject with Product with Serializable" id="52331">Action</a><a href="#52331" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="TpcwWorkflow.this.ActionType.Value" id="55347">action</a>: ActionType.<span title="TpcwWorkflow.this.ActionType.Value">Value</span>, <span class="keyword">var</span> <a title="List[(Int, TpcwWorkflow.this.Action)]" id="55348">nextActions</a> : <span title="List[(Int, TpcwWorkflow.this.Action)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>Int, Action<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">object</span> <a title="object TpcwWorkflow.this.ActionType" id="49605">ActionType</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Enumeration">Enumeration</span> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51970">ActionType</a> = <span title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value">Value</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51971">Home</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51973">NewProduct</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51975">BestSeller</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51977">ProductDetail</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51979">SearchRequest</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51981">SearchResult</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51983">ShoppingCart</a>,
    <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51985">CustomerReg</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51987">BuyRequest</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51989">BuyConfirm</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51991">OrderInquiry</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51993">OrderDisplay</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51995">AdminRequest</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51997">AdminConfirm</a> = <span title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value">Value</span>

  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="object TpcwWorkflow.this.SearchResultType" id="49607">SearchResultType</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Enumeration">Enumeration</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value" id="51903">ByAuthor</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value" id="51905">ByTitle</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value" id="51907">BySubject</a> = <span title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value">Value</span>
  <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="scala.collection.immutable.Vector[TpcwWorkflow.this.SearchResultType.Value]" id="49609">SearchTypes</a> = <span title="(elems: TpcwWorkflow.this.SearchResultType.Value*)scala.collection.immutable.Vector[TpcwWorkflow.this.SearchResultType.Value]">Vector</span><span class="delimiter">(</span><a href="#49607" title="object TpcwWorkflow.this.SearchResultType">SearchResultType</a>.<a href="#51903" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByAuthor</a>,
                           <a href="#49607" title="object TpcwWorkflow.this.SearchResultType">SearchResultType</a>.<a href="#51905" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByTitle</a>,
                           <a href="#49607" title="object TpcwWorkflow.this.SearchResultType">SearchResultType</a>.<a href="#51907" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">BySubject</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; TpcwWorkflow.this.SearchResultType.Value" id="49611">randomSearchType</a> =
    <a href="#49609" title="(index: Int)TpcwWorkflow.this.SearchResultType.Value">SearchTypes</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49609" title="=&gt; scala.collection.immutable.Vector[TpcwWorkflow.this.SearchResultType.Value]">SearchTypes</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(prob: Double)Boolean" id="49612">flipCoin</a><span class="delimiter">(</span><a title="Double" id="52633">prob</a>: <span title="Double">Double</span><span class="delimiter">)</span> =
    <a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;</span> <a href="#52633" title="Double">prob</a>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="49613">shouldCreateNewUser</a> =
    <a href="#49612" title="(prob: Double)Boolean">flipCoin</a><span class="delimiter">(</span><span title="Double(0.2)" class="double">0.2</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="49614">newUserName</a> =
    <span title="object java.util.UUID">UUID</span>.<span title="()java.util.UUID">randomUUID</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="49615">randomUser</a> =
    <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37169" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37139" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="49616">randomSubject</a> =
    <a href="#49596" title="(i: Int)java.lang.String">subjects</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49596" title="=&gt; Array[java.lang.String]">subjects</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="49617">randomItem</a> =
    <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37175" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37132" title="=&gt; Int">numItems</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="49618">randomAuthor</a> =
    <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37170" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37143" title="=&gt; Int">numAuthors</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="49619">randomShipType</a> =
    <a href="#49598" title="(i: Int)java.lang.String">shipTypes</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49598" title="=&gt; Array[java.lang.String]">shipTypes</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="49620">randomCreditCardType</a> =
    <a href="#49600" title="(i: Int)java.lang.String">ccTypes</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49600" title="=&gt; Array[java.lang.String]">ccTypes</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]" id="49621">actions</a> = <span title="()scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]">HashMap</span><span class="delimiter">[</span>ActionType.ActionType, Action<span class="delimiter">]</span>
  <a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<span title="=&gt; TpcwWorkflow.this.ActionType.ValueSet">values</span>.<span title="(f: TpcwWorkflow.this.ActionType.Value =&gt; scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action])Unit">foreach</span><span class="delimiter">(</span><a title="TpcwWorkflow.this.ActionType.Value" id="52715">a</a> =&gt; <a href="#49621" title="=&gt; scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]">actions</a> <span title="(kv: (TpcwWorkflow.this.ActionType.ActionType, TpcwWorkflow.this.Action))TpcwWorkflow.this.actions.type">+=</span> <a href="#52715" title="(x: TpcwWorkflow.this.ActionType.Value)ArrowAssoc[TpcwWorkflow.this.ActionType.Value]">a</a> <span title="(y: TpcwWorkflow.this.Action)(TpcwWorkflow.this.ActionType.Value, TpcwWorkflow.this.Action)">-&gt;</span> <span title="TpcwWorkflow.this.Action" class="keyword">new</span> <a href="#52331" title="TpcwWorkflow.this.Action">Action</a><span class="delimiter">(</span><a href="#52715" title="TpcwWorkflow.this.ActionType.Value">a</a>, <span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="TpcwWorkflow.this.ActionType.ValueSet" id="49623">unsupportedActions</a> = <a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<span title="=&gt; TpcwWorkflow.this.ActionType.ValueSet">values</span>.<span title="(p: TpcwWorkflow.this.ActionType.Value =&gt; Boolean)TpcwWorkflow.this.ActionType.ValueSet">filterNot</span><span class="delimiter">(</span><a href="#49631" title="=&gt; PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]">executeAction</a>.<span title="(x: TpcwWorkflow.this.ActionType.Value)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#52289" title="TpcwWorkflow.this.ActionType.Value">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;The following TPCW actions are not implemented: %s&quot;)" class="string">&quot;The following TPCW actions are not implemented: %s&quot;</span>, <a href="#49623" title="=&gt; TpcwWorkflow.this.ActionType.ValueSet">unsupportedActions</a><span class="delimiter">)</span>

  <span class="comment">// The MarkovChain from TPC-W: Thresholds for the &quot;Ordering Interval&quot;</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51997" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminConfirm</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(8348)" class="int">8348</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51995" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminRequest</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(8999)" class="int">8999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51997" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminConfirm</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51975" title="=&gt; TpcwWorkflow.this.ActionType.Value">BestSeller</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(333)" class="int">333</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51977" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9998)" class="int">9998</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51989" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyConfirm</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(2)" class="int">2</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51987" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyRequest</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(7999)" class="int">7999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51989" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyConfirm</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9453)" class="int">9453</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51985" title="=&gt; TpcwWorkflow.this.ActionType.Value">CustomerReg</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9899)" class="int">9899</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51987" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9901)" class="int">9901</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(499)" class="int">499</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51975" title="=&gt; TpcwWorkflow.this.ActionType.Value">BestSeller</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(999)" class="int">999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51973" title="=&gt; TpcwWorkflow.this.ActionType.Value">NewProduct</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1269)" class="int">1269</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51991" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderInquiry</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1295)" class="int">1295</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51973" title="=&gt; TpcwWorkflow.this.ActionType.Value">NewProduct</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(504)" class="int">504</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9942)" class="int">9942</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51977" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9976)" class="int">9976</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51993" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderDisplay</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9939)" class="int">9939</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51991" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderInquiry</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1168)" class="int">1168</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9968)" class="int">9968</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51993" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderDisplay</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51977" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(99)" class="int">99</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51995" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(3750)" class="int">3750</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(5621)" class="int">5621</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51977" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(6341)" class="int">6341</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(815)" class="int">815</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9815)" class="int">9815</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51981" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchResult</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51981" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchResult</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(486)" class="int">486</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(7817)" class="int">7817</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51977" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9998)" class="int">9998</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51979" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span>.<a href="#55348" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9499)" class="int">9499</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51985" title="=&gt; TpcwWorkflow.this.ActionType.Value">CustomerReg</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9918)" class="int">9918</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="TpcwWorkflow.this.ActionType.Value" id="49626">nextAction</a> = <a href="#49605" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a> <span class="comment">// HOME is start state</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="49629">currentUser</a>: <a href="TpcwSchema.scala.html#51157" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a> = _

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]" id="49631">executeAction</a>: <span title="PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]">PartialFunction</span><span class="delimiter">[</span>ActionType.Value, Unit<span class="delimiter">]</span> = <a href="#54044" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51971" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a> =&gt; <span class="delimiter">{</span>
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Home&quot;)" class="string">&quot;Home&quot;</span><span class="delimiter">)</span>

        <span class="comment">// NOTE: technically this should be done in the customer reg</span>
        <span class="comment">// phase, but we're doing it here...</span>
        <a href="#49629" title="(x$1: edu.berkeley.cs.scads.piql.tpcw.Customer)Unit">currentUser</a> =
          <span title="edu.berkeley.cs.scads.piql.tpcw.Customer" class="keyword">if</span> <span class="delimiter">(</span><a href="#49613" title="=&gt; Boolean">shouldCreateNewUser</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="54047">cust</a> = <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37182" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer">createCustomer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
            <a href="#54047" title="edu.berkeley.cs.scads.piql.tpcw.Customer">cust</a>.<a href="TpcwSchema.scala.html#44613" title="(x$1: String)Unit">C_UNAME</a> = <a href="#49614" title="=&gt; java.lang.String">newUserName</a> <span class="comment">// use a random UUID for a username</span>
            <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12744" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer]">customers</a>.<span title="(pairRec: edu.berkeley.cs.scads.piql.tpcw.Customer)Unit">put</span><span class="delimiter">(</span><a href="#54047" title="edu.berkeley.cs.scads.piql.tpcw.Customer">cust</a><span class="delimiter">)</span> <span class="comment">// save new customer</span>
            <a href="#54047" title="edu.berkeley.cs.scads.piql.tpcw.Customer">cust</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span class="comment">// pick existing user</span>
            <span class="keyword">val</span> <a title="String" id="54055">user</a> = <a href="#49615" title="=&gt; String">randomUser</a>
            <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.package.QueryResult" id="54056">userData</a> = <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12761" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">homeWI</a><span class="delimiter">(</span><a href="#54055" title="String">user</a><span class="delimiter">)</span>
            <a href="#54056" title="(idx: Int)edu.berkeley.cs.scads.piql.package.Tuple">userData</a><span title="(idx: Int)edu.berkeley.cs.scads.piql.package.Record" class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span title="(record: edu.berkeley.cs.scads.piql.package.Record)edu.berkeley.cs.avro.runtime.RichIndexedRecord[edu.berkeley.cs.scads.piql.package.Record]" class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[SR &lt;: org.apache.avro.specific.SpecificRecord](implicit m: Manifest[SR])SR">toSpecificRecord</span><span title="(implicit m: Manifest[edu.berkeley.cs.scads.piql.tpcw.Customer])edu.berkeley.cs.scads.piql.tpcw.Customer" class="delimiter">[</span><a href="TpcwSchema.scala.html#51157" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a><span class="delimiter">]</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51973" title="=&gt; TpcwWorkflow.this.ActionType.Value">NewProduct</a> =&gt; <span class="delimiter">{</span>
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;NewProduct&quot;)" class="string">&quot;NewProduct&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.lang.String" id="54100">subject</a> = <a href="#49616" title="=&gt; java.lang.String">randomSubject</a>
        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12763" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">newProductWI</a><span title="Unit" class="delimiter">(</span><a href="#54100" title="java.lang.String">subject</a>, <a href="#49594" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51977" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ProductDetail&quot;)" class="string">&quot;ProductDetail&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="String" id="54103">item</a> = <a href="#49617" title="=&gt; String">randomItem</a>
        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12765" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">productDetailWI</a><span title="Unit" class="delimiter">(</span><a href="#54103" title="String">item</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51993" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderDisplay</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;OrderDisplay&quot;)" class="string">&quot;OrderDisplay&quot;</span><span class="delimiter">)</span>
        <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12779" title="(c_uname: String, c_passwd: String, numOrderLinesPerPage: Int)(edu.berkeley.cs.scads.piql.tpcw.Customer, Option[edu.berkeley.cs.scads.piql.tpcw.Order], Option[edu.berkeley.cs.scads.piql.package.QueryResult])">orderDisplayWI</a><span title="Unit" class="delimiter">(</span><a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#44613" title="=&gt; String">C_UNAME</a>, <a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#21462" title="=&gt; String">C_PASSWD</a>, <span title="Int(100)" class="int">100</span><span class="delimiter">)</span>

      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51981" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchResult</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;SearchResult&quot;)" class="string">&quot;SearchResult&quot;</span><span class="delimiter">)</span>
        <span class="comment">// pick a random search type</span>
        <a href="#49611" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">randomSearchType</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#49607" title="Unit">SearchResultType</a>.<a href="#51903" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByAuthor</a> =&gt;
            <span class="keyword">val</span> <a title="String" id="54117">author</a> = <a href="#49618" title="=&gt; String">randomAuthor</a>
            <span class="keyword">val</span> <a title="String" id="54118">name</a> = <a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="()Boolean">nextBoolean</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="String" class="keyword">false</span> =&gt; <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37171" title="(authorId: String)String">toAuthorFname</a><span class="delimiter">(</span><a href="#54117" title="String">author</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="String" class="keyword">true</span> =&gt; <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37172" title="(authorId: String)String">toAuthorLname</a><span class="delimiter">(</span><a href="#54117" title="String">author</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Search by author name %s&quot;)" class="string">&quot;Search by author name %s&quot;</span>, <a href="#54118" title="String">name</a><span class="delimiter">)</span>
            <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12767" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">searchByAuthorWI</a><span title="Unit" class="delimiter">(</span><a href="#54118" title="String">name</a>, <a href="#49594" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#49607" title="Unit">SearchResultType</a>.<a href="#51905" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByTitle</a> =&gt;
            <span class="comment">/* Pick a random token from a random title */</span>
            <span class="keyword">val</span> <a title="Array[java.lang.String]" id="54123">titleParts</a> = <a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37177" title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item">createItem</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#49634" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#37132" title="=&gt; Int">numItems</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="TpcwSchema.scala.html#21526" title="=&gt; String">I_TITLE</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span class="delimiter">(</span><span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="java.lang.String" id="54124">title</a> = <a href="#54123" title="(i: Int)java.lang.String">titleParts</a><span class="delimiter">(</span><a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#54123" title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]">titleParts</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Search by title %s&quot;)" class="string">&quot;Search by title %s&quot;</span>, <a href="#54124" title="java.lang.String">title</a><span class="delimiter">)</span>
            <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12769" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">searchByTitleWI</a><span title="Unit" class="delimiter">(</span><a href="#54124" title="java.lang.String">title</a>, <a href="#49594" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#49607" title="Unit">SearchResultType</a>.<a href="#51907" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">BySubject</a> =&gt;
            <span class="keyword">val</span> <a title="java.lang.String" id="54703">subject</a> = <a href="#49616" title="=&gt; java.lang.String">randomSubject</a>
            <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Search by subject %s&quot;)" class="string">&quot;Search by subject %s&quot;</span>, <a href="#54703" title="java.lang.String">subject</a><span class="delimiter">)</span>
            <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12771" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">searchBySubjectWI</a><span title="Unit" class="delimiter">(</span><a href="#54703" title="java.lang.String">subject</a>, <a href="#49594" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51983" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ShoppingCart&quot;)" class="string">&quot;ShoppingCart&quot;</span><span class="delimiter">)</span>
        <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="java.lang.String(&quot;Current user should not be null&quot;)" class="string">&quot;Current user should not be null&quot;</span><span class="delimiter">)</span>

        <span class="comment">/**
         * This is a simplification of the actual shopping cart WI where
         * instead of being based on the previous action we just always
         * select some random items to update in the shopping cart.
         *
         * We believe processsing time &gt;= tpcwspec processing time
         */</span>

        <span class="keyword">val</span> <a title="scala.collection.immutable.IndexedSeq[(String, Int)]" id="54708">items</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; (String, Int))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],(String, Int),scala.collection.immutable.IndexedSeq[(String, Int)]])scala.collection.immutable.IndexedSeq[(String, Int)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,(String, Int),scala.collection.immutable.IndexedSeq[(String, Int)]]" class="delimiter">(</span><a title="Int" id="54856">_</a> =&gt; <span title="(_1: String, _2: Int)(String, Int)" class="delimiter">(</span><a href="#49617" title="=&gt; String">randomItem</a>, <a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span title="(x: Int)Int">-</span> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12782" title="(c_uname: String, newItems: Seq[(String, Int)])Unit">shoppingCartWI</a><span class="delimiter">(</span><a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#44613" title="=&gt; String">C_UNAME</a>, <a href="#54708" title="scala.collection.immutable.IndexedSeq[(String, Int)]">items</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51987" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyRequest</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;BuyRequest&quot;)" class="string">&quot;BuyRequest&quot;</span><span class="delimiter">)</span>
        <span class="comment">// for now always assuming existing user</span>
        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12783" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">buyRequestExistingCustomerWI</a><span title="Unit" class="delimiter">(</span><a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#44613" title="=&gt; String">C_UNAME</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51989" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyConfirm</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;BuyConfirm&quot;)" class="string">&quot;BuyConfirm&quot;</span><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="java.lang.String" id="54901">cc_type</a> = <a href="#49620" title="=&gt; java.lang.String">randomCreditCardType</a>
        <span class="keyword">val</span> <a title="Int" id="54902">cc_number</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<span title="(x$1: Int)Int">getRandomNString</span><span class="delimiter">(</span><span title="Int(16)" class="int">16</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.lang.String" id="54903">cc_name</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">getRandomAString</span><span class="delimiter">(</span><span title="Int(14)" class="int">14</span>, <span title="Int(30)" class="int">30</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Long" id="54904">cc_expiry</a> = <span class="delimiter">{</span>
          <span class="keyword">import</span> java.util.Calendar
          <span class="keyword">val</span> <a title="java.util.GregorianCalendar" id="54913">cal</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36552" title="()java.util.GregorianCalendar">getCalendar</a>
          <a href="#54913" title="java.util.GregorianCalendar">cal</a>.<span title="(x$1: Int, x$2: Int)Unit">add</span><span class="delimiter">(</span>Calendar.<span title="Int(6)">DAY_OF_YEAR</span>, <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<span title="(x$1: Int, x$2: Int)Int">getRandomInt</span><span class="delimiter">(</span><span title="Int(10)" class="int">10</span>, <span title="Int(730)" class="int">730</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#54913" title="java.util.GregorianCalendar">cal</a>.<span title="()java.util.Date">getTime</span>.<span title="()Long">getTime</span>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="java.lang.String" id="54905">shipping</a> = <a href="#49619" title="=&gt; java.lang.String">randomShipType</a>

        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12785" title="(c_uname: String, cc_type: String, cc_number: Int, cc_name: String, cc_expiry: Long, shipping: String)String">buyConfirmWI</a><span title="Unit" class="delimiter">(</span>
          <a href="#49629" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#44613" title="=&gt; String">C_UNAME</a>,
          <a href="#54901" title="java.lang.String">cc_type</a>,
          <a href="#54902" title="Int">cc_number</a>,
          <a href="#54903" title="java.lang.String">cc_name</a>,
          <a href="#54904" title="Long">cc_expiry</a>,
          <a href="#54905" title="java.lang.String">shipping</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#49605" title="Unit">ActionType</a>.<a href="#51995" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminRequest</a> =&gt;
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;AdminRequest&quot;)" class="string">&quot;AdminRequest&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="String" id="55282">item</a> = <a href="#49617" title="=&gt; String">randomItem</a>
        <a href="#49633" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12786" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">adminRequestWI</a><span title="Unit" class="delimiter">(</span><a href="#55282" title="String">item</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="comment">/**
   * Advances the TPC-W markov chain model one state transition.
   * returns true if the action was run and false if it was skipped due to PIQL Limitations
   */</span>
  <span class="keyword">def</span> <a title="()Boolean" id="49632">executeMix</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Boolean" id="55285">executed</a> =
      <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#49631" title="=&gt; PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]">executeAction</a>.<span title="(x: TpcwWorkflow.this.ActionType.Value)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#49626" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Executing Action: %s&quot;)" class="string">&quot;Executing Action: %s&quot;</span>, <a href="#49626" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span>
        <a href="#49631" title="(v1: TpcwWorkflow.this.ActionType.Value)Unit">executeAction</a><span class="delimiter">(</span><a href="#49626" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span>
        <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#49590" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Skipping undefined action: %s&quot;)" class="string">&quot;Skipping undefined action: %s&quot;</span>, <a href="#49626" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Int" id="55286">rnd</a> = <a href="#49592" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(9999)" class="int">9999</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="TpcwWorkflow.this.ActionType.Value" id="55287">lastAction</a> = <a href="#49626" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a>
    <a href="#49626" title="(x$1: TpcwWorkflow.this.ActionType.Value)Unit">nextAction</a> = <a href="#49621" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#55287" title="TpcwWorkflow.this.ActionType.Value">lastAction</a><span class="delimiter">)</span>.<a href="#55348" title="=&gt; List[(Int, TpcwWorkflow.this.Action)]">nextActions</a>.<span title="(p: (Int, TpcwWorkflow.this.Action) =&gt; Boolean)Option[(Int, TpcwWorkflow.this.Action)]">find</span><span class="delimiter">(</span><a href="#55286" title="Int">rnd</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#55338" title="(Int, TpcwWorkflow.this.Action)">_</a>.<span title="=&gt; Int">_1</span><span class="delimiter">)</span>.<span title="=&gt; (Int, TpcwWorkflow.this.Action)">get</span>.<span title="=&gt; TpcwWorkflow.this.Action">_2</span>.<a href="#55347" title="=&gt; TpcwWorkflow.this.ActionType.Value">action</a>

    <a href="#55285" title="Boolean">executed</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>