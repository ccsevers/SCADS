<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TpcwWorkflow.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.scads.piql.tpcw

<span class="keyword">import</span> net.lag.logging.Logger

<span class="keyword">import</span> scala.util.Random
<span class="keyword">import</span> collection.mutable.HashMap
<span class="keyword">import</span> collection.<span title="object scala.collection.JavaConversions">JavaConversions</span>._

<span class="keyword">import</span> java.util.UUID

<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.Utils

<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._

<span class="comment">/**
 * Warning: Workflow is not threadsafe for now
 */</span>
<span class="keyword">class</span> <a title="class TpcwWorkflow extends java.lang.Object with ScalaObject" id="10265">TpcwWorkflow</a><a href="#10265" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="48938">client</a>: <a href="TpcwClient.scala.html#10158" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a>, <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwLoader" id="48939">data</a>: <a href="TpcwLoader.scala.html#10174" title="edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">TpcwLoader</a>, <span class="keyword">val</span> <a title="Option[Int]" id="48942">randomSeed</a>: <span title="Option[Int]">Option</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="object None">None</span><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="48895">logger</a> = <span title="(name: String)net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span title="java.lang.String(&quot;edu.berkeley.cs.scads.piql.TpcwWorkflow&quot;)" class="string">&quot;edu.berkeley.cs.scads.piql.TpcwWorkflow&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.util.Random" id="48897">random</a> = <a href="#48942" title="=&gt; Option[Int]">randomSeed</a>.<span title="(f: Int =&gt; scala.util.Random)Option[scala.util.Random]">map</span><span class="delimiter">(</span><span title="(seed: Int)scala.util.Random" class="keyword">new</span> <span title="scala.util.Random">Random</span><span class="delimiter">(</span><a href="#50889" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; scala.util.Random)scala.util.Random">getOrElse</span><span class="delimiter">(</span><span title="()scala.util.Random" class="keyword">new</span> <span title="scala.util.Random">Random</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="Int" id="48899">perPage</a> = <span title="Int(50)" class="int">50</span>

  <span class="comment">/** All possible subjects */</span>
  <span class="keyword">val</span> <a title="Array[java.lang.String]" id="48901">subjects</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36294" title="()Array[java.lang.String]">getSubjects</a>

  <span class="comment">/** All possible ship types */</span>
  <span class="keyword">val</span> <a title="Array[java.lang.String]" id="48903">shipTypes</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36297" title="()Array[java.lang.String]">getShipTypes</a>

  <span class="comment">/** All possible credit card types */</span>
  <span class="keyword">val</span> <a title="Array[java.lang.String]" id="48905">ccTypes</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36296" title="()Array[java.lang.String]">getCreditCards</a>

  case <span class="keyword">class</span> <a title="class Action extends java.lang.Object with ScalaObject with Product with Serializable" id="52236">Action</a><a href="#52236" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="TpcwWorkflow.this.ActionType.Value" id="55258">action</a>: ActionType.<span title="TpcwWorkflow.this.ActionType.Value">Value</span>, <span class="keyword">var</span> <a title="List[(Int, TpcwWorkflow.this.Action)]" id="55259">nextActions</a> : <span title="List[(Int, TpcwWorkflow.this.Action)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>Int, Action<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">object</span> <a title="object TpcwWorkflow.this.ActionType" id="48910">ActionType</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Enumeration">Enumeration</span> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51875">ActionType</a> = <span title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value">Value</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51876">Home</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51878">NewProduct</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51880">BestSeller</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51882">ProductDetail</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51884">SearchRequest</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51886">SearchResult</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51888">ShoppingCart</a>,
    <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51890">CustomerReg</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51892">BuyRequest</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51894">BuyConfirm</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51896">OrderInquiry</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51898">OrderDisplay</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51900">AdminRequest</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value" id="51902">AdminConfirm</a> = <span title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.ActionType.Value">Value</span>

  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="object TpcwWorkflow.this.SearchResultType" id="48912">SearchResultType</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Enumeration">Enumeration</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value" id="51808">ByAuthor</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value" id="51810">ByTitle</a>, <a title="edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value" id="51812">BySubject</a> = <span title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwWorkflow.SearchResultType.Value">Value</span>
  <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="scala.collection.immutable.Vector[TpcwWorkflow.this.SearchResultType.Value]" id="48914">SearchTypes</a> = <span title="(elems: TpcwWorkflow.this.SearchResultType.Value*)scala.collection.immutable.Vector[TpcwWorkflow.this.SearchResultType.Value]">Vector</span><span class="delimiter">(</span><a href="#48912" title="object TpcwWorkflow.this.SearchResultType">SearchResultType</a>.<a href="#51808" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByAuthor</a>,
                           <a href="#48912" title="object TpcwWorkflow.this.SearchResultType">SearchResultType</a>.<a href="#51810" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByTitle</a>,
                           <a href="#48912" title="object TpcwWorkflow.this.SearchResultType">SearchResultType</a>.<a href="#51812" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">BySubject</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; TpcwWorkflow.this.SearchResultType.Value" id="48916">randomSearchType</a> =
    <a href="#48914" title="(index: Int)TpcwWorkflow.this.SearchResultType.Value">SearchTypes</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48914" title="=&gt; scala.collection.immutable.Vector[TpcwWorkflow.this.SearchResultType.Value]">SearchTypes</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(prob: Double)Boolean" id="48917">flipCoin</a><span class="delimiter">(</span><a title="Double" id="52538">prob</a>: <span title="Double">Double</span><span class="delimiter">)</span> =
    <a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="()Double">nextDouble</span> <span title="(x: Double)Boolean">&lt;</span> <a href="#52538" title="Double">prob</a>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="48918">shouldCreateNewUser</a> =
    <a href="#48917" title="(prob: Double)Boolean">flipCoin</a><span class="delimiter">(</span><span title="Double(0.2)" class="double">0.2</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="48919">newUserName</a> =
    <span title="object java.util.UUID">UUID</span>.<span title="()java.util.UUID">randomUUID</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="48920">randomUser</a> =
    <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36686" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36656" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="48921">randomSubject</a> =
    <a href="#48901" title="(i: Int)java.lang.String">subjects</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48901" title="=&gt; Array[java.lang.String]">subjects</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="48922">randomItem</a> =
    <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36692" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36649" title="=&gt; Int">numItems</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; String" id="48923">randomAuthor</a> =
    <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36687" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36660" title="=&gt; Int">numAuthors</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="48924">randomShipType</a> =
    <a href="#48903" title="(i: Int)java.lang.String">shipTypes</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48903" title="=&gt; Array[java.lang.String]">shipTypes</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="48925">randomCreditCardType</a> =
    <a href="#48905" title="(i: Int)java.lang.String">ccTypes</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48905" title="=&gt; Array[java.lang.String]">ccTypes</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]" id="48926">actions</a> = <span title="()scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]">HashMap</span><span class="delimiter">[</span>ActionType.ActionType, Action<span class="delimiter">]</span>
  <a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<span title="=&gt; TpcwWorkflow.this.ActionType.ValueSet">values</span>.<span title="(f: TpcwWorkflow.this.ActionType.Value =&gt; scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action])Unit">foreach</span><span class="delimiter">(</span><a title="TpcwWorkflow.this.ActionType.Value" id="52620">a</a> =&gt; <a href="#48926" title="=&gt; scala.collection.mutable.HashMap[TpcwWorkflow.this.ActionType.ActionType,TpcwWorkflow.this.Action]">actions</a> <span title="(kv: (TpcwWorkflow.this.ActionType.ActionType, TpcwWorkflow.this.Action))TpcwWorkflow.this.actions.type">+=</span> <a href="#52620" title="(x: TpcwWorkflow.this.ActionType.Value)ArrowAssoc[TpcwWorkflow.this.ActionType.Value]">a</a> <span title="(y: TpcwWorkflow.this.Action)(TpcwWorkflow.this.ActionType.Value, TpcwWorkflow.this.Action)">-&gt;</span> <span title="TpcwWorkflow.this.Action" class="keyword">new</span> <a href="#52236" title="TpcwWorkflow.this.Action">Action</a><span class="delimiter">(</span><a href="#52620" title="TpcwWorkflow.this.ActionType.Value">a</a>, <span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="TpcwWorkflow.this.ActionType.ValueSet" id="48928">unsupportedActions</a> = <a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<span title="=&gt; TpcwWorkflow.this.ActionType.ValueSet">values</span>.<span title="(p: TpcwWorkflow.this.ActionType.Value =&gt; Boolean)TpcwWorkflow.this.ActionType.ValueSet">filterNot</span><span class="delimiter">(</span><a href="#48936" title="=&gt; PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]">executeAction</a>.<span title="(x: TpcwWorkflow.this.ActionType.Value)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#52194" title="TpcwWorkflow.this.ActionType.Value">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;The following TPCW actions are not implemented: %s&quot;)" class="string">&quot;The following TPCW actions are not implemented: %s&quot;</span>, <a href="#48928" title="=&gt; TpcwWorkflow.this.ActionType.ValueSet">unsupportedActions</a><span class="delimiter">)</span>

  <span class="comment">// The MarkovChain from TPC-W: Thresholds for the &quot;Ordering Interval&quot;</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51902" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminConfirm</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(8348)" class="int">8348</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51900" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminRequest</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(8999)" class="int">8999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51902" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminConfirm</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51880" title="=&gt; TpcwWorkflow.this.ActionType.Value">BestSeller</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(333)" class="int">333</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51882" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9998)" class="int">9998</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51894" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyConfirm</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(2)" class="int">2</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51892" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyRequest</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(7999)" class="int">7999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51894" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyConfirm</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9453)" class="int">9453</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51890" title="=&gt; TpcwWorkflow.this.ActionType.Value">CustomerReg</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9899)" class="int">9899</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51892" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9901)" class="int">9901</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(499)" class="int">499</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51880" title="=&gt; TpcwWorkflow.this.ActionType.Value">BestSeller</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(999)" class="int">999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51878" title="=&gt; TpcwWorkflow.this.ActionType.Value">NewProduct</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1269)" class="int">1269</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51896" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderInquiry</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1295)" class="int">1295</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51878" title="=&gt; TpcwWorkflow.this.ActionType.Value">NewProduct</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(504)" class="int">504</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9942)" class="int">9942</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51882" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9976)" class="int">9976</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51898" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderDisplay</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9939)" class="int">9939</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51896" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderInquiry</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(1168)" class="int">1168</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9968)" class="int">9968</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51898" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderDisplay</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51882" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(99)" class="int">99</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51900" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(3750)" class="int">3750</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(5621)" class="int">5621</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51882" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(6341)" class="int">6341</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(815)" class="int">815</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9815)" class="int">9815</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51886" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchResult</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51886" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchResult</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(486)" class="int">486</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(7817)" class="int">7817</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51882" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9998)" class="int">9998</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51884" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchRequest</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span>.<a href="#55259" title="(x$1: List[(Int, TpcwWorkflow.this.Action)])Unit">nextActions</a> = <span title="(xs: (Int, TpcwWorkflow.this.Action)*)List[(Int, TpcwWorkflow.this.Action)]">List</span> <span class="delimiter">(</span> <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9499)" class="int">9499</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51890" title="=&gt; TpcwWorkflow.this.ActionType.Value">CustomerReg</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9918)" class="int">9918</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(_1: Int, _2: TpcwWorkflow.this.Action)(Int, TpcwWorkflow.this.Action)" class="delimiter">(</span><span title="Int(9999)" class="int">9999</span>, <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="TpcwWorkflow.this.ActionType.Value" id="48931">nextAction</a> = <a href="#48910" title="object TpcwWorkflow.this.ActionType">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a> <span class="comment">// HOME is start state</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="48934">currentUser</a>: <a href="TpcwSchema.scala.html#10225" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a> = _

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]" id="48936">executeAction</a>: <span title="PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]">PartialFunction</span><span class="delimiter">[</span>ActionType.Value, Unit<span class="delimiter">]</span> = <a href="#53949" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51876" title="=&gt; TpcwWorkflow.this.ActionType.Value">Home</a> =&gt; <span class="delimiter">{</span>
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Home&quot;)" class="string">&quot;Home&quot;</span><span class="delimiter">)</span>

        <span class="comment">// NOTE: technically this should be done in the customer reg</span>
        <span class="comment">// phase, but we're doing it here...</span>
        <a href="#48934" title="(x$1: edu.berkeley.cs.scads.piql.tpcw.Customer)Unit">currentUser</a> =
          <span title="edu.berkeley.cs.scads.piql.tpcw.Customer" class="keyword">if</span> <span class="delimiter">(</span><a href="#48918" title="=&gt; Boolean">shouldCreateNewUser</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="53952">cust</a> = <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36699" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer">createCustomer</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
            <a href="#53952" title="edu.berkeley.cs.scads.piql.tpcw.Customer">cust</a>.<a href="TpcwSchema.scala.html#21424" title="(x$1: String)Unit">C_UNAME</a> = <a href="#48919" title="=&gt; java.lang.String">newUserName</a> <span class="comment">// use a random UUID for a username</span>
            <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14667" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer]">customers</a>.<span title="(pairRec: edu.berkeley.cs.scads.piql.tpcw.Customer)Unit">put</span><span class="delimiter">(</span><a href="#53952" title="edu.berkeley.cs.scads.piql.tpcw.Customer">cust</a><span class="delimiter">)</span> <span class="comment">// save new customer</span>
            <a href="#53952" title="edu.berkeley.cs.scads.piql.tpcw.Customer">cust</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span class="comment">// pick existing user</span>
            <span class="keyword">val</span> <a title="String" id="53960">user</a> = <a href="#48920" title="=&gt; String">randomUser</a>
            <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.package.QueryResult" id="53961">userData</a> = <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14684" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">homeWI</a><span class="delimiter">(</span><a href="#53960" title="String">user</a><span class="delimiter">)</span>
            <a href="#53961" title="(idx: Int)edu.berkeley.cs.scads.piql.package.Tuple">userData</a><span title="(idx: Int)edu.berkeley.cs.scads.piql.package.Record" class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span title="(record: edu.berkeley.cs.scads.piql.package.Record)edu.berkeley.cs.avro.runtime.RichIndexedRecord[edu.berkeley.cs.scads.piql.package.Record]" class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[SR &lt;: org.apache.avro.specific.SpecificRecord](implicit m: Manifest[SR])SR">toSpecificRecord</span><span title="(implicit m: Manifest[edu.berkeley.cs.scads.piql.tpcw.Customer])edu.berkeley.cs.scads.piql.tpcw.Customer" class="delimiter">[</span><a href="TpcwSchema.scala.html#10225" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a><span class="delimiter">]</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51878" title="=&gt; TpcwWorkflow.this.ActionType.Value">NewProduct</a> =&gt; <span class="delimiter">{</span>
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;NewProduct&quot;)" class="string">&quot;NewProduct&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.lang.String" id="54005">subject</a> = <a href="#48921" title="=&gt; java.lang.String">randomSubject</a>
        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14686" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">newProductWI</a><span title="Unit" class="delimiter">(</span><a href="#54005" title="java.lang.String">subject</a>, <a href="#48899" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51882" title="=&gt; TpcwWorkflow.this.ActionType.Value">ProductDetail</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ProductDetail&quot;)" class="string">&quot;ProductDetail&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="String" id="54008">item</a> = <a href="#48922" title="=&gt; String">randomItem</a>
        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14688" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">productDetailWI</a><span title="Unit" class="delimiter">(</span><a href="#54008" title="String">item</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51898" title="=&gt; TpcwWorkflow.this.ActionType.Value">OrderDisplay</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;OrderDisplay&quot;)" class="string">&quot;OrderDisplay&quot;</span><span class="delimiter">)</span>
        <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14702" title="(c_uname: String, c_passwd: String, numOrderLinesPerPage: Int)(edu.berkeley.cs.scads.piql.tpcw.Customer, Option[edu.berkeley.cs.scads.piql.tpcw.Order], Option[edu.berkeley.cs.scads.piql.package.QueryResult])">orderDisplayWI</a><span title="Unit" class="delimiter">(</span><a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#21423" title="=&gt; String">C_UNAME</a>, <a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#21427" title="=&gt; String">C_PASSWD</a>, <span title="Int(100)" class="int">100</span><span class="delimiter">)</span>

      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51886" title="=&gt; TpcwWorkflow.this.ActionType.Value">SearchResult</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;SearchResult&quot;)" class="string">&quot;SearchResult&quot;</span><span class="delimiter">)</span>
        <span class="comment">// pick a random search type</span>
        <a href="#48916" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">randomSearchType</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#48912" title="Unit">SearchResultType</a>.<a href="#51808" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByAuthor</a> =&gt;
            <span class="keyword">val</span> <a title="String" id="54022">author</a> = <a href="#48923" title="=&gt; String">randomAuthor</a>
            <span class="keyword">val</span> <a title="String" id="54023">name</a> = <a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="()Boolean">nextBoolean</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="String" class="keyword">false</span> =&gt; <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36688" title="(authorId: String)String">toAuthorFname</a><span class="delimiter">(</span><a href="#54022" title="String">author</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="String" class="keyword">true</span> =&gt; <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36689" title="(authorId: String)String">toAuthorLname</a><span class="delimiter">(</span><a href="#54022" title="String">author</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Search by author name %s&quot;)" class="string">&quot;Search by author name %s&quot;</span>, <a href="#54023" title="String">name</a><span class="delimiter">)</span>
            <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14690" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">searchByAuthorWI</a><span title="Unit" class="delimiter">(</span><a href="#54023" title="String">name</a>, <a href="#48899" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#48912" title="Unit">SearchResultType</a>.<a href="#51810" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">ByTitle</a> =&gt;
            <span class="comment">/* Pick a random token from a random title */</span>
            <span class="keyword">val</span> <a title="Array[java.lang.String]" id="54028">titleParts</a> = <a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36694" title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item">createItem</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#48939" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwLoader">data</a>.<a href="TpcwLoader.scala.html#36649" title="=&gt; Int">numItems</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="TpcwSchema.scala.html#21491" title="=&gt; String">I_TITLE</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span class="delimiter">(</span><span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="java.lang.String" id="54029">title</a> = <a href="#54028" title="(i: Int)java.lang.String">titleParts</a><span class="delimiter">(</span><a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#54028" title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]">titleParts</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Search by title %s&quot;)" class="string">&quot;Search by title %s&quot;</span>, <a href="#54029" title="java.lang.String">title</a><span class="delimiter">)</span>
            <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14692" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">searchByTitleWI</a><span title="Unit" class="delimiter">(</span><a href="#54029" title="java.lang.String">title</a>, <a href="#48899" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#48912" title="Unit">SearchResultType</a>.<a href="#51812" title="=&gt; TpcwWorkflow.this.SearchResultType.Value">BySubject</a> =&gt;
            <span class="keyword">val</span> <a title="java.lang.String" id="54608">subject</a> = <a href="#48921" title="=&gt; java.lang.String">randomSubject</a>
            <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Search by subject %s&quot;)" class="string">&quot;Search by subject %s&quot;</span>, <a href="#54608" title="java.lang.String">subject</a><span class="delimiter">)</span>
            <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14694" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">searchBySubjectWI</a><span title="Unit" class="delimiter">(</span><a href="#54608" title="java.lang.String">subject</a>, <a href="#48899" title="=&gt; Int">perPage</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51888" title="=&gt; TpcwWorkflow.this.ActionType.Value">ShoppingCart</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ShoppingCart&quot;)" class="string">&quot;ShoppingCart&quot;</span><span class="delimiter">)</span>
        <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="java.lang.String(&quot;Current user should not be null&quot;)" class="string">&quot;Current user should not be null&quot;</span><span class="delimiter">)</span>

        <span class="comment">/**
         * This is a simplification of the actual shopping cart WI where
         * instead of being based on the previous action we just always
         * select some random items to update in the shopping cart.
         *
         * We believe processsing time &gt;= tpcwspec processing time
         */</span>

        <span class="keyword">val</span> <a title="scala.collection.immutable.IndexedSeq[(String, Int)]" id="54613">items</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; (String, Int))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],(String, Int),scala.collection.immutable.IndexedSeq[(String, Int)]])scala.collection.immutable.IndexedSeq[(String, Int)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,(String, Int),scala.collection.immutable.IndexedSeq[(String, Int)]]" class="delimiter">(</span><a title="Int" id="54761">_</a> =&gt; <span title="(_1: String, _2: Int)(String, Int)" class="delimiter">(</span><a href="#48922" title="=&gt; String">randomItem</a>, <a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span title="(x: Int)Int">-</span> <span title="Int(5)" class="int">5</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14705" title="(c_uname: String, newItems: Seq[(String, Int)])Unit">shoppingCartWI</a><span class="delimiter">(</span><a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#21423" title="=&gt; String">C_UNAME</a>, <a href="#54613" title="scala.collection.immutable.IndexedSeq[(String, Int)]">items</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51892" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyRequest</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;BuyRequest&quot;)" class="string">&quot;BuyRequest&quot;</span><span class="delimiter">)</span>
        <span class="comment">// for now always assuming existing user</span>
        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14706" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">buyRequestExistingCustomerWI</a><span title="Unit" class="delimiter">(</span><a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#21423" title="=&gt; String">C_UNAME</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51894" title="=&gt; TpcwWorkflow.this.ActionType.Value">BuyConfirm</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;BuyConfirm&quot;)" class="string">&quot;BuyConfirm&quot;</span><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="java.lang.String" id="54806">cc_type</a> = <a href="#48925" title="=&gt; java.lang.String">randomCreditCardType</a>
        <span class="keyword">val</span> <a title="Int" id="54807">cc_number</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36285" title="(num_digits: Int)Int">getRandomNString</a><span class="delimiter">(</span><span title="Int(16)" class="int">16</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.lang.String" id="54808">cc_name</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36283" title="(min: Int, max: Int)java.lang.String">getRandomAString</a><span class="delimiter">(</span><span title="Int(14)" class="int">14</span>, <span title="Int(30)" class="int">30</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Long" id="54809">cc_expiry</a> = <span class="delimiter">{</span>
          <span class="keyword">import</span> java.util.Calendar
          <span class="keyword">val</span> <a title="java.util.GregorianCalendar" id="54823">cal</a> = <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36290" title="()java.util.GregorianCalendar">getCalendar</a>
          <a href="#54823" title="java.util.GregorianCalendar">cal</a>.<span title="(x$1: Int, x$2: Int)Unit">add</span><span class="delimiter">(</span>Calendar.<span title="Int(6)">DAY_OF_YEAR</span>, <a href="Utils.java.html#9140" title="object ch.ethz.systems.tpcw.populate.data.Utils">Utils</a>.<a href="Utils.java.html#36287" title="(lower: Int, upper: Int)Int">getRandomInt</a><span class="delimiter">(</span><span title="Int(10)" class="int">10</span>, <span title="Int(730)" class="int">730</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#54823" title="java.util.GregorianCalendar">cal</a>.<span title="()java.util.Date">getTime</span>.<span title="()Long">getTime</span>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="java.lang.String" id="54810">shipping</a> = <a href="#48924" title="=&gt; java.lang.String">randomShipType</a>

        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14708" title="(c_uname: String, cc_type: String, cc_number: Int, cc_name: String, cc_expiry: Long, shipping: String)String">buyConfirmWI</a><span title="Unit" class="delimiter">(</span>
          <a href="#48934" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.Customer">currentUser</a>.<a href="TpcwSchema.scala.html#21423" title="=&gt; String">C_UNAME</a>,
          <a href="#54806" title="java.lang.String">cc_type</a>,
          <a href="#54807" title="Int">cc_number</a>,
          <a href="#54808" title="java.lang.String">cc_name</a>,
          <a href="#54809" title="Long">cc_expiry</a>,
          <a href="#54810" title="java.lang.String">shipping</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#48910" title="Unit">ActionType</a>.<a href="#51900" title="=&gt; TpcwWorkflow.this.ActionType.Value">AdminRequest</a> =&gt;
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;AdminRequest&quot;)" class="string">&quot;AdminRequest&quot;</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="String" id="55193">item</a> = <a href="#48922" title="=&gt; String">randomItem</a>
        <a href="#48938" title="=&gt; edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14709" title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">adminRequestWI</a><span title="Unit" class="delimiter">(</span><a href="#55193" title="String">item</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="comment">/**
   * Advances the TPC-W markov chain model one state transition.
   * returns true if the action was run and false if it was skipped due to PIQL Limitations
   */</span>
  <span class="keyword">def</span> <a title="()Boolean" id="48937">executeMix</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Boolean" id="55196">executed</a> =
      <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#48936" title="=&gt; PartialFunction[TpcwWorkflow.this.ActionType.Value,Unit]">executeAction</a>.<span title="(x: TpcwWorkflow.this.ActionType.Value)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#48931" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Executing Action: %s&quot;)" class="string">&quot;Executing Action: %s&quot;</span>, <a href="#48931" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span>
        <a href="#48936" title="(v1: TpcwWorkflow.this.ActionType.Value)Unit">executeAction</a><span class="delimiter">(</span><a href="#48931" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span>
        <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#48895" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">debug</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Skipping undefined action: %s&quot;)" class="string">&quot;Skipping undefined action: %s&quot;</span>, <a href="#48931" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a><span class="delimiter">)</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Int" id="55197">rnd</a> = <a href="#48897" title="=&gt; scala.util.Random">random</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(9999)" class="int">9999</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="TpcwWorkflow.this.ActionType.Value" id="55198">lastAction</a> = <a href="#48931" title="=&gt; TpcwWorkflow.this.ActionType.Value">nextAction</a>
    <a href="#48931" title="(x$1: TpcwWorkflow.this.ActionType.Value)Unit">nextAction</a> = <a href="#48926" title="(key: TpcwWorkflow.this.ActionType.ActionType)TpcwWorkflow.this.Action">actions</a><span class="delimiter">(</span><a href="#55198" title="TpcwWorkflow.this.ActionType.Value">lastAction</a><span class="delimiter">)</span>.<a href="#55259" title="=&gt; List[(Int, TpcwWorkflow.this.Action)]">nextActions</a>.<span title="(p: (Int, TpcwWorkflow.this.Action) =&gt; Boolean)Option[(Int, TpcwWorkflow.this.Action)]">find</span><span class="delimiter">(</span><a href="#55197" title="Int">rnd</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#55249" title="(Int, TpcwWorkflow.this.Action)">_</a>.<span title="=&gt; Int">_1</span><span class="delimiter">)</span>.<span title="=&gt; (Int, TpcwWorkflow.this.Action)">get</span>.<span title="=&gt; TpcwWorkflow.this.Action">_2</span>.<a href="#55258" title="=&gt; TpcwWorkflow.this.ActionType.Value">action</a>

    <a href="#55196" title="Boolean">executed</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>