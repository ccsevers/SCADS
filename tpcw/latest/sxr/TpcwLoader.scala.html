<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TpcwLoader.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> tpcw

<span class="keyword">import</span> net.lag.logging._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.storage._
<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.piql.<span title="object edu.berkeley.cs.scads.piql.DataGenerator">DataGenerator</span>._
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.Generator
<span class="keyword">import</span> java.util.UUID
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.objects._
<span class="keyword">import</span> collection.mutable.<span class="delimiter">{</span>ArrayBuffer, HashMap<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.generic.IndexedRecord
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._
<span class="keyword">import</span> org.apache.avro.util.Utf8


<span class="keyword">class</span> <a title="class TpcwLoader extends java.lang.Object with ScalaObject" id="9650">TpcwLoader</a><a href="#9650" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Double" id="37471">numEBs</a> : <span title="Double">Double</span>,
                 <span class="keyword">val</span> <a title="Int" id="37472">numItems</a> : <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="37135">logger</a> = <span title="()net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37471" title="=&gt; Double">numEBs</a> <span title="(x: Double)Boolean">&gt;</span> <span title="Double(0.0)" class="double">0.0</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37472" title="=&gt; Int">numItems</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="comment">/**
   * See clause 4.2.2 - items MUST be chosen from the following set
   */</span>
  <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Int]" id="37137">ValidItemCardinalities</a> = <span title="(elems: Int*)scala.collection.immutable.Set[Int]">Set</span><span class="delimiter">(</span><span title="Int(1000)" class="int">1000</span>, <span title="Int(10000)" class="int">10000</span>, <span title="Int(100000)" class="int">100000</span>, <span title="Int(1000000)" class="int">1000000</span>, <span title="Int(10000000)" class="int">10000000</span><span class="delimiter">)</span>

  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#37137" title="=&gt; scala.collection.immutable.Set[Int]">ValidItemCardinalities</a>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#37472" title="=&gt; Int">numItems</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#37135" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;)" class="string">&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;</span>, <a href="#37472" title="=&gt; Int">numItems</a><span class="delimiter">)</span>

  <span class="comment">/** Cardinalities defined by clause 4.3 */</span>
  <span class="keyword">val</span> <a title="Int" id="37139">numCustomers</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><a href="#37471" title="=&gt; Double">numEBs</a> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <span title="Int(2880)" class="int">2880</span><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="37141">numAddresses</a> : <span title="Int">Int</span> = <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#37139" title="=&gt; Int">numCustomers</a>
  <span class="keyword">val</span> <a title="Int" id="37143">numAuthors</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.25)" class="double">.25</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#37472" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="37145">numOrders</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.9)" class="double">.9</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#37139" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="37147">numCountries</a> : <span title="Int">Int</span> = <span title="Int(92)" class="int">92</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="scala.util.Random" id="37149">rand</a> = <span title="()scala.util.Random" class="keyword">new</span> scala.util.<span title="scala.util.Random">Random</span>

  <span class="keyword">trait</span> <a title="trait NamespaceData extends java.lang.Object with ScalaObject" id="37151">NamespaceData</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="37761">Pair</a> &lt;: AvroPair
    <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]" id="37762">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">PairNamespace</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Seq[NamespaceData.this.Pair]" id="37763">sampleData</a>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]" id="37764">dataSlice</a><span class="delimiter">(</span><a title="Int" id="37772">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37773">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(replicationFactor: Int)Unit" id="37765">repartition</a><span class="delimiter">(</span><a title="Int" id="37775">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37762" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a>.<span title="(data: Seq[NamespaceData.this.Pair], replicationFactor: Int)Unit">repartition</span><span class="delimiter">(</span><a href="#37763" title="=&gt; Seq[NamespaceData.this.Pair]">sampleData</a>, <a href="#37775" title="Int">replicationFactor</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(clientId: Int, numLoaders: Int)Unit" id="37766">load</a><span class="delimiter">(</span><a title="Int" id="37784">clientId</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>, <a title="Int" id="37785">numLoaders</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37762" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a> <span title="(that: TraversableOnce[NamespaceData.this.Pair])Unit">++=</span>  <a href="#37764" title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]">dataSlice</a><span class="delimiter">(</span><a href="#37784" title="Int">clientId</a>, <a href="#37785" title="Int">numLoaders</a><span class="delimiter">)</span>

        <span class="comment">/** assuming [1, upperBound], returns the slice of data for this clientId */</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]" id="37767">getSlice</a><span class="delimiter">(</span><a title="Int" id="37789">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37790">numClients</a>: <span title="Int">Int</span>, <a title="Int" id="37791">upperBound</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37791" title="Int">upperBound</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="37794">numPerClient</a> = <a href="#37791" title="Int">upperBound</a> <span title="(x: Int)Int">/</span> <a href="#37790" title="Int">numClients</a>
      <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37794" title="Int">numPerClient</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// this is the case where there are more clients than elements to slice</span>
        <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37789" title="Int">clientId</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#37791" title="Int">upperBound</a><span class="delimiter">)</span> <span title="object Seq">Seq</span>.<span title="Seq[Nothing]">empty</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#37789" title="Int">clientId</a> <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">+</span> <span title="Int(1)" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37789" title="Int">clientId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="40151">start</a> = <a href="#37789" title="Int">clientId</a> <span title="(x: Int)Int">*</span> <a href="#37794" title="Int">numPerClient</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span title="scala.collection.immutable.Range" class="keyword">if</span> <span class="delimiter">(</span><a href="#37789" title="Int">clientId</a> <span title="(x: Int)Boolean">==</span> <a href="#37790" title="Int">numClients</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#40151" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37791" title="Int">upperBound</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#40151" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range">until</span> <span class="delimiter">(</span><a href="#40151" title="Int">start</a> <span title="(x: Int)Int">+</span> <a href="#37794" title="Int">numPerClient</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait NoLoad extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject" id="37152">NoLoad</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#37151" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)scala.collection.immutable.Nil.type" id="40273">dataSlice</a><span class="delimiter">(</span><a title="Int" id="40276">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="40277">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class RandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="42103">RandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="42105">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#42103" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42560">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; A" id="42561">generator</a>: Int =&gt; A, <a title="Int" id="42562">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#37151" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="40290">Pair</a> = <a href="#42105" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[RandomData.this.Pair]" id="40291">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42562" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42561" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[RandomData.this.Pair]" id="40292">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41862">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41863">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37767" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41862" title="Int">clientId</a>, <a href="#41863" title="Int">numClients</a>, <a href="#42562" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42561" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class FlattenedRandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="42494">FlattenedRandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="42496">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#42494" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42633">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; Seq[A]" id="42634">generator</a>: Int =&gt; Seq<span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int" id="42635">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#37151" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="42222">Pair</a> = <a href="#42496" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[FlattenedRandomData.this.Pair]" id="42223">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42635" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42634" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[FlattenedRandomData.this.Pair]" id="42224">dataSlice</a><span class="delimiter">(</span><a title="Int" id="42393">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="42394">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37767" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#42393" title="Int">clientId</a>, <a href="#42394" title="Int">numClients</a>, <a href="#42635" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42634" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">//TODO: Partition shopping cart</span>
  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]" id="37161">namespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42553">client</a>: <a href="TpcwClient.scala.html#9634" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a><span class="delimiter">)</span>: <span title="Seq[TpcwLoader.this.NamespaceData]">Seq</span><span class="delimiter">[</span>NamespaceData<span class="delimiter">]</span> =
    <span title="[A](xs: A*)List[A]">List</span><span title="(xs: TpcwLoader.this.NamespaceData*)List[TpcwLoader.this.NamespaceData]" class="delimiter">[</span><a href="#37151" title="TpcwLoader.this.NamespaceData">NamespaceData</a><span class="delimiter">]</span><span class="delimiter">(</span>
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Address, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Address]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12736" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address]">addresses</a>, <a href="#37181" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address">createAddress</a><span class="delimiter">(</span><a href="#42572" title="Int">_</a><span class="delimiter">)</span>, <a href="#37139" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Author, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Author]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12738" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author]">authors</a>, <a href="#37180" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author">createAuthor</a><span class="delimiter">(</span><a href="#42583" title="Int">_</a><span class="delimiter">)</span>, <a href="#37143" title="=&gt; Int">numAuthors</a><span class="delimiter">)</span>,
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.CcXact, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.CcXact]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12740" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact]">xacts</a>, <a href="#37179" title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact">createXacts</a><span class="delimiter">(</span><a href="#42594" title="Int">_</a><span class="delimiter">)</span>, <a href="#37145" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Country, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Country]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12742" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country]">countries</a>, <a href="#37178" title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country">createCountry</a><span class="delimiter">(</span><a href="#42605" title="Int">_</a><span class="delimiter">)</span>, <a href="#37147" title="=&gt; Int">numCountries</a><span class="delimiter">)</span>,
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Customer, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Customer]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12744" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer]">customers</a>, <a href="#37182" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer">createCustomer</a><span class="delimiter">(</span><a href="#42616" title="Int">_</a><span class="delimiter">)</span>, <a href="#37139" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Item, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Item]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12746" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item]">items</a>, <a href="#37177" title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item">createItem</a><span class="delimiter">(</span><a href="#42627" title="Int">_</a><span class="delimiter">)</span>, <a href="#37472" title="=&gt; Int">numItems</a><span class="delimiter">)</span>,
      <a href="#42494" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine], generator: Int =&gt; Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine], numRecords: Int)TpcwLoader.this.FlattenedRandomData[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">FlattenedRandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12748" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">orderLines</a>, <a href="#37184" title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">createOrderline</a><span class="delimiter">(</span><a href="#42645" title="Int">_</a><span class="delimiter">)</span>, <a href="#37145" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#42103" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Order, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Order]">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12750" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order]">orders</a>, <a href="#37183" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order">createOrder</a><span class="delimiter">(</span><a href="#42656" title="Int">_</a><span class="delimiter">)</span>, <a href="#37145" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#42662" title="TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" class="keyword">new</a> <a title="anonymous class $anon extends TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" id="42662">RandomData</a><span class="delimiter">(</span><a href="#42553" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12752" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem]">shoppingCartItems</a>, <a title="Int" id="42702">i</a> =&gt; <a href="TpcwSchema.scala.html#51137" title="(SCL_C_UNAME: String, SCL_I_ID: String)edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem">ShoppingCartItem</a><span class="delimiter">(</span><a href="#37169" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#42702" title="Int">i</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#37139" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#37152" title="TpcwLoader.this.NoLoad">NoLoad</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient, replicationFactor: Int)Unit" id="37162">createNamespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42703">client</a>: <a href="TpcwClient.scala.html#9634" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a>, <a title="Int" id="42704">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37161" title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]">namespaces</a><span class="delimiter">(</span><a href="#42703" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a><span class="delimiter">)</span>.<span title="(f: TpcwLoader.this.NamespaceData =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#42741" title="TpcwLoader.this.NamespaceData">_</a>.<a href="#37765" title="(replicationFactor: Int)Unit">repartition</a><span class="delimiter">(</span><a href="#42704" title="Int">replicationFactor</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()String" id="37163">uuid</a><span class="delimiter">(</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="()java.util.UUID">randomUUID</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)String" id="37164">nameUuid</a><span class="delimiter">(</span><a title="String" id="42676">s</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="(x$1: Array[Byte])java.util.UUID">nameUUIDFromBytes</span><span class="delimiter">(</span><a href="#42676" title="String">s</a>.<span title="(x$1: java.lang.String)Array[Byte]">getBytes</span><span class="delimiter">(</span><span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>

  <span class="comment">/**
   * Given a cluster size, create the hex splits, sorted in string lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)Seq[Option[String]]" id="37165">hexSplit</a><span class="delimiter">(</span><a title="Int" id="42797">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[Option[String]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="42799">size</a> = <span title="Int(16)" class="int">16</span>
    <span class="keyword">var</span> <a title="Int" id="42800">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#42799" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#42797" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#42802" title="()Unit" class="delimiter">{</a>
      <a href="#42799" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>
      <a href="#42800" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#42799" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>; <a href="#42800" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>
    <span class="keyword">val</span> <a title="Double" id="42801">numPerNode</a> = <a href="#42799" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#42797" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#42801" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#42837" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],Seq[Option[String]]])Seq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#42797" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="42981">i</a> =&gt; <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%0&quot;)" class="string">&quot;%0&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#42800" title="Int">levels</a> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span> <span title="java.lang.String(&quot;x&quot;)" class="string">&quot;x&quot;</span><span class="delimiter">)</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#42981" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#42801" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43355" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create 8-bit ASCII split, sorted in string
   * lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="37166">utf8Split</a><span class="delimiter">(</span><a title="Int" id="43481">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="43484">size</a> = <span title="Int(256)" class="int">256</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43484" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43481" title="Int">clusterSize</a><span class="delimiter">)</span>
      <a href="#43484" title="Int">size</a> = <a href="#43484" title="Int">size</a> <span title="(x: Int)Int">*</span> <span title="Int(256)" class="int">256</span>

    <span class="keyword">val</span> <a title="Int" id="43485">numPerNode</a> = <a href="#43484" title="Int">size</a> <span title="(x: Int)Int">/</span> <a href="#43481" title="Int">clusterSize</a>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#43485" title="Int">numPerNode</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

    <span class="comment">// encodes i as a base 256 string. not super efficient</span>
    <span class="keyword">def</span> <a title="(i: Int)String" id="43486">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43506">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#43506" title="Int">i</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String(&quot;&quot;)" class="int">0</span> =&gt; <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="keyword">case</span> <span title="java.lang.String">_</span> =&gt; <a href="#43486" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43506" title="Int">i</a> <span title="(x: Int)Int">/</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#43506" title="Int">i</a> <span title="(x: Int)Int">%</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>
    <span class="delimiter">}</span>

    <span title="object None">None</span> <a href="#43515" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43481" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43615">i</a> =&gt; <span class="delimiter">(</span><a href="#43486" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43615" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#43485" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43725" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create splits over printable chars, defined as
   * ASCII [33-126]
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="37167">printableCharSplit</a><span class="delimiter">(</span><a title="Int" id="43823">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#43827" title="(Int, Int)" class="delimiter">(</a><a href="#43826" title="Int" id="43827">low</a>, <a href="#43826" title="Int" id="43828">high</a><span class="delimiter">)</span> = <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="Int(33)" class="int">33</span>, <span title="Int(126)" class="int">126</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43829">numChars</a> = <a href="#43828" title="Int">high</a> <span title="(x: Int)Int">-</span> <a href="#43827" title="Int">low</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">var</span> <a title="Int" id="43830">size</a> = <a href="#43829" title="Int">numChars</a>
    <span class="keyword">var</span> <a title="Int" id="43831">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43830" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43823" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#43835" title="()Unit" class="delimiter">{</a>
      <a href="#43830" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43829" title="Int">numChars</a>
      <a href="#43831" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#43830" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43829" title="Int">numChars</a>; <a href="#43831" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>

    <span class="keyword">def</span> <a title="(i: Int)String" id="43832">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43881">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> =
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#43881" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43829" title="Int">numChars</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#43881" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#43827" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>
      <span class="keyword">else</span> <a href="#43832" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43881" title="Int">i</a> <span title="(x: Int)Int">/</span> <a href="#43829" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#43881" title="Int">i</a> <span title="(x: Int)Int">%</span> <a href="#43829" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <a href="#43827" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>

    <span class="keyword">def</span> <a title="(str: String, ch: Char, level: Int)String" id="43833">pad</a><span class="delimiter">(</span><a title="String" id="43902">str</a>: <span title="String">String</span>, <a title="Char" id="43903">ch</a>: <span title="Char">Char</span>, <a title="Int" id="43904">level</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="String" id="43905">s</a> = <a href="#43902" title="String">str</a>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43905" title="String">s</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#43904" title="Int">level</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#43905" title="String">s</a> = <a href="#43903" title="Char">ch</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#43905" title="String">s</a>
      <span class="delimiter">}</span>
      <a href="#43905" title="String">s</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Double" id="43834">numPerNode</a> = <a href="#43830" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#43823" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#43834" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#43922" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43823" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="44022">i</a> =&gt; <a href="#43833" title="(str: String, ch: Char, level: Int)String">pad</a><span class="delimiter">(</span><a href="#43832" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#44022" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#43834" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>, <a href="#43827" title="Int">low</a>.<span title="=&gt; Char">toChar</span>, <a href="#43831" title="Int">levels</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#44132" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Splits a given range [0, rangeSplit) between clusterSize. if
   * clusterSize exceeds the given range, then clusterSize - givenRange
   * elements are dropped
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(end: Int, clusterSize: Int)Seq[Option[Int]]" id="37168">rangeSplit</a><span class="delimiter">(</span><a title="Int" id="44230">end</a>: <span title="Int">Int</span>, <a title="Int" id="44231">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[Option[Int]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="44233">realSize</a> = <a href="#44231" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> scala.math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#44231" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> <a href="#44230" title="Int">end</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="44234">numPerNode</a> = <a href="#44230" title="Int">end</a> <span title="(x: Int)Int">/</span> <a href="#44233" title="Int">realSize</a>
    <span title="object None">None</span> <a href="#44255" title="(elem: Option[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[Int]],Option[Int],Seq[Option[Int]]])Seq[Option[Int]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#44233" title="Int">realSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; Some[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]])scala.collection.immutable.IndexedSeq[Some[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]]" class="delimiter">(</span><a title="Int" id="44355">i</a> =&gt; <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#44355" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#44234" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="37169">toCustomer</a><span class="delimiter">(</span><a title="Int" id="42673">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;cust%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#42673" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="37170">toAuthor</a><span class="delimiter">(</span><a title="Int" id="44485">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44485" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author FNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="37171">toAuthorFname</a><span class="delimiter">(</span><a title="String" id="44491">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_fname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44491" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author LNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="37172">toAuthorLname</a><span class="delimiter">(</span><a title="String" id="44497">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_lname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44497" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="37173">toAddress</a><span class="delimiter">(</span><a title="Int" id="44503">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;address%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44503" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="37174">toXact</a><span class="delimiter">(</span><a title="Int" id="44509">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;xact%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44509" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="37175">toItem</a><span class="delimiter">(</span><a title="Int" id="44515">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;item%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44515" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="37176">toOrder</a><span class="delimiter">(</span><a title="Int" id="44521">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#37164" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;order%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44521" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item" id="37177">createItem</a><span class="delimiter">(</span><a title="Int" id="42628">itemId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#51169" title="edu.berkeley.cs.scads.piql.tpcw.Item">Item</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" id="44527">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int, x$2: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateItem</span><span class="delimiter">(</span><a href="#42628" title="Int">itemId</a>, <a href="#37472" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" class="delimiter">[</span><a href="ItemTO.java.html#9170" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">ItemTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = itemIds.getOrElseUpdate(itemId, uuid())</span>
    <span class="comment">//itemSubjectDateTitleIndexInserts += Tuple2(</span>
    <span class="comment">//  ItemSubjectDateTitleIndexKey(to.getI_subject,</span>
    <span class="comment">//    to.getI_pub_date,</span>
    <span class="comment">//    to.getI_title),</span>
    <span class="comment">//  ItemKey(idStr))</span>
    <span class="comment">//val author =  authors.get(to.getI_a_id)</span>

    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_FNAME, to.getI_title, idStr), NullRecord(true))</span>
    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_LNAME, to.getI_title, idStr), NullRecord(true))</span>

    <span class="comment">//val tokens = to.getI_title.split(&quot;\\s+&quot;);</span>

    <span class="comment">//itemTitleIndexInserts ++= tokens.map(x =&gt; (ItemTitleIndexKey(x.toLowerCase, to.getI_title ,idStr), NullRecord(true)))</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Item" id="44528">item</a> = <a href="TpcwSchema.scala.html#51169" title="(I_ID: String)edu.berkeley.cs.scads.piql.tpcw.Item">Item</a><span class="delimiter">(</span><a href="#37175" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#42628" title="Int">itemId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21526" title="(x$1: String)Unit">I_TITLE</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44349" title="()java.lang.String">getI_title</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21529" title="(x$1: String)Unit">I_A_ID</a> = <a href="#37170" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44351" title="()Int">getI_a_id</a><span class="delimiter">)</span>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21532" title="(x$1: Long)Unit">I_PUB_DATE</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44353" title="()Long">getI_pub_date</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21535" title="(x$1: String)Unit">I_PUBLISHER</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44355" title="()java.lang.String">getI_publisher</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21538" title="(x$1: String)Unit">I_SUBJECT</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44357" title="()java.lang.String">getI_subject</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21541" title="(x$1: String)Unit">I_DESC</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44359" title="()java.lang.String">getI_desc</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21544" title="(x$1: Int)Unit">I_RELATED1</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44361" title="()Int">getI_related1</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21547" title="(x$1: Int)Unit">I_RELATED2</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44363" title="()Int">getI_related2</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21550" title="(x$1: Int)Unit">I_RELATED3</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44365" title="()Int">getI_related3</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21553" title="(x$1: Int)Unit">I_RELATED4</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44367" title="()Int">getI_related4</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21556" title="(x$1: Int)Unit">I_RELATED5</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44369" title="()Int">getI_related5</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21559" title="(x$1: String)Unit">I_THUMBNAIL</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44371" title="()java.lang.String">getI_thumbnail</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21562" title="(x$1: String)Unit">I_IMAGE</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44373" title="()java.lang.String">getI_image</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21565" title="(x$1: Double)Unit">I_SRP</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44375" title="()Double">getI_srp</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21568" title="(x$1: Double)Unit">I_COST</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44377" title="()Double">getI_cost</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21571" title="(x$1: Long)Unit">I_AVAIL</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44379" title="()Long">getI_avail</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21574" title="(x$1: Int)Unit">I_STOCK</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44381" title="()Int">getI_stock</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21577" title="(x$1: String)Unit">ISBN</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44383" title="()java.lang.String">getI_isbn</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21580" title="(x$1: Int)Unit">I_PAGE</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44385" title="()Int">getI_page</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21583" title="(x$1: String)Unit">I_BACKING</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44387" title="()java.lang.String">getI_backing</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21586" title="(x$1: String)Unit">I_DIMENSION</a> = <a href="#44527" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44389" title="()java.lang.String">getI_dimensions</a>
    <a href="#44528" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country" id="37178">createCountry</a><span class="delimiter">(</span><a title="Int" id="42606">countryId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#51165" title="edu.berkeley.cs.scads.piql.tpcw.Country">Country</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" id="44621">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCountry</span><span class="delimiter">(</span><a href="#42606" title="Int">countryId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" class="delimiter">[</span><a href="CountryTO.java.html#9162" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">CountryTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Country" id="44622">country</a> = <a href="TpcwSchema.scala.html#51165" title="(CO_ID: Int)edu.berkeley.cs.scads.piql.tpcw.Country">Country</a><span class="delimiter">(</span><a href="#42606" title="Int">countryId</a><span class="delimiter">)</span>
    <a href="#44622" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21434" title="(x$1: String)Unit">CO_NAME</a> = <a href="#44621" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44426" title="()java.lang.String">getCo_name</a>
    <a href="#44622" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21437" title="(x$1: Double)Unit">CO_EXCHANGE</a> = <a href="#44621" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44428" title="()Double">getCo_exchange</a>
    <a href="#44622" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21440" title="(x$1: String)Unit">CO_CURRENCY</a> =  <a href="#44621" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44430" title="()java.lang.String">getCo_currency</a>
    <a href="#44622" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact" id="37179">createXacts</a><span class="delimiter">(</span><a title="Int" id="42595">orderId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#51145" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a> = <span class="delimiter">{</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(orderId, uuid())</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" id="44637">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCCXacts</span><span class="delimiter">(</span><a href="#42595" title="Int">orderId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" class="delimiter">[</span><a href="CCXactsTO.java.html#9158" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">CCXactsTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.CcXact" id="44638">xact</a> = <a href="TpcwSchema.scala.html#51145" title="(CX_O_ID: String)edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a><span class="delimiter">(</span><a href="#37174" title="(id: Int)String">toXact</a><span class="delimiter">(</span><a href="#42595" title="Int">orderId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21391" title="(x$1: String)Unit">CX_TYPE</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44459" title="()java.lang.String">getCx_type</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21394" title="(x$1: Int)Unit">CX_NUM</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44461" title="()Int">getCx_num</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21397" title="(x$1: String)Unit">CX_NAME</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44463" title="()java.lang.String">getCx_name</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21400" title="(x$1: Long)Unit">CX_EXPIRY</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44465" title="()Long">getCs_expiry</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21403" title="(x$1: String)Unit">CX_AUTH_ID</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44467" title="()java.lang.String">getCx_auth_id</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21406" title="(x$1: Double)Unit">CX_XACT_AMT</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44469" title="()Double">getCx_xact_amt</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21409" title="(x$1: Long)Unit">CX_XACT_DATE</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44471" title="()Long">getCx_xact_date</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21412" title="(x$1: Int)Unit">CX_CO_ID</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44473" title="()Int">getCx_co_id</a>
    <a href="#44638" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author" id="37180">createAuthor</a><span class="delimiter">(</span><a title="Int" id="42584">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#51161" title="edu.berkeley.cs.scads.piql.tpcw.Author">Author</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" id="44668">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAuthor</span><span class="delimiter">(</span><a href="#42584" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" class="delimiter">[</span><a href="AuthorTO.java.html#9154" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">AuthorTO</a><span class="delimiter">]</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Author" id="44669">author</a> = <a href="TpcwSchema.scala.html#51161" title="(A_ID: String)edu.berkeley.cs.scads.piql.tpcw.Author">Author</a><span class="delimiter">(</span><a href="#37170" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42584" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44669" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21357" title="(x$1: String)Unit">A_FNAME</a> = <a href="#37171" title="(authorId: String)String">toAuthorFname</a><span class="delimiter">(</span><a href="#37170" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42584" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44669" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21360" title="(x$1: String)Unit">A_LNAME</a> = <a href="#37172" title="(authorId: String)String">toAuthorLname</a><span class="delimiter">(</span><a href="#37170" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42584" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44669" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21363" title="(x$1: String)Unit">A_MNAME</a> = <a href="#44668" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44491" title="()java.lang.String">getA_mname</a>
    <a href="#44669" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21366" title="(x$1: Long)Unit">A_DOB</a> = <a href="#44668" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44495" title="()Long">getA_dob</a>
    <a href="#44669" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21369" title="(x$1: String)Unit">A_BIO</a> = <a href="#44668" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44497" title="()java.lang.String">getA_bio</a>

    <a href="#44669" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>

    <span class="comment">//var author = (AuthorKey(uuid()), AuthorValue(to.getA_fname, to.getA_lname, to.getA_mname, to.getA_dob, to.getA_bio))</span>
    <span class="comment">//authors += id -&gt;  author</span>
    <span class="comment">//author</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address" id="37181">createAddress</a><span class="delimiter">(</span><a title="Int" id="42573">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#51141" title="edu.berkeley.cs.scads.piql.tpcw.Address">Address</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" id="44690">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAddress</span><span class="delimiter">(</span><a href="#42573" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" class="delimiter">[</span><a href="AddressTO.java.html#9150" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">AddressTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = addressIds.getOrElseUpdate(id, uuid())</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Address" id="44691">address</a> = <a href="TpcwSchema.scala.html#51141" title="(ADDR_ID: String)edu.berkeley.cs.scads.piql.tpcw.Address">Address</a><span class="delimiter">(</span><a href="#37173" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#42573" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15926" title="(x$1: String)Unit">ADDR_STREET1</a> =  <a href="#44690" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44526" title="()java.lang.String">getAddr_street_1</a>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15929" title="(x$1: String)Unit">ADDR_STREET2</a> =  <a href="#44690" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44528" title="()java.lang.String">getAddr_street_2</a>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15932" title="(x$1: String)Unit">ADDR_CITY</a> =  <a href="#44690" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44530" title="()java.lang.String">getAddr_city</a>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15935" title="(x$1: String)Unit">ADDR_STATE</a> =  <a href="#44690" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44536" title="()java.lang.String">getAddr_state</a>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15938" title="(x$1: String)Unit">ADDR_ZIP</a> =  <a href="#44690" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44532" title="()java.lang.String">getAddr_zip</a>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15941" title="(x$1: Int)Unit">ADDR_CO_ID</a> =  <a href="#44690" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44534" title="()Int">getAddr_co_id</a>
    <a href="#44691" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer" id="37182">createCustomer</a><span class="delimiter">(</span><a title="Int" id="42617">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> :  <a href="TpcwSchema.scala.html#51157" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" id="44715">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int, x$2: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCustomer</span><span class="delimiter">(</span> <a href="#42617" title="Int">id</a> , <a href="#37139" title="=&gt; Int">numCustomers</a> <span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" class="delimiter">[</span><a href="CustomerTO.java.html#9166" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">CustomerTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="44716">customer</a> = <a href="TpcwSchema.scala.html#51157" title="(C_UNAME: String)edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a><span class="delimiter">(</span><a href="#37169" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44575" title="()Int">getC_id</a><span class="delimiter">)</span><span class="delimiter">)</span>   <span class="comment">//used naming convention instead of UUID</span>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21462" title="(x$1: String)Unit">C_PASSWD</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44579" title="()java.lang.String">getC_passwd</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21465" title="(x$1: String)Unit">C_FNAME</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44581" title="()java.lang.String">getC_fname</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21468" title="(x$1: String)Unit">C_LNAME</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44583" title="()java.lang.String">getC_lname</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21471" title="(x$1: String)Unit">C_ADDR_ID</a> = <a href="#37173" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44585" title="()Int">getC_addr_id</a><span class="delimiter">)</span>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21474" title="(x$1: String)Unit">C_PHONE</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44587" title="()Int">getC_phone</a>.<span title="()java.lang.String">toString</span>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21477" title="(x$1: String)Unit">C_EMAIL</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44589" title="()java.lang.String">getC_email</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21480" title="(x$1: Long)Unit">C_SINCE</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44591" title="()Long">getC_since</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21483" title="(x$1: Long)Unit">C_LAST_VISIT</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44593" title="()Long">getC_last_visit</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21486" title="(x$1: Long)Unit">C_LOGIN</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44595" title="()Long">getC_login</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21489" title="(x$1: Long)Unit">C_EXPIRATION</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44597" title="()Long">getC_expiration</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21492" title="(x$1: Double)Unit">C_DISCOUNT</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44599" title="()Double">getC_discount</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21495" title="(x$1: Double)Unit">C_BALANCE</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44601" title="()Double">getC_balance</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21498" title="(x$1: Double)Unit">C_YTD_PMT</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44603" title="()Double">getC_ytd_pmt</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21501" title="(x$1: Long)Unit">C_BIRTHDATE</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44605" title="()Long">getC_birthday</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21504" title="(x$1: String)Unit">C_DATA</a> = <a href="#44715" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44607" title="()java.lang.String">getC_data</a>
    <a href="#44716" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order" id="37183">createOrder</a><span class="delimiter">(</span><a title="Int" id="42657">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#51153" title="edu.berkeley.cs.scads.piql.tpcw.Order">Order</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" id="44770">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int, x$2: Int, x$3: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrder</span><span class="delimiter">(</span><a href="#42657" title="Int">id</a>, <a href="#37139" title="=&gt; Int">numCustomers</a>, <a href="#37149" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" class="delimiter">[</span><a href="OrderTO.java.html#9178" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">OrderTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(id, uuid())</span>
    <span class="comment">//customerOrderIndexInserts += Tuple2(CustomerOrderIndex(&quot;cust&quot; + to.getO_c_id, to.getO_date, idStr), NullRecord(true))</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Order" id="44771">order</a> = <a href="TpcwSchema.scala.html#51153" title="(O_ID: String)edu.berkeley.cs.scads.piql.tpcw.Order">Order</a><span class="delimiter">(</span><a href="#37176" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42657" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21643" title="(x$1: String)Unit">O_C_UNAME</a> = <a href="#37169" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44658" title="()Int">getO_c_id</a><span class="delimiter">)</span>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21646" title="(x$1: Long)Unit">O_DATE_Time</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44660" title="()Long">getO_date</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21649" title="(x$1: Double)Unit">O_SUB_TOTAL</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44662" title="()Double">getO_sub_total</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21652" title="(x$1: Double)Unit">O_TAX</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44664" title="()Double">getO_tax</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21655" title="(x$1: Double)Unit">O_TOTAL</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44666" title="()Double">getO_total</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21658" title="(x$1: String)Unit">O_SHIP_TYPE</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44668" title="()java.lang.String">getO_ship_type</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21661" title="(x$1: Long)Unit">O_SHIP_DATE</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44670" title="()Long">getO_ship_date</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21664" title="(x$1: String)Unit">O_BILL_ADDR_ID</a> = <a href="#37173" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44672" title="()Int">getO_bill_addr_id</a><span class="delimiter">)</span>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21667" title="(x$1: String)Unit">O_SHIP_ADDR_ID</a> = <a href="#37173" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44674" title="()Int">getO_ship_addr_id</a><span class="delimiter">)</span>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21670" title="(x$1: String)Unit">O_STATUS</a> = <a href="#44770" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44676" title="()java.lang.String">getO_status</a>
    <a href="#44771" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>
  <span class="delimiter">}</span>

<span class="comment">//  def createCustomerOrderIndex(order: (OrdersKey, OrdersValue)) : (CustomerOrderIndex, NullRecord) = {</span>
<span class="comment">//    (CustomerOrderIndex(order._2.O_C_ID, order._2.O_DATE_Time, order._1.O_ID), NullRecord(true))</span>
<span class="comment">//  }</span>


  <span class="keyword">def</span> <a title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]" id="37184">createOrderline</a><span class="delimiter">(</span><a title="Int" id="42646">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">Seq</span><span class="delimiter">[</span>OrderLine<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]" id="44813">orders</a> : <span title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">Seq</span><span class="delimiter">[</span>OrderLineTO<span class="delimiter">]</span> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37149" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]])Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,scala.collection.immutable.IndexedSeq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]]" class="delimiter">(</span> <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<span title="(x$1: Int, x$2: Int, x$3: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrderLine</span><span class="delimiter">(</span><a href="#42646" title="Int">id</a>,<a href="#44943" title="Int">_</a>, <a href="#37472" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" class="delimiter">[</span><a href="OrderLineTO.java.html#9174" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">OrderLineTO</a><span class="delimiter">]</span><span class="delimiter">)</span>

    <span class="keyword">for</span><span class="delimiter">(</span> <span class="delimiter">(</span><a title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" id="45047">order</a>, <a title="Int" id="45048">idx</a><span class="delimiter">)</span> &lt;- <a href="#44813" title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">orders</a>.<a href="#45015" title="(f: (ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int) =&gt; edu.berkeley.cs.scads.piql.tpcw.OrderLine)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int)],edu.berkeley.cs.scads.piql.tpcw.OrderLine,Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]])Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">zipWithIndex</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.OrderLine" id="45049">orderline</a> = <a href="TpcwSchema.scala.html#51149" title="(OL_O_ID: String, OL_ID: Int)edu.berkeley.cs.scads.piql.tpcw.OrderLine">OrderLine</a><span class="delimiter">(</span><a href="#37176" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42646" title="Int">id</a><span class="delimiter">)</span>, <a href="#45048" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="#45049" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21612" title="(x$1: String)Unit">OL_I_ID</a> = <a href="#37175" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#45047" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44806" title="()Int">getOl_i_id</a><span class="delimiter">)</span>
      <a href="#45049" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21615" title="(x$1: Int)Unit">OL_QTY</a> = <a href="#45047" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44808" title="()Int">getOl_qty</a>
      <a href="#45049" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21618" title="(x$1: Double)Unit">OL_DISCOUNT</a> = <a href="#45047" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44810" title="()Double">getOl_discount</a>
      <a href="#45049" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21621" title="(x$1: String)Unit">OL_COMMENT</a> =   <a href="#45047" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44812" title="()java.lang.String">getOl_comments</a>
      <a href="#45049" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>