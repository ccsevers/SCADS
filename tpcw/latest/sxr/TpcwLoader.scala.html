<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TpcwLoader.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> tpcw

<span class="keyword">import</span> net.lag.logging._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.storage._
<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.piql.<span title="object edu.berkeley.cs.scads.piql.DataGenerator">DataGenerator</span>._
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.Generator
<span class="keyword">import</span> java.util.UUID
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.objects._
<span class="keyword">import</span> collection.mutable.<span class="delimiter">{</span>ArrayBuffer, HashMap<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.generic.IndexedRecord
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._
<span class="keyword">import</span> org.apache.avro.util.Utf8


<span class="keyword">class</span> <a title="class TpcwLoader extends java.lang.Object with ScalaObject" id="10172">TpcwLoader</a><a href="#10172" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Double" id="36984">numEBs</a> : <span title="Double">Double</span>,
                 <span class="keyword">val</span> <a title="Int" id="36985">numItems</a> : <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="36648">logger</a> = <span title="()net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#36984" title="=&gt; Double">numEBs</a> <span title="(x: Double)Boolean">&gt;</span> <span title="Double(0.0)" class="double">0.0</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#36985" title="=&gt; Int">numItems</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="comment">/**
   * See clause 4.2.2 - items MUST be chosen from the following set
   */</span>
  <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Int]" id="36650">ValidItemCardinalities</a> = <span title="(elems: Int*)scala.collection.immutable.Set[Int]">Set</span><span class="delimiter">(</span><span title="Int(1000)" class="int">1000</span>, <span title="Int(10000)" class="int">10000</span>, <span title="Int(100000)" class="int">100000</span>, <span title="Int(1000000)" class="int">1000000</span>, <span title="Int(10000000)" class="int">10000000</span><span class="delimiter">)</span>

  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#36650" title="=&gt; scala.collection.immutable.Set[Int]">ValidItemCardinalities</a>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#36985" title="=&gt; Int">numItems</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#36648" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;)" class="string">&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;</span>, <a href="#36985" title="=&gt; Int">numItems</a><span class="delimiter">)</span>

  <span class="comment">/** Cardinalities defined by clause 4.3 */</span>
  <span class="keyword">val</span> <a title="Int" id="36652">numCustomers</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><a href="#36984" title="=&gt; Double">numEBs</a> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <span title="Int(2880)" class="int">2880</span><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36654">numAddresses</a> : <span title="Int">Int</span> = <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#36652" title="=&gt; Int">numCustomers</a>
  <span class="keyword">val</span> <a title="Int" id="36656">numAuthors</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.25)" class="double">.25</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#36985" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36658">numOrders</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.9)" class="double">.9</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#36652" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36660">numCountries</a> : <span title="Int">Int</span> = <span title="Int(92)" class="int">92</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="scala.util.Random" id="36662">rand</a> = <span title="()scala.util.Random" class="keyword">new</span> scala.util.<span title="scala.util.Random">Random</span>

  <span class="keyword">trait</span> <a title="trait NamespaceData extends java.lang.Object with ScalaObject" id="36664">NamespaceData</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="37274">Pair</a> &lt;: AvroPair
    <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]" id="37275">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">PairNamespace</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Seq[NamespaceData.this.Pair]" id="37276">sampleData</a>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]" id="37277">dataSlice</a><span class="delimiter">(</span><a title="Int" id="37285">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37286">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(replicationFactor: Int)Unit" id="37278">repartition</a><span class="delimiter">(</span><a title="Int" id="37288">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37275" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a>.<span title="(data: Seq[NamespaceData.this.Pair], replicationFactor: Int)Unit">repartition</span><span class="delimiter">(</span><a href="#37276" title="=&gt; Seq[NamespaceData.this.Pair]">sampleData</a>, <a href="#37288" title="Int">replicationFactor</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(clientId: Int, numLoaders: Int)Unit" id="37279">load</a><span class="delimiter">(</span><a title="Int" id="37297">clientId</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>, <a title="Int" id="37298">numLoaders</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37275" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a> <span title="(that: TraversableOnce[NamespaceData.this.Pair])Unit">++=</span>  <a href="#37277" title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]">dataSlice</a><span class="delimiter">(</span><a href="#37297" title="Int">clientId</a>, <a href="#37298" title="Int">numLoaders</a><span class="delimiter">)</span>

        <span class="comment">/** assuming [1, upperBound], returns the slice of data for this clientId */</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]" id="37280">getSlice</a><span class="delimiter">(</span><a title="Int" id="37302">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37303">numClients</a>: <span title="Int">Int</span>, <a title="Int" id="37304">upperBound</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37304" title="Int">upperBound</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="37307">numPerClient</a> = <a href="#37304" title="Int">upperBound</a> <span title="(x: Int)Int">/</span> <a href="#37303" title="Int">numClients</a>
      <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37307" title="Int">numPerClient</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// this is the case where there are more clients than elements to slice</span>
        <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37302" title="Int">clientId</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#37304" title="Int">upperBound</a><span class="delimiter">)</span> <span title="object Seq">Seq</span>.<span title="Seq[Nothing]">empty</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#37302" title="Int">clientId</a> <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">+</span> <span title="Int(1)" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37302" title="Int">clientId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="39642">start</a> = <a href="#37302" title="Int">clientId</a> <span title="(x: Int)Int">*</span> <a href="#37307" title="Int">numPerClient</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span title="scala.collection.immutable.Range" class="keyword">if</span> <span class="delimiter">(</span><a href="#37302" title="Int">clientId</a> <span title="(x: Int)Boolean">==</span> <a href="#37303" title="Int">numClients</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#39642" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37304" title="Int">upperBound</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#39642" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range">until</span> <span class="delimiter">(</span><a href="#39642" title="Int">start</a> <span title="(x: Int)Int">+</span> <a href="#37307" title="Int">numPerClient</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait NoLoad extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject" id="36665">NoLoad</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#36664" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)scala.collection.immutable.Nil.type" id="39764">dataSlice</a><span class="delimiter">(</span><a title="Int" id="39767">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="39768">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class RandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="41594">RandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="41596">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#41594" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42051">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; A" id="42052">generator</a>: Int =&gt; A, <a title="Int" id="42053">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#36664" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="39781">Pair</a> = <a href="#41596" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[RandomData.this.Pair]" id="39782">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42053" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42052" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[RandomData.this.Pair]" id="39783">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41353">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41354">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37280" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41353" title="Int">clientId</a>, <a href="#41354" title="Int">numClients</a>, <a href="#42053" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42052" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class FlattenedRandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="41985">FlattenedRandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="41987">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#41985" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42124">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; Seq[A]" id="42125">generator</a>: Int =&gt; Seq<span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int" id="42126">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#36664" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="41713">Pair</a> = <a href="#41987" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[FlattenedRandomData.this.Pair]" id="41714">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42126" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42125" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[FlattenedRandomData.this.Pair]" id="41715">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41884">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41885">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37280" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41884" title="Int">clientId</a>, <a href="#41885" title="Int">numClients</a>, <a href="#42126" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42125" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">//TODO: Partition shopping cart</span>
  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]" id="36674">namespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42044">client</a>: <a href="TpcwClient.scala.html#10156" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a><span class="delimiter">)</span>: <span title="Seq[TpcwLoader.this.NamespaceData]">Seq</span><span class="delimiter">[</span>NamespaceData<span class="delimiter">]</span> =
    <span title="[A](xs: A*)List[A]">List</span><span title="(xs: TpcwLoader.this.NamespaceData*)List[TpcwLoader.this.NamespaceData]" class="delimiter">[</span><a href="#36664" title="TpcwLoader.this.NamespaceData">NamespaceData</a><span class="delimiter">]</span><span class="delimiter">(</span>
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Address, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Address]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14655" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address]">addresses</a>, <a href="#36694" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address">createAddress</a><span class="delimiter">(</span><a href="#42063" title="Int">_</a><span class="delimiter">)</span>, <a href="#36652" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Author, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Author]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14657" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author]">authors</a>, <a href="#36693" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author">createAuthor</a><span class="delimiter">(</span><a href="#42074" title="Int">_</a><span class="delimiter">)</span>, <a href="#36656" title="=&gt; Int">numAuthors</a><span class="delimiter">)</span>,
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.CcXact, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.CcXact]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14659" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact]">xacts</a>, <a href="#36692" title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact">createXacts</a><span class="delimiter">(</span><a href="#42085" title="Int">_</a><span class="delimiter">)</span>, <a href="#36658" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Country, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Country]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14661" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country]">countries</a>, <a href="#36691" title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country">createCountry</a><span class="delimiter">(</span><a href="#42096" title="Int">_</a><span class="delimiter">)</span>, <a href="#36660" title="=&gt; Int">numCountries</a><span class="delimiter">)</span>,
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Customer, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Customer]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14663" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer]">customers</a>, <a href="#36695" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer">createCustomer</a><span class="delimiter">(</span><a href="#42107" title="Int">_</a><span class="delimiter">)</span>, <a href="#36652" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Item, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Item]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14665" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item]">items</a>, <a href="#36690" title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item">createItem</a><span class="delimiter">(</span><a href="#42118" title="Int">_</a><span class="delimiter">)</span>, <a href="#36985" title="=&gt; Int">numItems</a><span class="delimiter">)</span>,
      <a href="#41985" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine], generator: Int =&gt; Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine], numRecords: Int)TpcwLoader.this.FlattenedRandomData[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">FlattenedRandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14667" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">orderLines</a>, <a href="#36697" title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">createOrderline</a><span class="delimiter">(</span><a href="#42136" title="Int">_</a><span class="delimiter">)</span>, <a href="#36658" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#41594" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Order, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Order]">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14669" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order]">orders</a>, <a href="#36696" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order">createOrder</a><span class="delimiter">(</span><a href="#42147" title="Int">_</a><span class="delimiter">)</span>, <a href="#36658" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#42153" title="TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" class="keyword">new</a> <a title="anonymous class $anon extends TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" id="42153">RandomData</a><span class="delimiter">(</span><a href="#42044" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14671" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem]">shoppingCartItems</a>, <a title="Int" id="42198">i</a> =&gt; <a href="TpcwSchema.scala.html#34945" title="(SCL_C_UNAME: String, SCL_I_ID: String)edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem">ShoppingCartItem</a><span class="delimiter">(</span><a href="#36682" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#42198" title="Int">i</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#36652" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#36665" title="TpcwLoader.this.NoLoad">NoLoad</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient, replicationFactor: Int)Unit" id="36675">createNamespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42199">client</a>: <a href="TpcwClient.scala.html#10156" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a>, <a title="Int" id="42200">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36674" title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]">namespaces</a><span class="delimiter">(</span><a href="#42199" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a><span class="delimiter">)</span>.<span title="(f: TpcwLoader.this.NamespaceData =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#42237" title="TpcwLoader.this.NamespaceData">_</a>.<a href="#37278" title="(replicationFactor: Int)Unit">repartition</a><span class="delimiter">(</span><a href="#42200" title="Int">replicationFactor</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()String" id="36676">uuid</a><span class="delimiter">(</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="()java.util.UUID">randomUUID</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)String" id="36677">nameUuid</a><span class="delimiter">(</span><a title="String" id="42172">s</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="(x$1: Array[Byte])java.util.UUID">nameUUIDFromBytes</span><span class="delimiter">(</span><a href="#42172" title="String">s</a>.<span title="(x$1: java.lang.String)Array[Byte]">getBytes</span><span class="delimiter">(</span><span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>

  <span class="comment">/**
   * Given a cluster size, create the hex splits, sorted in string lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)Seq[Option[String]]" id="36678">hexSplit</a><span class="delimiter">(</span><a title="Int" id="42293">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[Option[String]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="42295">size</a> = <span title="Int(16)" class="int">16</span>
    <span class="keyword">var</span> <a title="Int" id="42296">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#42295" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#42293" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#42298" title="()Unit" class="delimiter">{</a>
      <a href="#42295" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>
      <a href="#42296" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#42295" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>; <a href="#42296" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>
    <span class="keyword">val</span> <a title="Double" id="42297">numPerNode</a> = <a href="#42295" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#42293" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#42297" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#42333" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],Seq[Option[String]]])Seq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#42293" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="42477">i</a> =&gt; <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%0&quot;)" class="string">&quot;%0&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#42296" title="Int">levels</a> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span> <span title="java.lang.String(&quot;x&quot;)" class="string">&quot;x&quot;</span><span class="delimiter">)</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#42477" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#42297" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#42851" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create 8-bit ASCII split, sorted in string
   * lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="36679">utf8Split</a><span class="delimiter">(</span><a title="Int" id="42977">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="42980">size</a> = <span title="Int(256)" class="int">256</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#42980" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#42977" title="Int">clusterSize</a><span class="delimiter">)</span>
      <a href="#42980" title="Int">size</a> = <a href="#42980" title="Int">size</a> <span title="(x: Int)Int">*</span> <span title="Int(256)" class="int">256</span>

    <span class="keyword">val</span> <a title="Int" id="42981">numPerNode</a> = <a href="#42980" title="Int">size</a> <span title="(x: Int)Int">/</span> <a href="#42977" title="Int">clusterSize</a>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#42981" title="Int">numPerNode</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

    <span class="comment">// encodes i as a base 256 string. not super efficient</span>
    <span class="keyword">def</span> <a title="(i: Int)String" id="42982">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43002">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#43002" title="Int">i</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String(&quot;&quot;)" class="int">0</span> =&gt; <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="keyword">case</span> <span title="java.lang.String">_</span> =&gt; <a href="#42982" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43002" title="Int">i</a> <span title="(x: Int)Int">/</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#43002" title="Int">i</a> <span title="(x: Int)Int">%</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>
    <span class="delimiter">}</span>

    <span title="object None">None</span> <a href="#43011" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#42977" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43111">i</a> =&gt; <span class="delimiter">(</span><a href="#42982" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43111" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#42981" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43221" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create splits over printable chars, defined as
   * ASCII [33-126]
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="36680">printableCharSplit</a><span class="delimiter">(</span><a title="Int" id="43319">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#43323" title="(Int, Int)" class="delimiter">(</a><a href="#43322" title="Int" id="43323">low</a>, <a href="#43322" title="Int" id="43324">high</a><span class="delimiter">)</span> = <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="Int(33)" class="int">33</span>, <span title="Int(126)" class="int">126</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43325">numChars</a> = <a href="#43324" title="Int">high</a> <span title="(x: Int)Int">-</span> <a href="#43323" title="Int">low</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">var</span> <a title="Int" id="43326">size</a> = <a href="#43325" title="Int">numChars</a>
    <span class="keyword">var</span> <a title="Int" id="43327">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43326" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43319" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#43331" title="()Unit" class="delimiter">{</a>
      <a href="#43326" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43325" title="Int">numChars</a>
      <a href="#43327" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#43326" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43325" title="Int">numChars</a>; <a href="#43327" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>

    <span class="keyword">def</span> <a title="(i: Int)String" id="43328">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43377">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> =
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#43377" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43325" title="Int">numChars</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#43377" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#43323" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>
      <span class="keyword">else</span> <a href="#43328" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43377" title="Int">i</a> <span title="(x: Int)Int">/</span> <a href="#43325" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#43377" title="Int">i</a> <span title="(x: Int)Int">%</span> <a href="#43325" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <a href="#43323" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>

    <span class="keyword">def</span> <a title="(str: String, ch: Char, level: Int)String" id="43329">pad</a><span class="delimiter">(</span><a title="String" id="43398">str</a>: <span title="String">String</span>, <a title="Char" id="43399">ch</a>: <span title="Char">Char</span>, <a title="Int" id="43400">level</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="String" id="43401">s</a> = <a href="#43398" title="String">str</a>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43401" title="String">s</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#43400" title="Int">level</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#43401" title="String">s</a> = <a href="#43399" title="Char">ch</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#43401" title="String">s</a>
      <span class="delimiter">}</span>
      <a href="#43401" title="String">s</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Double" id="43330">numPerNode</a> = <a href="#43326" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#43319" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#43330" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#43418" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43319" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43518">i</a> =&gt; <a href="#43329" title="(str: String, ch: Char, level: Int)String">pad</a><span class="delimiter">(</span><a href="#43328" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#43518" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#43330" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>, <a href="#43323" title="Int">low</a>.<span title="=&gt; Char">toChar</span>, <a href="#43327" title="Int">levels</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43628" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Splits a given range [0, rangeSplit) between clusterSize. if
   * clusterSize exceeds the given range, then clusterSize - givenRange
   * elements are dropped
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(end: Int, clusterSize: Int)Seq[Option[Int]]" id="36681">rangeSplit</a><span class="delimiter">(</span><a title="Int" id="43726">end</a>: <span title="Int">Int</span>, <a title="Int" id="43727">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[Option[Int]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="43729">realSize</a> = <a href="#43727" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> scala.math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#43727" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> <a href="#43726" title="Int">end</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43730">numPerNode</a> = <a href="#43726" title="Int">end</a> <span title="(x: Int)Int">/</span> <a href="#43729" title="Int">realSize</a>
    <span title="object None">None</span> <a href="#43751" title="(elem: Option[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[Int]],Option[Int],Seq[Option[Int]]])Seq[Option[Int]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43729" title="Int">realSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; Some[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]])scala.collection.immutable.IndexedSeq[Some[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]]" class="delimiter">(</span><a title="Int" id="43851">i</a> =&gt; <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#43851" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#43730" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36682">toCustomer</a><span class="delimiter">(</span><a title="Int" id="42169">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;cust%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#42169" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36683">toAuthor</a><span class="delimiter">(</span><a title="Int" id="43981">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43981" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author FNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="36684">toAuthorFname</a><span class="delimiter">(</span><a title="String" id="43987">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_fname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43987" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author LNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="36685">toAuthorLname</a><span class="delimiter">(</span><a title="String" id="43993">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_lname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43993" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36686">toAddress</a><span class="delimiter">(</span><a title="Int" id="43999">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;address%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43999" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36687">toXact</a><span class="delimiter">(</span><a title="Int" id="44005">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;xact%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44005" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36688">toItem</a><span class="delimiter">(</span><a title="Int" id="44011">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;item%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44011" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36689">toOrder</a><span class="delimiter">(</span><a title="Int" id="44017">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36677" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;order%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44017" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item" id="36690">createItem</a><span class="delimiter">(</span><a title="Int" id="42119">itemId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10214" title="edu.berkeley.cs.scads.piql.tpcw.Item">Item</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" id="44023">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44030" title="(i: Int, numItems: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateItem</a><span class="delimiter">(</span><a href="#42119" title="Int">itemId</a>, <a href="#36985" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" class="delimiter">[</span><a href="ItemTO.java.html#9170" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">ItemTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = itemIds.getOrElseUpdate(itemId, uuid())</span>
    <span class="comment">//itemSubjectDateTitleIndexInserts += Tuple2(</span>
    <span class="comment">//  ItemSubjectDateTitleIndexKey(to.getI_subject,</span>
    <span class="comment">//    to.getI_pub_date,</span>
    <span class="comment">//    to.getI_title),</span>
    <span class="comment">//  ItemKey(idStr))</span>
    <span class="comment">//val author =  authors.get(to.getI_a_id)</span>

    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_FNAME, to.getI_title, idStr), NullRecord(true))</span>
    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_LNAME, to.getI_title, idStr), NullRecord(true))</span>

    <span class="comment">//val tokens = to.getI_title.split(&quot;\\s+&quot;);</span>

    <span class="comment">//itemTitleIndexInserts ++= tokens.map(x =&gt; (ItemTitleIndexKey(x.toLowerCase, to.getI_title ,idStr), NullRecord(true)))</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Item" id="44024">item</a> = <a href="TpcwSchema.scala.html#35754" title="(I_ID: String)edu.berkeley.cs.scads.piql.tpcw.Item">Item</a><span class="delimiter">(</span><a href="#36688" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#42119" title="Int">itemId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21488" title="(x$1: String)Unit">I_TITLE</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44063" title="()java.lang.String">getI_title</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21491" title="(x$1: String)Unit">I_A_ID</a> = <a href="#36683" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44065" title="()Int">getI_a_id</a><span class="delimiter">)</span>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21494" title="(x$1: Long)Unit">I_PUB_DATE</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44067" title="()Long">getI_pub_date</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21497" title="(x$1: String)Unit">I_PUBLISHER</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44069" title="()java.lang.String">getI_publisher</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21500" title="(x$1: String)Unit">I_SUBJECT</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44071" title="()java.lang.String">getI_subject</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21503" title="(x$1: String)Unit">I_DESC</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44073" title="()java.lang.String">getI_desc</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21506" title="(x$1: Int)Unit">I_RELATED1</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44075" title="()Int">getI_related1</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21509" title="(x$1: Int)Unit">I_RELATED2</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44077" title="()Int">getI_related2</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21512" title="(x$1: Int)Unit">I_RELATED3</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44079" title="()Int">getI_related3</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21515" title="(x$1: Int)Unit">I_RELATED4</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44081" title="()Int">getI_related4</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21518" title="(x$1: Int)Unit">I_RELATED5</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44083" title="()Int">getI_related5</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21521" title="(x$1: String)Unit">I_THUMBNAIL</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44085" title="()java.lang.String">getI_thumbnail</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21524" title="(x$1: String)Unit">I_IMAGE</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44087" title="()java.lang.String">getI_image</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21527" title="(x$1: Double)Unit">I_SRP</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44089" title="()Double">getI_srp</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21530" title="(x$1: Double)Unit">I_COST</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44091" title="()Double">getI_cost</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21533" title="(x$1: Long)Unit">I_AVAIL</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44093" title="()Long">getI_avail</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21536" title="(x$1: Int)Unit">I_STOCK</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44095" title="()Int">getI_stock</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21539" title="(x$1: String)Unit">ISBN</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44097" title="()java.lang.String">getI_isbn</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21542" title="(x$1: Int)Unit">I_PAGE</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44099" title="()Int">getI_page</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21545" title="(x$1: String)Unit">I_BACKING</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44101" title="()java.lang.String">getI_backing</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21548" title="(x$1: String)Unit">I_DIMENSION</a> = <a href="#44023" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44103" title="()java.lang.String">getI_dimensions</a>
    <a href="#44024" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country" id="36691">createCountry</a><span class="delimiter">(</span><a title="Int" id="42097">countryId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10217" title="edu.berkeley.cs.scads.piql.tpcw.Country">Country</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" id="44129">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44029" title="(i: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCountry</a><span class="delimiter">(</span><a href="#42097" title="Int">countryId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" class="delimiter">[</span><a href="CountryTO.java.html#9162" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">CountryTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Country" id="44130">country</a> = <a href="TpcwSchema.scala.html#44148" title="(CO_ID: Int)edu.berkeley.cs.scads.piql.tpcw.Country">Country</a><span class="delimiter">(</span><a href="#42097" title="Int">countryId</a><span class="delimiter">)</span>
    <a href="#44130" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21396" title="(x$1: String)Unit">CO_NAME</a> = <a href="#44129" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44140" title="()java.lang.String">getCo_name</a>
    <a href="#44130" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21399" title="(x$1: Double)Unit">CO_EXCHANGE</a> = <a href="#44129" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44142" title="()Double">getCo_exchange</a>
    <a href="#44130" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21402" title="(x$1: String)Unit">CO_CURRENCY</a> =  <a href="#44129" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44144" title="()java.lang.String">getCo_currency</a>
    <a href="#44130" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact" id="36692">createXacts</a><span class="delimiter">(</span><a title="Int" id="42086">orderId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10232" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a> = <span class="delimiter">{</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(orderId, uuid())</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" id="44157">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44033" title="(i: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCCXacts</a><span class="delimiter">(</span><a href="#42086" title="Int">orderId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" class="delimiter">[</span><a href="CCXactsTO.java.html#9158" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">CCXactsTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.CcXact" id="44158">xact</a> = <a href="TpcwSchema.scala.html#36410" title="(CX_O_ID: String)edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a><span class="delimiter">(</span><a href="#36687" title="(id: Int)String">toXact</a><span class="delimiter">(</span><a href="#42086" title="Int">orderId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21353" title="(x$1: String)Unit">CX_TYPE</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44173" title="()java.lang.String">getCx_type</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21356" title="(x$1: Int)Unit">CX_NUM</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44175" title="()Int">getCx_num</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21359" title="(x$1: String)Unit">CX_NAME</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44177" title="()java.lang.String">getCx_name</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21362" title="(x$1: Long)Unit">CX_EXPIRY</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44179" title="()Long">getCs_expiry</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21365" title="(x$1: String)Unit">CX_AUTH_ID</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44181" title="()java.lang.String">getCx_auth_id</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21368" title="(x$1: Double)Unit">CX_XACT_AMT</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44183" title="()Double">getCx_xact_amt</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21371" title="(x$1: Long)Unit">CX_XACT_DATE</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44185" title="()Long">getCx_xact_date</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21374" title="(x$1: Int)Unit">CX_CO_ID</a> = <a href="#44157" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44187" title="()Int">getCx_co_id</a>
    <a href="#44158" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author" id="36693">createAuthor</a><span class="delimiter">(</span><a title="Int" id="42075">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10220" title="edu.berkeley.cs.scads.piql.tpcw.Author">Author</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" id="44190">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44027" title="(aId: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAuthor</a><span class="delimiter">(</span><a href="#42075" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" class="delimiter">[</span><a href="AuthorTO.java.html#9154" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">AuthorTO</a><span class="delimiter">]</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Author" id="44191">author</a> = <a href="TpcwSchema.scala.html#44215" title="(A_ID: String)edu.berkeley.cs.scads.piql.tpcw.Author">Author</a><span class="delimiter">(</span><a href="#36683" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42075" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44191" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21319" title="(x$1: String)Unit">A_FNAME</a> = <a href="#36684" title="(authorId: String)String">toAuthorFname</a><span class="delimiter">(</span><a href="#36683" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42075" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44191" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21322" title="(x$1: String)Unit">A_LNAME</a> = <a href="#36685" title="(authorId: String)String">toAuthorLname</a><span class="delimiter">(</span><a href="#36683" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42075" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44191" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21325" title="(x$1: String)Unit">A_MNAME</a> = <a href="#44190" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44205" title="()java.lang.String">getA_mname</a>
    <a href="#44191" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21328" title="(x$1: Long)Unit">A_DOB</a> = <a href="#44190" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44209" title="()Long">getA_dob</a>
    <a href="#44191" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21331" title="(x$1: String)Unit">A_BIO</a> = <a href="#44190" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44211" title="()java.lang.String">getA_bio</a>

    <a href="#44191" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>

    <span class="comment">//var author = (AuthorKey(uuid()), AuthorValue(to.getA_fname, to.getA_lname, to.getA_mname, to.getA_dob, to.getA_bio))</span>
    <span class="comment">//authors += id -&gt;  author</span>
    <span class="comment">//author</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address" id="36694">createAddress</a><span class="delimiter">(</span><a title="Int" id="42064">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10235" title="edu.berkeley.cs.scads.piql.tpcw.Address">Address</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" id="44226">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44026" title="(addrId: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAddress</a><span class="delimiter">(</span><a href="#42064" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" class="delimiter">[</span><a href="AddressTO.java.html#9150" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">AddressTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = addressIds.getOrElseUpdate(id, uuid())</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Address" id="44227">address</a> = <a href="TpcwSchema.scala.html#44254" title="(ADDR_ID: String)edu.berkeley.cs.scads.piql.tpcw.Address">Address</a><span class="delimiter">(</span><a href="#36686" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#42064" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17226" title="(x$1: String)Unit">ADDR_STREET1</a> =  <a href="#44226" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44240" title="()java.lang.String">getAddr_street_1</a>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17229" title="(x$1: String)Unit">ADDR_STREET2</a> =  <a href="#44226" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44242" title="()java.lang.String">getAddr_street_2</a>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17232" title="(x$1: String)Unit">ADDR_CITY</a> =  <a href="#44226" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44244" title="()java.lang.String">getAddr_city</a>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17235" title="(x$1: String)Unit">ADDR_STATE</a> =  <a href="#44226" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44250" title="()java.lang.String">getAddr_state</a>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17238" title="(x$1: String)Unit">ADDR_ZIP</a> =  <a href="#44226" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44246" title="()java.lang.String">getAddr_zip</a>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17241" title="(x$1: Int)Unit">ADDR_CO_ID</a> =  <a href="#44226" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44248" title="()Int">getAddr_co_id</a>
    <a href="#44227" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer" id="36695">createCustomer</a><span class="delimiter">(</span><a title="Int" id="42108">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> :  <a href="TpcwSchema.scala.html#10223" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" id="44266">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44028" title="(i: Int, numCustomers: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCustomer</a><span class="delimiter">(</span> <a href="#42108" title="Int">id</a> , <a href="#36652" title="=&gt; Int">numCustomers</a> <span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" class="delimiter">[</span><a href="CustomerTO.java.html#9166" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">CustomerTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="44267">customer</a> = <a href="TpcwSchema.scala.html#44325" title="(C_UNAME: String)edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a><span class="delimiter">(</span><a href="#36682" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44289" title="()Int">getC_id</a><span class="delimiter">)</span><span class="delimiter">)</span>   <span class="comment">//used naming convention instead of UUID</span>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21424" title="(x$1: String)Unit">C_PASSWD</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44293" title="()java.lang.String">getC_passwd</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21427" title="(x$1: String)Unit">C_FNAME</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44295" title="()java.lang.String">getC_fname</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21430" title="(x$1: String)Unit">C_LNAME</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44297" title="()java.lang.String">getC_lname</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21433" title="(x$1: String)Unit">C_ADDR_ID</a> = <a href="#36686" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44299" title="()Int">getC_addr_id</a><span class="delimiter">)</span>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21436" title="(x$1: String)Unit">C_PHONE</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44301" title="()Int">getC_phone</a>.<span title="()java.lang.String">toString</span>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21439" title="(x$1: String)Unit">C_EMAIL</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44303" title="()java.lang.String">getC_email</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21442" title="(x$1: Long)Unit">C_SINCE</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44305" title="()Long">getC_since</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21445" title="(x$1: Long)Unit">C_LAST_VISIT</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44307" title="()Long">getC_last_visit</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21448" title="(x$1: Long)Unit">C_LOGIN</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44309" title="()Long">getC_login</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21451" title="(x$1: Long)Unit">C_EXPIRATION</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44311" title="()Long">getC_expiration</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21454" title="(x$1: Double)Unit">C_DISCOUNT</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44313" title="()Double">getC_discount</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21457" title="(x$1: Double)Unit">C_BALANCE</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44315" title="()Double">getC_balance</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21460" title="(x$1: Double)Unit">C_YTD_PMT</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44317" title="()Double">getC_ytd_pmt</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21463" title="(x$1: Long)Unit">C_BIRTHDATE</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44319" title="()Long">getC_birthday</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21466" title="(x$1: String)Unit">C_DATA</a> = <a href="#44266" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44321" title="()java.lang.String">getC_data</a>
    <a href="#44267" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order" id="36696">createOrder</a><span class="delimiter">(</span><a title="Int" id="42148">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10226" title="edu.berkeley.cs.scads.piql.tpcw.Order">Order</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" id="44346">to</a> = <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44031" title="(i: Int, numCustomers: Int, numItemLines: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrder</a><span class="delimiter">(</span><a href="#42148" title="Int">id</a>, <a href="#36652" title="=&gt; Int">numCustomers</a>, <a href="#36662" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" class="delimiter">[</span><a href="OrderTO.java.html#9178" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">OrderTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(id, uuid())</span>
    <span class="comment">//customerOrderIndexInserts += Tuple2(CustomerOrderIndex(&quot;cust&quot; + to.getO_c_id, to.getO_date, idStr), NullRecord(true))</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Order" id="44347">order</a> = <a href="TpcwSchema.scala.html#35894" title="(O_ID: String)edu.berkeley.cs.scads.piql.tpcw.Order">Order</a><span class="delimiter">(</span><a href="#36689" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42148" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21605" title="(x$1: String)Unit">O_C_UNAME</a> = <a href="#36682" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44372" title="()Int">getO_c_id</a><span class="delimiter">)</span>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21608" title="(x$1: Long)Unit">O_DATE_Time</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44374" title="()Long">getO_date</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21611" title="(x$1: Double)Unit">O_SUB_TOTAL</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44376" title="()Double">getO_sub_total</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21614" title="(x$1: Double)Unit">O_TAX</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44378" title="()Double">getO_tax</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21617" title="(x$1: Double)Unit">O_TOTAL</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44380" title="()Double">getO_total</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21620" title="(x$1: String)Unit">O_SHIP_TYPE</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44382" title="()java.lang.String">getO_ship_type</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21623" title="(x$1: Long)Unit">O_SHIP_DATE</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44384" title="()Long">getO_ship_date</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21626" title="(x$1: String)Unit">O_BILL_ADDR_ID</a> = <a href="#36686" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44386" title="()Int">getO_bill_addr_id</a><span class="delimiter">)</span>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21629" title="(x$1: String)Unit">O_SHIP_ADDR_ID</a> = <a href="#36686" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44388" title="()Int">getO_ship_addr_id</a><span class="delimiter">)</span>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21632" title="(x$1: String)Unit">O_STATUS</a> = <a href="#44346" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44390" title="()java.lang.String">getO_status</a>
    <a href="#44347" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>
  <span class="delimiter">}</span>

<span class="comment">//  def createCustomerOrderIndex(order: (OrdersKey, OrdersValue)) : (CustomerOrderIndex, NullRecord) = {</span>
<span class="comment">//    (CustomerOrderIndex(order._2.O_C_ID, order._2.O_DATE_Time, order._1.O_ID), NullRecord(true))</span>
<span class="comment">//  }</span>


  <span class="keyword">def</span> <a title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]" id="36697">createOrderline</a><span class="delimiter">(</span><a title="Int" id="42137">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">Seq</span><span class="delimiter">[</span>OrderLine<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]" id="44393">orders</a> : <span title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">Seq</span><span class="delimiter">[</span>OrderLineTO<span class="delimiter">]</span> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#36662" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]])Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,scala.collection.immutable.IndexedSeq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]]" class="delimiter">(</span> <a href="Generator.java.html#9132" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44032" title="(orderLineId: Int, orderId: Int, numItems: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrderLine</a><span class="delimiter">(</span><a href="#42137" title="Int">id</a>,<a href="#44504" title="Int">_</a>, <a href="#36985" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" class="delimiter">[</span><a href="OrderLineTO.java.html#9174" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">OrderLineTO</a><span class="delimiter">]</span><span class="delimiter">)</span>

    <span class="keyword">for</span><span class="delimiter">(</span> <span class="delimiter">(</span><a title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" id="44633">order</a>, <a title="Int" id="44634">idx</a><span class="delimiter">)</span> &lt;- <a href="#44393" title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">orders</a>.<a href="#44601" title="(f: (ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int) =&gt; edu.berkeley.cs.scads.piql.tpcw.OrderLine)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int)],edu.berkeley.cs.scads.piql.tpcw.OrderLine,Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]])Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">zipWithIndex</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.OrderLine" id="44635">orderline</a> = <a href="TpcwSchema.scala.html#44638" title="(OL_O_ID: String, OL_ID: Int)edu.berkeley.cs.scads.piql.tpcw.OrderLine">OrderLine</a><span class="delimiter">(</span><a href="#36689" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42137" title="Int">id</a><span class="delimiter">)</span>, <a href="#44634" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="#44635" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21574" title="(x$1: String)Unit">OL_I_ID</a> = <a href="#36688" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#44633" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44520" title="()Int">getOl_i_id</a><span class="delimiter">)</span>
      <a href="#44635" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21577" title="(x$1: Int)Unit">OL_QTY</a> = <a href="#44633" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44522" title="()Int">getOl_qty</a>
      <a href="#44635" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21580" title="(x$1: Double)Unit">OL_DISCOUNT</a> = <a href="#44633" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44524" title="()Double">getOl_discount</a>
      <a href="#44635" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21583" title="(x$1: String)Unit">OL_COMMENT</a> =   <a href="#44633" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44526" title="()java.lang.String">getOl_comments</a>
      <a href="#44635" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>