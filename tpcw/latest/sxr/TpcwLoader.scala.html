<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TpcwLoader.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> tpcw

<span class="keyword">import</span> net.lag.logging._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.storage._
<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.piql.<span title="object edu.berkeley.cs.scads.piql.DataGenerator">DataGenerator</span>._
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.Generator
<span class="keyword">import</span> java.util.UUID
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.objects._
<span class="keyword">import</span> collection.mutable.<span class="delimiter">{</span>ArrayBuffer, HashMap<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.generic.IndexedRecord
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._
<span class="keyword">import</span> org.apache.avro.util.Utf8


<span class="keyword">class</span> <a title="class TpcwLoader extends java.lang.Object with ScalaObject" id="10174">TpcwLoader</a><a href="#10174" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Double" id="36988">numEBs</a> : <span title="Double">Double</span>,
                 <span class="keyword">val</span> <a title="Int" id="36989">numItems</a> : <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="36652">logger</a> = <span title="()net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#36988" title="=&gt; Double">numEBs</a> <span title="(x: Double)Boolean">&gt;</span> <span title="Double(0.0)" class="double">0.0</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#36989" title="=&gt; Int">numItems</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="comment">/**
   * See clause 4.2.2 - items MUST be chosen from the following set
   */</span>
  <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Int]" id="36654">ValidItemCardinalities</a> = <span title="(elems: Int*)scala.collection.immutable.Set[Int]">Set</span><span class="delimiter">(</span><span title="Int(1000)" class="int">1000</span>, <span title="Int(10000)" class="int">10000</span>, <span title="Int(100000)" class="int">100000</span>, <span title="Int(1000000)" class="int">1000000</span>, <span title="Int(10000000)" class="int">10000000</span><span class="delimiter">)</span>

  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#36654" title="=&gt; scala.collection.immutable.Set[Int]">ValidItemCardinalities</a>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#36989" title="=&gt; Int">numItems</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#36652" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;)" class="string">&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;</span>, <a href="#36989" title="=&gt; Int">numItems</a><span class="delimiter">)</span>

  <span class="comment">/** Cardinalities defined by clause 4.3 */</span>
  <span class="keyword">val</span> <a title="Int" id="36656">numCustomers</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><a href="#36988" title="=&gt; Double">numEBs</a> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <span title="Int(2880)" class="int">2880</span><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36658">numAddresses</a> : <span title="Int">Int</span> = <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#36656" title="=&gt; Int">numCustomers</a>
  <span class="keyword">val</span> <a title="Int" id="36660">numAuthors</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.25)" class="double">.25</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#36989" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36662">numOrders</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.9)" class="double">.9</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#36656" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36664">numCountries</a> : <span title="Int">Int</span> = <span title="Int(92)" class="int">92</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="scala.util.Random" id="36666">rand</a> = <span title="()scala.util.Random" class="keyword">new</span> scala.util.<span title="scala.util.Random">Random</span>

  <span class="keyword">trait</span> <a title="trait NamespaceData extends java.lang.Object with ScalaObject" id="36668">NamespaceData</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="37278">Pair</a> &lt;: AvroPair
    <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]" id="37279">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">PairNamespace</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Seq[NamespaceData.this.Pair]" id="37280">sampleData</a>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]" id="37281">dataSlice</a><span class="delimiter">(</span><a title="Int" id="37289">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37290">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(replicationFactor: Int)Unit" id="37282">repartition</a><span class="delimiter">(</span><a title="Int" id="37292">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37279" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a>.<span title="(data: Seq[NamespaceData.this.Pair], replicationFactor: Int)Unit">repartition</span><span class="delimiter">(</span><a href="#37280" title="=&gt; Seq[NamespaceData.this.Pair]">sampleData</a>, <a href="#37292" title="Int">replicationFactor</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(clientId: Int, numLoaders: Int)Unit" id="37283">load</a><span class="delimiter">(</span><a title="Int" id="37301">clientId</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>, <a title="Int" id="37302">numLoaders</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37279" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a> <span title="(that: TraversableOnce[NamespaceData.this.Pair])Unit">++=</span>  <a href="#37281" title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]">dataSlice</a><span class="delimiter">(</span><a href="#37301" title="Int">clientId</a>, <a href="#37302" title="Int">numLoaders</a><span class="delimiter">)</span>

        <span class="comment">/** assuming [1, upperBound], returns the slice of data for this clientId */</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]" id="37284">getSlice</a><span class="delimiter">(</span><a title="Int" id="37306">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37307">numClients</a>: <span title="Int">Int</span>, <a title="Int" id="37308">upperBound</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37308" title="Int">upperBound</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="37311">numPerClient</a> = <a href="#37308" title="Int">upperBound</a> <span title="(x: Int)Int">/</span> <a href="#37307" title="Int">numClients</a>
      <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37311" title="Int">numPerClient</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// this is the case where there are more clients than elements to slice</span>
        <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37306" title="Int">clientId</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#37308" title="Int">upperBound</a><span class="delimiter">)</span> <span title="object Seq">Seq</span>.<span title="Seq[Nothing]">empty</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#37306" title="Int">clientId</a> <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">+</span> <span title="Int(1)" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37306" title="Int">clientId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="39646">start</a> = <a href="#37306" title="Int">clientId</a> <span title="(x: Int)Int">*</span> <a href="#37311" title="Int">numPerClient</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span title="scala.collection.immutable.Range" class="keyword">if</span> <span class="delimiter">(</span><a href="#37306" title="Int">clientId</a> <span title="(x: Int)Boolean">==</span> <a href="#37307" title="Int">numClients</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#39646" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37308" title="Int">upperBound</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#39646" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range">until</span> <span class="delimiter">(</span><a href="#39646" title="Int">start</a> <span title="(x: Int)Int">+</span> <a href="#37311" title="Int">numPerClient</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait NoLoad extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject" id="36669">NoLoad</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#36668" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)scala.collection.immutable.Nil.type" id="39768">dataSlice</a><span class="delimiter">(</span><a title="Int" id="39771">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="39772">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class RandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="41598">RandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="41600">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#41598" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42055">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; A" id="42056">generator</a>: Int =&gt; A, <a title="Int" id="42057">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#36668" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="39785">Pair</a> = <a href="#41600" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[RandomData.this.Pair]" id="39786">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42057" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42056" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[RandomData.this.Pair]" id="39787">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41357">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41358">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37284" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41357" title="Int">clientId</a>, <a href="#41358" title="Int">numClients</a>, <a href="#42057" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42056" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class FlattenedRandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="41989">FlattenedRandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="41991">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#41989" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42128">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; Seq[A]" id="42129">generator</a>: Int =&gt; Seq<span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int" id="42130">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#36668" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="41717">Pair</a> = <a href="#41991" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[FlattenedRandomData.this.Pair]" id="41718">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42130" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42129" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[FlattenedRandomData.this.Pair]" id="41719">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41888">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41889">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37284" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41888" title="Int">clientId</a>, <a href="#41889" title="Int">numClients</a>, <a href="#42130" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42129" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">//TODO: Partition shopping cart</span>
  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]" id="36678">namespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42048">client</a>: <a href="TpcwClient.scala.html#10158" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a><span class="delimiter">)</span>: <span title="Seq[TpcwLoader.this.NamespaceData]">Seq</span><span class="delimiter">[</span>NamespaceData<span class="delimiter">]</span> =
    <span title="[A](xs: A*)List[A]">List</span><span title="(xs: TpcwLoader.this.NamespaceData*)List[TpcwLoader.this.NamespaceData]" class="delimiter">[</span><a href="#36668" title="TpcwLoader.this.NamespaceData">NamespaceData</a><span class="delimiter">]</span><span class="delimiter">(</span>
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Address, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Address]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14659" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address]">addresses</a>, <a href="#36698" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address">createAddress</a><span class="delimiter">(</span><a href="#42067" title="Int">_</a><span class="delimiter">)</span>, <a href="#36656" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Author, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Author]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14661" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author]">authors</a>, <a href="#36697" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author">createAuthor</a><span class="delimiter">(</span><a href="#42078" title="Int">_</a><span class="delimiter">)</span>, <a href="#36660" title="=&gt; Int">numAuthors</a><span class="delimiter">)</span>,
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.CcXact, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.CcXact]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14663" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact]">xacts</a>, <a href="#36696" title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact">createXacts</a><span class="delimiter">(</span><a href="#42089" title="Int">_</a><span class="delimiter">)</span>, <a href="#36662" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Country, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Country]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14665" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country]">countries</a>, <a href="#36695" title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country">createCountry</a><span class="delimiter">(</span><a href="#42100" title="Int">_</a><span class="delimiter">)</span>, <a href="#36664" title="=&gt; Int">numCountries</a><span class="delimiter">)</span>,
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Customer, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Customer]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14667" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer]">customers</a>, <a href="#36699" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer">createCustomer</a><span class="delimiter">(</span><a href="#42111" title="Int">_</a><span class="delimiter">)</span>, <a href="#36656" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Item, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Item]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14669" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item]">items</a>, <a href="#36694" title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item">createItem</a><span class="delimiter">(</span><a href="#42122" title="Int">_</a><span class="delimiter">)</span>, <a href="#36989" title="=&gt; Int">numItems</a><span class="delimiter">)</span>,
      <a href="#41989" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine], generator: Int =&gt; Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine], numRecords: Int)TpcwLoader.this.FlattenedRandomData[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">FlattenedRandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14671" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">orderLines</a>, <a href="#36701" title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">createOrderline</a><span class="delimiter">(</span><a href="#42140" title="Int">_</a><span class="delimiter">)</span>, <a href="#36662" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#41598" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Order, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Order]">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14673" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order]">orders</a>, <a href="#36700" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order">createOrder</a><span class="delimiter">(</span><a href="#42151" title="Int">_</a><span class="delimiter">)</span>, <a href="#36662" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#42157" title="TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" class="keyword">new</a> <a title="anonymous class $anon extends TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" id="42157">RandomData</a><span class="delimiter">(</span><a href="#42048" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#14675" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem]">shoppingCartItems</a>, <a title="Int" id="42202">i</a> =&gt; <a href="TpcwSchema.scala.html#34949" title="(SCL_C_UNAME: String, SCL_I_ID: String)edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem">ShoppingCartItem</a><span class="delimiter">(</span><a href="#36686" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#42202" title="Int">i</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#36656" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#36669" title="TpcwLoader.this.NoLoad">NoLoad</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient, replicationFactor: Int)Unit" id="36679">createNamespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42203">client</a>: <a href="TpcwClient.scala.html#10158" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a>, <a title="Int" id="42204">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36678" title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]">namespaces</a><span class="delimiter">(</span><a href="#42203" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a><span class="delimiter">)</span>.<span title="(f: TpcwLoader.this.NamespaceData =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#42241" title="TpcwLoader.this.NamespaceData">_</a>.<a href="#37282" title="(replicationFactor: Int)Unit">repartition</a><span class="delimiter">(</span><a href="#42204" title="Int">replicationFactor</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()String" id="36680">uuid</a><span class="delimiter">(</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="()java.util.UUID">randomUUID</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)String" id="36681">nameUuid</a><span class="delimiter">(</span><a title="String" id="42176">s</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="(x$1: Array[Byte])java.util.UUID">nameUUIDFromBytes</span><span class="delimiter">(</span><a href="#42176" title="String">s</a>.<span title="(x$1: java.lang.String)Array[Byte]">getBytes</span><span class="delimiter">(</span><span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>

  <span class="comment">/**
   * Given a cluster size, create the hex splits, sorted in string lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)Seq[Option[String]]" id="36682">hexSplit</a><span class="delimiter">(</span><a title="Int" id="42297">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[Option[String]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="42299">size</a> = <span title="Int(16)" class="int">16</span>
    <span class="keyword">var</span> <a title="Int" id="42300">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#42299" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#42297" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#42302" title="()Unit" class="delimiter">{</a>
      <a href="#42299" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>
      <a href="#42300" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#42299" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>; <a href="#42300" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>
    <span class="keyword">val</span> <a title="Double" id="42301">numPerNode</a> = <a href="#42299" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#42297" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#42301" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#42337" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],Seq[Option[String]]])Seq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#42297" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="42481">i</a> =&gt; <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%0&quot;)" class="string">&quot;%0&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#42300" title="Int">levels</a> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span> <span title="java.lang.String(&quot;x&quot;)" class="string">&quot;x&quot;</span><span class="delimiter">)</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#42481" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#42301" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#42855" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create 8-bit ASCII split, sorted in string
   * lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="36683">utf8Split</a><span class="delimiter">(</span><a title="Int" id="42981">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="42984">size</a> = <span title="Int(256)" class="int">256</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#42984" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#42981" title="Int">clusterSize</a><span class="delimiter">)</span>
      <a href="#42984" title="Int">size</a> = <a href="#42984" title="Int">size</a> <span title="(x: Int)Int">*</span> <span title="Int(256)" class="int">256</span>

    <span class="keyword">val</span> <a title="Int" id="42985">numPerNode</a> = <a href="#42984" title="Int">size</a> <span title="(x: Int)Int">/</span> <a href="#42981" title="Int">clusterSize</a>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#42985" title="Int">numPerNode</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

    <span class="comment">// encodes i as a base 256 string. not super efficient</span>
    <span class="keyword">def</span> <a title="(i: Int)String" id="42986">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43006">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#43006" title="Int">i</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String(&quot;&quot;)" class="int">0</span> =&gt; <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="keyword">case</span> <span title="java.lang.String">_</span> =&gt; <a href="#42986" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43006" title="Int">i</a> <span title="(x: Int)Int">/</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#43006" title="Int">i</a> <span title="(x: Int)Int">%</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>
    <span class="delimiter">}</span>

    <span title="object None">None</span> <a href="#43015" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#42981" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43115">i</a> =&gt; <span class="delimiter">(</span><a href="#42986" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43115" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#42985" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43225" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create splits over printable chars, defined as
   * ASCII [33-126]
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="36684">printableCharSplit</a><span class="delimiter">(</span><a title="Int" id="43323">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#43327" title="(Int, Int)" class="delimiter">(</a><a href="#43326" title="Int" id="43327">low</a>, <a href="#43326" title="Int" id="43328">high</a><span class="delimiter">)</span> = <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="Int(33)" class="int">33</span>, <span title="Int(126)" class="int">126</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43329">numChars</a> = <a href="#43328" title="Int">high</a> <span title="(x: Int)Int">-</span> <a href="#43327" title="Int">low</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">var</span> <a title="Int" id="43330">size</a> = <a href="#43329" title="Int">numChars</a>
    <span class="keyword">var</span> <a title="Int" id="43331">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43330" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43323" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#43335" title="()Unit" class="delimiter">{</a>
      <a href="#43330" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43329" title="Int">numChars</a>
      <a href="#43331" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#43330" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43329" title="Int">numChars</a>; <a href="#43331" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>

    <span class="keyword">def</span> <a title="(i: Int)String" id="43332">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43381">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> =
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#43381" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43329" title="Int">numChars</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#43381" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#43327" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>
      <span class="keyword">else</span> <a href="#43332" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43381" title="Int">i</a> <span title="(x: Int)Int">/</span> <a href="#43329" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#43381" title="Int">i</a> <span title="(x: Int)Int">%</span> <a href="#43329" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <a href="#43327" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>

    <span class="keyword">def</span> <a title="(str: String, ch: Char, level: Int)String" id="43333">pad</a><span class="delimiter">(</span><a title="String" id="43402">str</a>: <span title="String">String</span>, <a title="Char" id="43403">ch</a>: <span title="Char">Char</span>, <a title="Int" id="43404">level</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="String" id="43405">s</a> = <a href="#43402" title="String">str</a>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43405" title="String">s</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#43404" title="Int">level</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#43405" title="String">s</a> = <a href="#43403" title="Char">ch</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#43405" title="String">s</a>
      <span class="delimiter">}</span>
      <a href="#43405" title="String">s</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Double" id="43334">numPerNode</a> = <a href="#43330" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#43323" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#43334" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#43422" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43323" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43522">i</a> =&gt; <a href="#43333" title="(str: String, ch: Char, level: Int)String">pad</a><span class="delimiter">(</span><a href="#43332" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#43522" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#43334" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>, <a href="#43327" title="Int">low</a>.<span title="=&gt; Char">toChar</span>, <a href="#43331" title="Int">levels</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43632" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Splits a given range [0, rangeSplit) between clusterSize. if
   * clusterSize exceeds the given range, then clusterSize - givenRange
   * elements are dropped
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(end: Int, clusterSize: Int)Seq[Option[Int]]" id="36685">rangeSplit</a><span class="delimiter">(</span><a title="Int" id="43730">end</a>: <span title="Int">Int</span>, <a title="Int" id="43731">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[Option[Int]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="43733">realSize</a> = <a href="#43731" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> scala.math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#43731" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> <a href="#43730" title="Int">end</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43734">numPerNode</a> = <a href="#43730" title="Int">end</a> <span title="(x: Int)Int">/</span> <a href="#43733" title="Int">realSize</a>
    <span title="object None">None</span> <a href="#43755" title="(elem: Option[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[Int]],Option[Int],Seq[Option[Int]]])Seq[Option[Int]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43733" title="Int">realSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; Some[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]])scala.collection.immutable.IndexedSeq[Some[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]]" class="delimiter">(</span><a title="Int" id="43855">i</a> =&gt; <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#43855" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#43734" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36686">toCustomer</a><span class="delimiter">(</span><a title="Int" id="42173">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;cust%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#42173" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36687">toAuthor</a><span class="delimiter">(</span><a title="Int" id="43985">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43985" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author FNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="36688">toAuthorFname</a><span class="delimiter">(</span><a title="String" id="43991">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_fname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43991" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author LNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="36689">toAuthorLname</a><span class="delimiter">(</span><a title="String" id="43997">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_lname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#43997" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36690">toAddress</a><span class="delimiter">(</span><a title="Int" id="44003">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;address%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44003" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36691">toXact</a><span class="delimiter">(</span><a title="Int" id="44009">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;xact%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44009" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36692">toItem</a><span class="delimiter">(</span><a title="Int" id="44015">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;item%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44015" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36693">toOrder</a><span class="delimiter">(</span><a title="Int" id="44021">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36681" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;order%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44021" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item" id="36694">createItem</a><span class="delimiter">(</span><a title="Int" id="42123">itemId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10216" title="edu.berkeley.cs.scads.piql.tpcw.Item">Item</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" id="44027">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44034" title="(i: Int, numItems: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateItem</a><span class="delimiter">(</span><a href="#42123" title="Int">itemId</a>, <a href="#36989" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" class="delimiter">[</span><a href="ItemTO.java.html#9172" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">ItemTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = itemIds.getOrElseUpdate(itemId, uuid())</span>
    <span class="comment">//itemSubjectDateTitleIndexInserts += Tuple2(</span>
    <span class="comment">//  ItemSubjectDateTitleIndexKey(to.getI_subject,</span>
    <span class="comment">//    to.getI_pub_date,</span>
    <span class="comment">//    to.getI_title),</span>
    <span class="comment">//  ItemKey(idStr))</span>
    <span class="comment">//val author =  authors.get(to.getI_a_id)</span>

    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_FNAME, to.getI_title, idStr), NullRecord(true))</span>
    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_LNAME, to.getI_title, idStr), NullRecord(true))</span>

    <span class="comment">//val tokens = to.getI_title.split(&quot;\\s+&quot;);</span>

    <span class="comment">//itemTitleIndexInserts ++= tokens.map(x =&gt; (ItemTitleIndexKey(x.toLowerCase, to.getI_title ,idStr), NullRecord(true)))</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Item" id="44028">item</a> = <a href="TpcwSchema.scala.html#35758" title="(I_ID: String)edu.berkeley.cs.scads.piql.tpcw.Item">Item</a><span class="delimiter">(</span><a href="#36692" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#42123" title="Int">itemId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21492" title="(x$1: String)Unit">I_TITLE</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44067" title="()java.lang.String">getI_title</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21495" title="(x$1: String)Unit">I_A_ID</a> = <a href="#36687" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44069" title="()Int">getI_a_id</a><span class="delimiter">)</span>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21498" title="(x$1: Long)Unit">I_PUB_DATE</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44071" title="()Long">getI_pub_date</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21501" title="(x$1: String)Unit">I_PUBLISHER</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44073" title="()java.lang.String">getI_publisher</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21504" title="(x$1: String)Unit">I_SUBJECT</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44075" title="()java.lang.String">getI_subject</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21507" title="(x$1: String)Unit">I_DESC</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44077" title="()java.lang.String">getI_desc</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21510" title="(x$1: Int)Unit">I_RELATED1</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44079" title="()Int">getI_related1</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21513" title="(x$1: Int)Unit">I_RELATED2</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44081" title="()Int">getI_related2</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21516" title="(x$1: Int)Unit">I_RELATED3</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44083" title="()Int">getI_related3</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21519" title="(x$1: Int)Unit">I_RELATED4</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44085" title="()Int">getI_related4</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21522" title="(x$1: Int)Unit">I_RELATED5</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44087" title="()Int">getI_related5</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21525" title="(x$1: String)Unit">I_THUMBNAIL</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44089" title="()java.lang.String">getI_thumbnail</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21528" title="(x$1: String)Unit">I_IMAGE</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44091" title="()java.lang.String">getI_image</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21531" title="(x$1: Double)Unit">I_SRP</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44093" title="()Double">getI_srp</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21534" title="(x$1: Double)Unit">I_COST</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44095" title="()Double">getI_cost</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21537" title="(x$1: Long)Unit">I_AVAIL</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44097" title="()Long">getI_avail</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21540" title="(x$1: Int)Unit">I_STOCK</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44099" title="()Int">getI_stock</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21543" title="(x$1: String)Unit">ISBN</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44101" title="()java.lang.String">getI_isbn</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21546" title="(x$1: Int)Unit">I_PAGE</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44103" title="()Int">getI_page</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21549" title="(x$1: String)Unit">I_BACKING</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44105" title="()java.lang.String">getI_backing</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21552" title="(x$1: String)Unit">I_DIMENSION</a> = <a href="#44027" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44107" title="()java.lang.String">getI_dimensions</a>
    <a href="#44028" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country" id="36695">createCountry</a><span class="delimiter">(</span><a title="Int" id="42101">countryId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10219" title="edu.berkeley.cs.scads.piql.tpcw.Country">Country</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" id="44133">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44033" title="(i: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCountry</a><span class="delimiter">(</span><a href="#42101" title="Int">countryId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" class="delimiter">[</span><a href="CountryTO.java.html#9164" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">CountryTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Country" id="44134">country</a> = <a href="TpcwSchema.scala.html#44152" title="(CO_ID: Int)edu.berkeley.cs.scads.piql.tpcw.Country">Country</a><span class="delimiter">(</span><a href="#42101" title="Int">countryId</a><span class="delimiter">)</span>
    <a href="#44134" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21400" title="(x$1: String)Unit">CO_NAME</a> = <a href="#44133" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44144" title="()java.lang.String">getCo_name</a>
    <a href="#44134" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21403" title="(x$1: Double)Unit">CO_EXCHANGE</a> = <a href="#44133" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44146" title="()Double">getCo_exchange</a>
    <a href="#44134" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21406" title="(x$1: String)Unit">CO_CURRENCY</a> =  <a href="#44133" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44148" title="()java.lang.String">getCo_currency</a>
    <a href="#44134" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact" id="36696">createXacts</a><span class="delimiter">(</span><a title="Int" id="42090">orderId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10234" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a> = <span class="delimiter">{</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(orderId, uuid())</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" id="44161">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44037" title="(i: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCCXacts</a><span class="delimiter">(</span><a href="#42090" title="Int">orderId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" class="delimiter">[</span><a href="CCXactsTO.java.html#9160" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">CCXactsTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.CcXact" id="44162">xact</a> = <a href="TpcwSchema.scala.html#36414" title="(CX_O_ID: String)edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a><span class="delimiter">(</span><a href="#36691" title="(id: Int)String">toXact</a><span class="delimiter">(</span><a href="#42090" title="Int">orderId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21357" title="(x$1: String)Unit">CX_TYPE</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44177" title="()java.lang.String">getCx_type</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21360" title="(x$1: Int)Unit">CX_NUM</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44179" title="()Int">getCx_num</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21363" title="(x$1: String)Unit">CX_NAME</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44181" title="()java.lang.String">getCx_name</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21366" title="(x$1: Long)Unit">CX_EXPIRY</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44183" title="()Long">getCs_expiry</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21369" title="(x$1: String)Unit">CX_AUTH_ID</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44185" title="()java.lang.String">getCx_auth_id</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21372" title="(x$1: Double)Unit">CX_XACT_AMT</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44187" title="()Double">getCx_xact_amt</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21375" title="(x$1: Long)Unit">CX_XACT_DATE</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44189" title="()Long">getCx_xact_date</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21378" title="(x$1: Int)Unit">CX_CO_ID</a> = <a href="#44161" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44191" title="()Int">getCx_co_id</a>
    <a href="#44162" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author" id="36697">createAuthor</a><span class="delimiter">(</span><a title="Int" id="42079">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10222" title="edu.berkeley.cs.scads.piql.tpcw.Author">Author</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" id="44194">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44031" title="(aId: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAuthor</a><span class="delimiter">(</span><a href="#42079" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" class="delimiter">[</span><a href="AuthorTO.java.html#9156" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">AuthorTO</a><span class="delimiter">]</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Author" id="44195">author</a> = <a href="TpcwSchema.scala.html#44219" title="(A_ID: String)edu.berkeley.cs.scads.piql.tpcw.Author">Author</a><span class="delimiter">(</span><a href="#36687" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42079" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44195" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21323" title="(x$1: String)Unit">A_FNAME</a> = <a href="#36688" title="(authorId: String)String">toAuthorFname</a><span class="delimiter">(</span><a href="#36687" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42079" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44195" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21326" title="(x$1: String)Unit">A_LNAME</a> = <a href="#36689" title="(authorId: String)String">toAuthorLname</a><span class="delimiter">(</span><a href="#36687" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42079" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44195" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21329" title="(x$1: String)Unit">A_MNAME</a> = <a href="#44194" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44209" title="()java.lang.String">getA_mname</a>
    <a href="#44195" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21332" title="(x$1: Long)Unit">A_DOB</a> = <a href="#44194" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44213" title="()Long">getA_dob</a>
    <a href="#44195" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21335" title="(x$1: String)Unit">A_BIO</a> = <a href="#44194" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44215" title="()java.lang.String">getA_bio</a>

    <a href="#44195" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>

    <span class="comment">//var author = (AuthorKey(uuid()), AuthorValue(to.getA_fname, to.getA_lname, to.getA_mname, to.getA_dob, to.getA_bio))</span>
    <span class="comment">//authors += id -&gt;  author</span>
    <span class="comment">//author</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address" id="36698">createAddress</a><span class="delimiter">(</span><a title="Int" id="42068">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10237" title="edu.berkeley.cs.scads.piql.tpcw.Address">Address</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" id="44230">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44030" title="(addrId: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAddress</a><span class="delimiter">(</span><a href="#42068" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" class="delimiter">[</span><a href="AddressTO.java.html#9152" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">AddressTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = addressIds.getOrElseUpdate(id, uuid())</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Address" id="44231">address</a> = <a href="TpcwSchema.scala.html#44258" title="(ADDR_ID: String)edu.berkeley.cs.scads.piql.tpcw.Address">Address</a><span class="delimiter">(</span><a href="#36690" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#42068" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17230" title="(x$1: String)Unit">ADDR_STREET1</a> =  <a href="#44230" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44244" title="()java.lang.String">getAddr_street_1</a>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17233" title="(x$1: String)Unit">ADDR_STREET2</a> =  <a href="#44230" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44246" title="()java.lang.String">getAddr_street_2</a>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17236" title="(x$1: String)Unit">ADDR_CITY</a> =  <a href="#44230" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44248" title="()java.lang.String">getAddr_city</a>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17239" title="(x$1: String)Unit">ADDR_STATE</a> =  <a href="#44230" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44254" title="()java.lang.String">getAddr_state</a>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17242" title="(x$1: String)Unit">ADDR_ZIP</a> =  <a href="#44230" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44250" title="()java.lang.String">getAddr_zip</a>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#17245" title="(x$1: Int)Unit">ADDR_CO_ID</a> =  <a href="#44230" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44252" title="()Int">getAddr_co_id</a>
    <a href="#44231" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer" id="36699">createCustomer</a><span class="delimiter">(</span><a title="Int" id="42112">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> :  <a href="TpcwSchema.scala.html#10225" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" id="44270">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44032" title="(i: Int, numCustomers: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCustomer</a><span class="delimiter">(</span> <a href="#42112" title="Int">id</a> , <a href="#36656" title="=&gt; Int">numCustomers</a> <span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" class="delimiter">[</span><a href="CustomerTO.java.html#9168" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">CustomerTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="44271">customer</a> = <a href="TpcwSchema.scala.html#44329" title="(C_UNAME: String)edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a><span class="delimiter">(</span><a href="#36686" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44293" title="()Int">getC_id</a><span class="delimiter">)</span><span class="delimiter">)</span>   <span class="comment">//used naming convention instead of UUID</span>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21428" title="(x$1: String)Unit">C_PASSWD</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44297" title="()java.lang.String">getC_passwd</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21431" title="(x$1: String)Unit">C_FNAME</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44299" title="()java.lang.String">getC_fname</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21434" title="(x$1: String)Unit">C_LNAME</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44301" title="()java.lang.String">getC_lname</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21437" title="(x$1: String)Unit">C_ADDR_ID</a> = <a href="#36690" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44303" title="()Int">getC_addr_id</a><span class="delimiter">)</span>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21440" title="(x$1: String)Unit">C_PHONE</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44305" title="()Int">getC_phone</a>.<span title="()java.lang.String">toString</span>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21443" title="(x$1: String)Unit">C_EMAIL</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44307" title="()java.lang.String">getC_email</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21446" title="(x$1: Long)Unit">C_SINCE</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44309" title="()Long">getC_since</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21449" title="(x$1: Long)Unit">C_LAST_VISIT</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44311" title="()Long">getC_last_visit</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21452" title="(x$1: Long)Unit">C_LOGIN</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44313" title="()Long">getC_login</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21455" title="(x$1: Long)Unit">C_EXPIRATION</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44315" title="()Long">getC_expiration</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21458" title="(x$1: Double)Unit">C_DISCOUNT</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44317" title="()Double">getC_discount</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21461" title="(x$1: Double)Unit">C_BALANCE</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44319" title="()Double">getC_balance</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21464" title="(x$1: Double)Unit">C_YTD_PMT</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44321" title="()Double">getC_ytd_pmt</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21467" title="(x$1: Long)Unit">C_BIRTHDATE</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44323" title="()Long">getC_birthday</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21470" title="(x$1: String)Unit">C_DATA</a> = <a href="#44270" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44325" title="()java.lang.String">getC_data</a>
    <a href="#44271" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order" id="36700">createOrder</a><span class="delimiter">(</span><a title="Int" id="42152">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#10228" title="edu.berkeley.cs.scads.piql.tpcw.Order">Order</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" id="44350">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44035" title="(i: Int, numCustomers: Int, numItemLines: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrder</a><span class="delimiter">(</span><a href="#42152" title="Int">id</a>, <a href="#36656" title="=&gt; Int">numCustomers</a>, <a href="#36666" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" class="delimiter">[</span><a href="OrderTO.java.html#9180" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">OrderTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(id, uuid())</span>
    <span class="comment">//customerOrderIndexInserts += Tuple2(CustomerOrderIndex(&quot;cust&quot; + to.getO_c_id, to.getO_date, idStr), NullRecord(true))</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Order" id="44351">order</a> = <a href="TpcwSchema.scala.html#35898" title="(O_ID: String)edu.berkeley.cs.scads.piql.tpcw.Order">Order</a><span class="delimiter">(</span><a href="#36693" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42152" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21609" title="(x$1: String)Unit">O_C_UNAME</a> = <a href="#36686" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44376" title="()Int">getO_c_id</a><span class="delimiter">)</span>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21612" title="(x$1: Long)Unit">O_DATE_Time</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44378" title="()Long">getO_date</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21615" title="(x$1: Double)Unit">O_SUB_TOTAL</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44380" title="()Double">getO_sub_total</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21618" title="(x$1: Double)Unit">O_TAX</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44382" title="()Double">getO_tax</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21621" title="(x$1: Double)Unit">O_TOTAL</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44384" title="()Double">getO_total</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21624" title="(x$1: String)Unit">O_SHIP_TYPE</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44386" title="()java.lang.String">getO_ship_type</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21627" title="(x$1: Long)Unit">O_SHIP_DATE</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44388" title="()Long">getO_ship_date</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21630" title="(x$1: String)Unit">O_BILL_ADDR_ID</a> = <a href="#36690" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44390" title="()Int">getO_bill_addr_id</a><span class="delimiter">)</span>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21633" title="(x$1: String)Unit">O_SHIP_ADDR_ID</a> = <a href="#36690" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44392" title="()Int">getO_ship_addr_id</a><span class="delimiter">)</span>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21636" title="(x$1: String)Unit">O_STATUS</a> = <a href="#44350" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44394" title="()java.lang.String">getO_status</a>
    <a href="#44351" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>
  <span class="delimiter">}</span>

<span class="comment">//  def createCustomerOrderIndex(order: (OrdersKey, OrdersValue)) : (CustomerOrderIndex, NullRecord) = {</span>
<span class="comment">//    (CustomerOrderIndex(order._2.O_C_ID, order._2.O_DATE_Time, order._1.O_ID), NullRecord(true))</span>
<span class="comment">//  }</span>


  <span class="keyword">def</span> <a title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]" id="36701">createOrderline</a><span class="delimiter">(</span><a title="Int" id="42141">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">Seq</span><span class="delimiter">[</span>OrderLine<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]" id="44397">orders</a> : <span title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">Seq</span><span class="delimiter">[</span>OrderLineTO<span class="delimiter">]</span> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#36666" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]])Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,scala.collection.immutable.IndexedSeq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]]" class="delimiter">(</span> <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44036" title="(orderLineId: Int, orderId: Int, numItems: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrderLine</a><span class="delimiter">(</span><a href="#42141" title="Int">id</a>,<a href="#44508" title="Int">_</a>, <a href="#36989" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" class="delimiter">[</span><a href="OrderLineTO.java.html#9176" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">OrderLineTO</a><span class="delimiter">]</span><span class="delimiter">)</span>

    <span class="keyword">for</span><span class="delimiter">(</span> <span class="delimiter">(</span><a title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" id="44637">order</a>, <a title="Int" id="44638">idx</a><span class="delimiter">)</span> &lt;- <a href="#44397" title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">orders</a>.<a href="#44605" title="(f: (ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int) =&gt; edu.berkeley.cs.scads.piql.tpcw.OrderLine)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int)],edu.berkeley.cs.scads.piql.tpcw.OrderLine,Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]])Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">zipWithIndex</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.OrderLine" id="44639">orderline</a> = <a href="TpcwSchema.scala.html#44642" title="(OL_O_ID: String, OL_ID: Int)edu.berkeley.cs.scads.piql.tpcw.OrderLine">OrderLine</a><span class="delimiter">(</span><a href="#36693" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42141" title="Int">id</a><span class="delimiter">)</span>, <a href="#44638" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="#44639" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21578" title="(x$1: String)Unit">OL_I_ID</a> = <a href="#36692" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44524" title="()Int">getOl_i_id</a><span class="delimiter">)</span>
      <a href="#44639" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21581" title="(x$1: Int)Unit">OL_QTY</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44526" title="()Int">getOl_qty</a>
      <a href="#44639" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21584" title="(x$1: Double)Unit">OL_DISCOUNT</a> = <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44528" title="()Double">getOl_discount</a>
      <a href="#44639" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21587" title="(x$1: String)Unit">OL_COMMENT</a> =   <a href="#44637" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44530" title="()java.lang.String">getOl_comments</a>
      <a href="#44639" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>