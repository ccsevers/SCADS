<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TpcwLoader.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> tpcw

<span class="keyword">import</span> net.lag.logging._

<span class="keyword">import</span> edu.berkeley.cs.scads.comm._
<span class="keyword">import</span> edu.berkeley.cs.scads.storage._
<span class="keyword">import</span> edu.berkeley.cs.avro.marker._

<span class="keyword">import</span> edu.berkeley.cs.scads.piql.<span title="object edu.berkeley.cs.scads.piql.DataGenerator">DataGenerator</span>._
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.Generator
<span class="keyword">import</span> java.util.UUID
<span class="keyword">import</span> ch.ethz.systems.tpcw.populate.data.objects._
<span class="keyword">import</span> collection.mutable.<span class="delimiter">{</span>ArrayBuffer, HashMap<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.generic.IndexedRecord
<span class="keyword">import</span> edu.berkeley.cs.avro.runtime._
<span class="keyword">import</span> org.apache.avro.util.Utf8


<span class="keyword">class</span> <a title="class TpcwLoader extends java.lang.Object with ScalaObject" id="9669">TpcwLoader</a><a href="#9669" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Double" id="37016">numEBs</a> : <span title="Double">Double</span>,
                 <span class="keyword">val</span> <a title="Int" id="37017">numItems</a> : <span title="Int">Int</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="36680">logger</a> = <span title="()net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37016" title="=&gt; Double">numEBs</a> <span title="(x: Double)Boolean">&gt;</span> <span title="Double(0.0)" class="double">0.0</span><span class="delimiter">)</span>
  <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37017" title="=&gt; Int">numItems</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

  <span class="comment">/**
   * See clause 4.2.2 - items MUST be chosen from the following set
   */</span>
  <span class="keyword">val</span> <a title="scala.collection.immutable.Set[Int]" id="36682">ValidItemCardinalities</a> = <span title="(elems: Int*)scala.collection.immutable.Set[Int]">Set</span><span class="delimiter">(</span><span title="Int(1000)" class="int">1000</span>, <span title="Int(10000)" class="int">10000</span>, <span title="Int(100000)" class="int">100000</span>, <span title="Int(1000000)" class="int">1000000</span>, <span title="Int(10000000)" class="int">10000000</span><span class="delimiter">)</span>

  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#36682" title="=&gt; scala.collection.immutable.Set[Int]">ValidItemCardinalities</a>.<span title="(elem: Int)Boolean">contains</span><span class="delimiter">(</span><a href="#37017" title="=&gt; Int">numItems</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#36680" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;)" class="string">&quot;%d is NOT a valid number of items for a TPC-W benchmark&quot;</span>, <a href="#37017" title="=&gt; Int">numItems</a><span class="delimiter">)</span>

  <span class="comment">/** Cardinalities defined by clause 4.3 */</span>
  <span class="keyword">val</span> <a title="Int" id="36684">numCustomers</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><a href="#37016" title="=&gt; Double">numEBs</a> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <span title="Int(2880)" class="int">2880</span><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36686">numAddresses</a> : <span title="Int">Int</span> = <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#36684" title="=&gt; Int">numCustomers</a>
  <span class="keyword">val</span> <a title="Int" id="36688">numAuthors</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.25)" class="double">.25</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#37017" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36690">numOrders</a> : <span title="Int">Int</span> = <span class="delimiter">(</span><span title="Double(0.9)" class="double">.9</span> <span title="implicit scala.Predef.double2Double : (x: Double)java.lang.Double">*</span> <a href="#36684" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>.<span title="()Int">intValue</span>
  <span class="keyword">val</span> <a title="Int" id="36692">numCountries</a> : <span title="Int">Int</span> = <span title="Int(92)" class="int">92</span>

  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="scala.util.Random" id="36694">rand</a> = <span title="()scala.util.Random" class="keyword">new</span> scala.util.<span title="scala.util.Random">Random</span>

  <span class="keyword">trait</span> <a title="trait NamespaceData extends java.lang.Object with ScalaObject" id="36696">NamespaceData</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="37306">Pair</a> &lt;: AvroPair
    <span class="keyword">protected</span> <span class="keyword">val</span> <a title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]" id="37307">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">PairNamespace</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Seq[NamespaceData.this.Pair]" id="37308">sampleData</a>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]" id="37309">dataSlice</a><span class="delimiter">(</span><a title="Int" id="37317">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37318">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[NamespaceData.this.Pair]">Seq</span><span class="delimiter">[</span>Pair<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(replicationFactor: Int)Unit" id="37310">repartition</a><span class="delimiter">(</span><a title="Int" id="37320">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37307" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a>.<span title="(data: Seq[NamespaceData.this.Pair], replicationFactor: Int)Unit">repartition</span><span class="delimiter">(</span><a href="#37308" title="=&gt; Seq[NamespaceData.this.Pair]">sampleData</a>, <a href="#37320" title="Int">replicationFactor</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(clientId: Int, numLoaders: Int)Unit" id="37311">load</a><span class="delimiter">(</span><a title="Int" id="37329">clientId</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>, <a title="Int" id="37330">numLoaders</a>: <span title="Int">Int</span> = <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <a href="#37307" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[NamespaceData.this.Pair]">ns</a> <span title="(that: TraversableOnce[NamespaceData.this.Pair])Unit">++=</span>  <a href="#37309" title="(clientId: Int, numClients: Int)Seq[NamespaceData.this.Pair]">dataSlice</a><span class="delimiter">(</span><a href="#37329" title="Int">clientId</a>, <a href="#37330" title="Int">numLoaders</a><span class="delimiter">)</span>

        <span class="comment">/** assuming [1, upperBound], returns the slice of data for this clientId */</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]" id="37312">getSlice</a><span class="delimiter">(</span><a title="Int" id="37334">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="37335">numClients</a>: <span title="Int">Int</span>, <a title="Int" id="37336">upperBound</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#37336" title="Int">upperBound</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Int" id="37339">numPerClient</a> = <a href="#37336" title="Int">upperBound</a> <span title="(x: Int)Int">/</span> <a href="#37335" title="Int">numClients</a>
      <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37339" title="Int">numPerClient</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// this is the case where there are more clients than elements to slice</span>
        <span title="Seq[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#37334" title="Int">clientId</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#37336" title="Int">upperBound</a><span class="delimiter">)</span> <span title="object Seq">Seq</span>.<span title="Seq[Nothing]">empty</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#37334" title="Int">clientId</a> <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">+</span> <span title="Int(1)" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37334" title="Int">clientId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="39696">start</a> = <a href="#37334" title="Int">clientId</a> <span title="(x: Int)Int">*</span> <a href="#37339" title="Int">numPerClient</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
        <span title="scala.collection.immutable.Range" class="keyword">if</span> <span class="delimiter">(</span><a href="#37334" title="Int">clientId</a> <span title="(x: Int)Boolean">==</span> <a href="#37335" title="Int">numClients</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#39696" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37336" title="Int">upperBound</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">(</span><a href="#39696" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">start</a> <span title="(end: Int)scala.collection.immutable.Range">until</span> <span class="delimiter">(</span><a href="#39696" title="Int">start</a> <span title="(x: Int)Int">+</span> <a href="#37339" title="Int">numPerClient</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait NoLoad extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject" id="36697">NoLoad</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#36696" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)scala.collection.immutable.Nil.type" id="39818">dataSlice</a><span class="delimiter">(</span><a title="Int" id="39821">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="39822">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class RandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="41648">RandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="41650">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#41648" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42105">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; A" id="42106">generator</a>: Int =&gt; A, <a title="Int" id="42107">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#36696" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="39835">Pair</a> = <a href="#41650" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[RandomData.this.Pair]" id="39836">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42107" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42106" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[RandomData.this.Pair]" id="39837">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41407">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41408">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37312" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41407" title="Int">clientId</a>, <a href="#41408" title="Int">numClients</a>, <a href="#42107" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; A)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[RandomData.this.Pair]])Seq[RandomData.this.Pair]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42106" title="=&gt; Int =&gt; A">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class FlattenedRandomData[A &lt;: edu.berkeley.cs.avro.marker.AvroPair] extends java.lang.Object with TpcwLoader.this.NamespaceData with ScalaObject with Product with Serializable" id="42039">FlattenedRandomData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="42041">A</a> &lt;: AvroPair<span class="delimiter">]</span><a href="#42039" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.storage.PairNamespace[A]" id="42178">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[A]">PairNamespace</span><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int =&gt; Seq[A]" id="42179">generator</a>: Int =&gt; Seq<span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Int" id="42180">numRecords</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#36696" title="TpcwLoader.this.NamespaceData">NamespaceData</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="A" id="41767">Pair</a> = <a href="#42041" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Seq[FlattenedRandomData.this.Pair]" id="41768">sampleData</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#42180" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,scala.collection.immutable.IndexedSeq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42179" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clientId: Int, numClients: Int)Seq[FlattenedRandomData.this.Pair]" id="41769">dataSlice</a><span class="delimiter">(</span><a title="Int" id="41938">clientId</a>: <span title="Int">Int</span>, <a title="Int" id="41939">numClients</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#37312" title="(clientId: Int, numClients: Int, upperBound: Int)Seq[Int]">getSlice</a><span class="delimiter">(</span><a href="#41938" title="Int">clientId</a>, <a href="#41939" title="Int">numClients</a>, <a href="#42180" title="=&gt; Int">numRecords</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with scala.collection.SeqView[Int,Seq[Int]]">view</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[A])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.SeqView[Int,Seq[Int]],A,Seq[FlattenedRandomData.this.Pair]])Seq[FlattenedRandomData.this.Pair]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.SeqView.Coll,A,scala.collection.SeqView[A,Seq[_]]]" class="delimiter">(</span><a href="#42179" title="=&gt; Int =&gt; Seq[A]">generator</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">//TODO: Partition shopping cart</span>
  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]" id="36706">namespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42098">client</a>: <a href="TpcwClient.scala.html#9653" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a><span class="delimiter">)</span>: <span title="Seq[TpcwLoader.this.NamespaceData]">Seq</span><span class="delimiter">[</span>NamespaceData<span class="delimiter">]</span> =
    <span title="[A](xs: A*)List[A]">List</span><span title="(xs: TpcwLoader.this.NamespaceData*)List[TpcwLoader.this.NamespaceData]" class="delimiter">[</span><a href="#36696" title="TpcwLoader.this.NamespaceData">NamespaceData</a><span class="delimiter">]</span><span class="delimiter">(</span>
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Address, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Address]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12895" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Address]">addresses</a>, <a href="#36726" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address">createAddress</a><span class="delimiter">(</span><a href="#42117" title="Int">_</a><span class="delimiter">)</span>, <a href="#36684" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Author, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Author]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12897" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Author]">authors</a>, <a href="#36725" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author">createAuthor</a><span class="delimiter">(</span><a href="#42128" title="Int">_</a><span class="delimiter">)</span>, <a href="#36688" title="=&gt; Int">numAuthors</a><span class="delimiter">)</span>,
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.CcXact, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.CcXact]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12899" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.CcXact]">xacts</a>, <a href="#36724" title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact">createXacts</a><span class="delimiter">(</span><a href="#42139" title="Int">_</a><span class="delimiter">)</span>, <a href="#36690" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Country, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Country]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12901" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Country]">countries</a>, <a href="#36723" title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country">createCountry</a><span class="delimiter">(</span><a href="#42150" title="Int">_</a><span class="delimiter">)</span>, <a href="#36692" title="=&gt; Int">numCountries</a><span class="delimiter">)</span>,
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Customer, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Customer]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12903" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Customer]">customers</a>, <a href="#36727" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer">createCustomer</a><span class="delimiter">(</span><a href="#42161" title="Int">_</a><span class="delimiter">)</span>, <a href="#36684" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span>,
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Item, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Item]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12905" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Item]">items</a>, <a href="#36722" title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item">createItem</a><span class="delimiter">(</span><a href="#42172" title="Int">_</a><span class="delimiter">)</span>, <a href="#37017" title="=&gt; Int">numItems</a><span class="delimiter">)</span>,
      <a href="#42039" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine], generator: Int =&gt; Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine], numRecords: Int)TpcwLoader.this.FlattenedRandomData[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">FlattenedRandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12907" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">orderLines</a>, <a href="#36729" title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">createOrderline</a><span class="delimiter">(</span><a href="#42190" title="Int">_</a><span class="delimiter">)</span>, <a href="#36690" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#41648" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order], generator: Int =&gt; edu.berkeley.cs.scads.piql.tpcw.Order, numRecords: Int)TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.Order]">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12909" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.Order]">orders</a>, <a href="#36728" title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order">createOrder</a><span class="delimiter">(</span><a href="#42201" title="Int">_</a><span class="delimiter">)</span>, <a href="#36690" title="=&gt; Int">numOrders</a><span class="delimiter">)</span>,
      <a href="#42207" title="TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" class="keyword">new</a> <a title="anonymous class $anon extends TpcwLoader.this.RandomData[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem] with TpcwLoader.this.NoLoad" id="42207">RandomData</a><span class="delimiter">(</span><a href="#42098" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a>.<a href="TpcwClient.scala.html#12911" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem]">shoppingCartItems</a>, <a title="Int" id="42252">i</a> =&gt; <a href="TpcwSchema.scala.html#34872" title="(SCL_C_UNAME: String, SCL_I_ID: String)edu.berkeley.cs.scads.piql.tpcw.ShoppingCartItem">ShoppingCartItem</a><span class="delimiter">(</span><a href="#36714" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#42252" title="Int">i</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#36684" title="=&gt; Int">numCustomers</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#36697" title="TpcwLoader.this.NoLoad">NoLoad</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient, replicationFactor: Int)Unit" id="36707">createNamespaces</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient" id="42253">client</a>: <a href="TpcwClient.scala.html#9653" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">TpcwClient</a>, <a title="Int" id="42254">replicationFactor</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36706" title="(client: edu.berkeley.cs.scads.piql.tpcw.TpcwClient)Seq[TpcwLoader.this.NamespaceData]">namespaces</a><span class="delimiter">(</span><a href="#42253" title="edu.berkeley.cs.scads.piql.tpcw.TpcwClient">client</a><span class="delimiter">)</span>.<span title="(f: TpcwLoader.this.NamespaceData =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#42291" title="TpcwLoader.this.NamespaceData">_</a>.<a href="#37310" title="(replicationFactor: Int)Unit">repartition</a><span class="delimiter">(</span><a href="#42254" title="Int">replicationFactor</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()String" id="36708">uuid</a><span class="delimiter">(</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="()java.util.UUID">randomUUID</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)String" id="36709">nameUuid</a><span class="delimiter">(</span><a title="String" id="42226">s</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="String">String</span> =
    <span title="object java.util.UUID">UUID</span>.<span title="(x$1: Array[Byte])java.util.UUID">nameUUIDFromBytes</span><span class="delimiter">(</span><a href="#42226" title="String">s</a>.<span title="(x$1: java.lang.String)Array[Byte]">getBytes</span><span class="delimiter">(</span><span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>

  <span class="comment">/**
   * Given a cluster size, create the hex splits, sorted in string lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)Seq[Option[String]]" id="36710">hexSplit</a><span class="delimiter">(</span><a title="Int" id="42347">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[Option[String]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="42349">size</a> = <span title="Int(16)" class="int">16</span>
    <span class="keyword">var</span> <a title="Int" id="42350">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#42349" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#42347" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#42352" title="()Unit" class="delimiter">{</a>
      <a href="#42349" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>
      <a href="#42350" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#42349" title="Int">size</a> <span title="(x: Int)Int">*=</span> <span title="Int(16)" class="int">16</span>; <a href="#42350" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>
    <span class="keyword">val</span> <a title="Double" id="42351">numPerNode</a> = <a href="#42349" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#42347" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#42351" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#42387" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],Seq[Option[String]]])Seq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#42347" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="42531">i</a> =&gt; <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.String(&quot;%0&quot;)" class="string">&quot;%0&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#42350" title="Int">levels</a> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span> <span title="java.lang.String(&quot;x&quot;)" class="string">&quot;x&quot;</span><span class="delimiter">)</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#42531" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#42351" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#42905" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create 8-bit ASCII split, sorted in string
   * lexicographical order
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="36711">utf8Split</a><span class="delimiter">(</span><a title="Int" id="43031">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="43034">size</a> = <span title="Int(256)" class="int">256</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43034" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43031" title="Int">clusterSize</a><span class="delimiter">)</span>
      <a href="#43034" title="Int">size</a> = <a href="#43034" title="Int">size</a> <span title="(x: Int)Int">*</span> <span title="Int(256)" class="int">256</span>

    <span class="keyword">val</span> <a title="Int" id="43035">numPerNode</a> = <a href="#43034" title="Int">size</a> <span title="(x: Int)Int">/</span> <a href="#43031" title="Int">clusterSize</a>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#43035" title="Int">numPerNode</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

    <span class="comment">// encodes i as a base 256 string. not super efficient</span>
    <span class="keyword">def</span> <a title="(i: Int)String" id="43036">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43056">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#43056" title="Int">i</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String(&quot;&quot;)" class="int">0</span> =&gt; <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="keyword">case</span> <span title="java.lang.String">_</span> =&gt; <a href="#43036" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43056" title="Int">i</a> <span title="(x: Int)Int">/</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#43056" title="Int">i</a> <span title="(x: Int)Int">%</span> <span title="Int(256)" class="int">256</span><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>
    <span class="delimiter">}</span>

    <span title="object None">None</span> <a href="#43065" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43031" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43165">i</a> =&gt; <span class="delimiter">(</span><a href="#43036" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43165" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#43035" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43275" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a cluster size, create splits over printable chars, defined as
   * ASCII [33-126]
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clusterSize: Int)scala.collection.immutable.IndexedSeq[Option[String]]" id="36712">printableCharSplit</a><span class="delimiter">(</span><a title="Int" id="43373">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#43377" title="(Int, Int)" class="delimiter">(</a><a href="#43376" title="Int" id="43377">low</a>, <a href="#43376" title="Int" id="43378">high</a><span class="delimiter">)</span> = <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="Int(33)" class="int">33</span>, <span title="Int(126)" class="int">126</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43379">numChars</a> = <a href="#43378" title="Int">high</a> <span title="(x: Int)Int">-</span> <a href="#43377" title="Int">low</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">var</span> <a title="Int" id="43380">size</a> = <a href="#43379" title="Int">numChars</a>
    <span class="keyword">var</span> <a title="Int" id="43381">levels</a> = <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43380" title="Int">size</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43373" title="Int">clusterSize</a><span class="delimiter">)</span> <a href="#43385" title="()Unit" class="delimiter">{</a>
      <a href="#43380" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43379" title="Int">numChars</a>
      <a href="#43381" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#43380" title="Int">size</a> <span title="(x: Int)Int">*=</span> <a href="#43379" title="Int">numChars</a>; <a href="#43381" title="Int">levels</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span> <span class="comment">// go up one more level than required to get finer granularity</span>

    <span class="keyword">def</span> <a title="(i: Int)String" id="43382">toKeyString</a><span class="delimiter">(</span><a title="Int" id="43431">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> =
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#43431" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#43379" title="Int">numChars</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#43431" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#43377" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>
      <span class="keyword">else</span> <a href="#43382" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><a href="#43431" title="Int">i</a> <span title="(x: Int)Int">/</span> <a href="#43379" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#43431" title="Int">i</a> <span title="(x: Int)Int">%</span> <a href="#43379" title="Int">numChars</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <a href="#43377" title="Int">low</a><span class="delimiter">)</span>.<span title="=&gt; Char">toChar</span>.<span title="()java.lang.String">toString</span>

    <span class="keyword">def</span> <a title="(str: String, ch: Char, level: Int)String" id="43383">pad</a><span class="delimiter">(</span><a title="String" id="43452">str</a>: <span title="String">String</span>, <a title="Char" id="43453">ch</a>: <span title="Char">Char</span>, <a title="Int" id="43454">level</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="String" id="43455">s</a> = <a href="#43452" title="String">str</a>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#43455" title="String">s</a>.<span title="()Int">length</span> <span title="(x: Int)Boolean">&lt;</span> <a href="#43454" title="Int">level</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#43455" title="String">s</a> = <a href="#43453" title="Char">ch</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#43455" title="String">s</a>
      <span class="delimiter">}</span>
      <a href="#43455" title="String">s</a>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Double" id="43384">numPerNode</a> = <a href="#43380" title="Int">size</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">/</span> <a href="#43373" title="Int">clusterSize</a>.<span title="=&gt; Double">toDouble</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#43384" title="Double">numPerNode</a> <span title="(x: Double)Boolean">&gt;=</span> <span title="Double(1.0)" class="double">1.0</span><span class="delimiter">)</span>
    <span title="object None">None</span> <a href="#43472" title="(elem: Option[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[String]],Option[String],scala.collection.immutable.IndexedSeq[Option[String]]])scala.collection.immutable.IndexedSeq[Option[String]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43373" title="Int">clusterSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</span><a title="Int" id="43572">i</a> =&gt; <a href="#43383" title="(str: String, ch: Char, level: Int)String">pad</a><span class="delimiter">(</span><a href="#43382" title="(i: Int)String">toKeyString</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#43572" title="Int">i</a>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <a href="#43384" title="Double">numPerNode</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>, <a href="#43377" title="Int">low</a>.<span title="=&gt; Char">toChar</span>, <a href="#43381" title="Int">levels</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ord: scala.math.Ordering[String])scala.collection.immutable.IndexedSeq[String]">sorted</span>.<span title="(f: String =&gt; Some[String])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[String],Some[String],scala.collection.immutable.IndexedSeq[Some[String]]])scala.collection.immutable.IndexedSeq[Some[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[String],scala.collection.immutable.IndexedSeq[Some[String]]]" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#43682" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Splits a given range [0, rangeSplit) between clusterSize. if
   * clusterSize exceeds the given range, then clusterSize - givenRange
   * elements are dropped
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(end: Int, clusterSize: Int)Seq[Option[Int]]" id="36713">rangeSplit</a><span class="delimiter">(</span><a title="Int" id="43780">end</a>: <span title="Int">Int</span>, <a title="Int" id="43781">clusterSize</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Seq[Option[Int]]">Seq</span><span class="delimiter">[</span>Option<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="43783">realSize</a> = <a href="#43781" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> scala.math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#43781" title="Int">clusterSize</a> <span title="(x: Int)Int">-</span> <a href="#43780" title="Int">end</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="43784">numPerNode</a> = <a href="#43780" title="Int">end</a> <span title="(x: Int)Int">/</span> <a href="#43783" title="Int">realSize</a>
    <span title="object None">None</span> <a href="#43805" title="(elem: Option[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[Int]],Option[Int],Seq[Option[Int]]])Seq[Option[Int]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#43783" title="Int">realSize</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; Some[Int])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]])scala.collection.immutable.IndexedSeq[Some[Int]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[Int],scala.collection.immutable.IndexedSeq[Some[Int]]]" class="delimiter">(</span><a title="Int" id="43905">i</a> =&gt; <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#43905" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#43784" title="Int">numPerNode</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36714">toCustomer</a><span class="delimiter">(</span><a title="Int" id="42223">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;cust%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#42223" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36715">toAuthor</a><span class="delimiter">(</span><a title="Int" id="44035">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44035" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author FNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="36716">toAuthorFname</a><span class="delimiter">(</span><a title="String" id="44041">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_fname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44041" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Author LNAME is generated from taking the author UUID and running
   * through another UUID
   */</span>
  <span class="keyword">def</span> <a title="(authorId: String)String" id="36717">toAuthorLname</a><span class="delimiter">(</span><a title="String" id="44047">authorId</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;author_lname_%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44047" title="String">authorId</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36718">toAddress</a><span class="delimiter">(</span><a title="Int" id="44053">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;address%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44053" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36719">toXact</a><span class="delimiter">(</span><a title="Int" id="44059">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;xact%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44059" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36720">toItem</a><span class="delimiter">(</span><a title="Int" id="44065">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;item%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44065" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(id: Int)String" id="36721">toOrder</a><span class="delimiter">(</span><a title="Int" id="44071">id</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
    <a href="#36709" title="(s: String)String">nameUuid</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;order%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#44071" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(itemId: Int)edu.berkeley.cs.scads.piql.tpcw.Item" id="36722">createItem</a><span class="delimiter">(</span><a title="Int" id="42173">itemId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#9711" title="edu.berkeley.cs.scads.piql.tpcw.Item">Item</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" id="44077">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44084" title="(i: Int, numItems: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateItem</a><span class="delimiter">(</span><a href="#42173" title="Int">itemId</a>, <a href="#37017" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO" class="delimiter">[</span><a href="ItemTO.java.html#9172" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">ItemTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = itemIds.getOrElseUpdate(itemId, uuid())</span>
    <span class="comment">//itemSubjectDateTitleIndexInserts += Tuple2(</span>
    <span class="comment">//  ItemSubjectDateTitleIndexKey(to.getI_subject,</span>
    <span class="comment">//    to.getI_pub_date,</span>
    <span class="comment">//    to.getI_title),</span>
    <span class="comment">//  ItemKey(idStr))</span>
    <span class="comment">//val author =  authors.get(to.getI_a_id)</span>

    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_FNAME, to.getI_title, idStr), NullRecord(true))</span>
    <span class="comment">//AuthorNameItemIndexInserts += Tuple2(AuthorNameItemIndexKey(author.get._2.A_LNAME, to.getI_title, idStr), NullRecord(true))</span>

    <span class="comment">//val tokens = to.getI_title.split(&quot;\\s+&quot;);</span>

    <span class="comment">//itemTitleIndexInserts ++= tokens.map(x =&gt; (ItemTitleIndexKey(x.toLowerCase, to.getI_title ,idStr), NullRecord(true)))</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Item" id="44078">item</a> = <a href="TpcwSchema.scala.html#35680" title="(I_ID: String)edu.berkeley.cs.scads.piql.tpcw.Item">Item</a><span class="delimiter">(</span><a href="#36720" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#42173" title="Int">itemId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21348" title="(x$1: String)Unit">I_TITLE</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44117" title="()java.lang.String">getI_title</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21351" title="(x$1: String)Unit">I_A_ID</a> = <a href="#36715" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44119" title="()Int">getI_a_id</a><span class="delimiter">)</span>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21354" title="(x$1: Long)Unit">I_PUB_DATE</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44121" title="()Long">getI_pub_date</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21357" title="(x$1: String)Unit">I_PUBLISHER</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44123" title="()java.lang.String">getI_publisher</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21360" title="(x$1: String)Unit">I_SUBJECT</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44125" title="()java.lang.String">getI_subject</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21363" title="(x$1: String)Unit">I_DESC</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44127" title="()java.lang.String">getI_desc</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21366" title="(x$1: Int)Unit">I_RELATED1</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44129" title="()Int">getI_related1</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21369" title="(x$1: Int)Unit">I_RELATED2</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44131" title="()Int">getI_related2</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21372" title="(x$1: Int)Unit">I_RELATED3</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44133" title="()Int">getI_related3</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21375" title="(x$1: Int)Unit">I_RELATED4</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44135" title="()Int">getI_related4</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21378" title="(x$1: Int)Unit">I_RELATED5</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44137" title="()Int">getI_related5</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21381" title="(x$1: String)Unit">I_THUMBNAIL</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44139" title="()java.lang.String">getI_thumbnail</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21384" title="(x$1: String)Unit">I_IMAGE</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44141" title="()java.lang.String">getI_image</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21387" title="(x$1: Double)Unit">I_SRP</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44143" title="()Double">getI_srp</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21390" title="(x$1: Double)Unit">I_COST</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44145" title="()Double">getI_cost</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21393" title="(x$1: Long)Unit">I_AVAIL</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44147" title="()Long">getI_avail</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21396" title="(x$1: Int)Unit">I_STOCK</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44149" title="()Int">getI_stock</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21399" title="(x$1: String)Unit">ISBN</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44151" title="()java.lang.String">getI_isbn</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21402" title="(x$1: Int)Unit">I_PAGE</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44153" title="()Int">getI_page</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21405" title="(x$1: String)Unit">I_BACKING</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44155" title="()java.lang.String">getI_backing</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>.<a href="TpcwSchema.scala.html#21408" title="(x$1: String)Unit">I_DIMENSION</a> = <a href="#44077" title="ch.ethz.systems.tpcw.populate.data.objects.ItemTO">to</a>.<a href="ItemTO.java.html#44157" title="()java.lang.String">getI_dimensions</a>
    <a href="#44078" title="edu.berkeley.cs.scads.piql.tpcw.Item">item</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(countryId: Int)edu.berkeley.cs.scads.piql.tpcw.Country" id="36723">createCountry</a><span class="delimiter">(</span><a title="Int" id="42151">countryId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#9714" title="edu.berkeley.cs.scads.piql.tpcw.Country">Country</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" id="44183">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44083" title="(i: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCountry</a><span class="delimiter">(</span><a href="#42151" title="Int">countryId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO" class="delimiter">[</span><a href="CountryTO.java.html#9164" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">CountryTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Country" id="44184">country</a> = <a href="TpcwSchema.scala.html#44202" title="(CO_ID: Int)edu.berkeley.cs.scads.piql.tpcw.Country">Country</a><span class="delimiter">(</span><a href="#42151" title="Int">countryId</a><span class="delimiter">)</span>
    <a href="#44184" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21256" title="(x$1: String)Unit">CO_NAME</a> = <a href="#44183" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44194" title="()java.lang.String">getCo_name</a>
    <a href="#44184" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21259" title="(x$1: Double)Unit">CO_EXCHANGE</a> = <a href="#44183" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44196" title="()Double">getCo_exchange</a>
    <a href="#44184" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>.<a href="TpcwSchema.scala.html#21262" title="(x$1: String)Unit">CO_CURRENCY</a> =  <a href="#44183" title="ch.ethz.systems.tpcw.populate.data.objects.CountryTO">to</a>.<a href="CountryTO.java.html#44198" title="()java.lang.String">getCo_currency</a>
    <a href="#44184" title="edu.berkeley.cs.scads.piql.tpcw.Country">country</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(orderId: Int)edu.berkeley.cs.scads.piql.tpcw.CcXact" id="36724">createXacts</a><span class="delimiter">(</span><a title="Int" id="42140">orderId</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#9729" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a> = <span class="delimiter">{</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(orderId, uuid())</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" id="44211">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44087" title="(i: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCCXacts</a><span class="delimiter">(</span><a href="#42140" title="Int">orderId</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO" class="delimiter">[</span><a href="CCXactsTO.java.html#9160" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">CCXactsTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.CcXact" id="44212">xact</a> = <a href="TpcwSchema.scala.html#36442" title="(CX_O_ID: String)edu.berkeley.cs.scads.piql.tpcw.CcXact">CcXact</a><span class="delimiter">(</span><a href="#36719" title="(id: Int)String">toXact</a><span class="delimiter">(</span><a href="#42140" title="Int">orderId</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21213" title="(x$1: String)Unit">CX_TYPE</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44227" title="()java.lang.String">getCx_type</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21216" title="(x$1: Int)Unit">CX_NUM</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44229" title="()Int">getCx_num</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21219" title="(x$1: String)Unit">CX_NAME</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44231" title="()java.lang.String">getCx_name</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21222" title="(x$1: Long)Unit">CX_EXPIRY</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44233" title="()Long">getCs_expiry</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21225" title="(x$1: String)Unit">CX_AUTH_ID</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44235" title="()java.lang.String">getCx_auth_id</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21228" title="(x$1: Double)Unit">CX_XACT_AMT</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44237" title="()Double">getCx_xact_amt</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21231" title="(x$1: Long)Unit">CX_XACT_DATE</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44239" title="()Long">getCx_xact_date</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>.<a href="TpcwSchema.scala.html#21234" title="(x$1: Int)Unit">CX_CO_ID</a> = <a href="#44211" title="ch.ethz.systems.tpcw.populate.data.objects.CCXactsTO">to</a>.<a href="CCXactsTO.java.html#44241" title="()Int">getCx_co_id</a>
    <a href="#44212" title="edu.berkeley.cs.scads.piql.tpcw.CcXact">xact</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Author" id="36725">createAuthor</a><span class="delimiter">(</span><a title="Int" id="42129">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#9717" title="edu.berkeley.cs.scads.piql.tpcw.Author">Author</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" id="44244">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44081" title="(aId: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAuthor</a><span class="delimiter">(</span><a href="#42129" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO" class="delimiter">[</span><a href="AuthorTO.java.html#9156" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">AuthorTO</a><span class="delimiter">]</span>

    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Author" id="44245">author</a> = <a href="TpcwSchema.scala.html#44269" title="(A_ID: String)edu.berkeley.cs.scads.piql.tpcw.Author">Author</a><span class="delimiter">(</span><a href="#36715" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42129" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44245" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21179" title="(x$1: String)Unit">A_FNAME</a> = <a href="#36716" title="(authorId: String)String">toAuthorFname</a><span class="delimiter">(</span><a href="#36715" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42129" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44245" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21182" title="(x$1: String)Unit">A_LNAME</a> = <a href="#36717" title="(authorId: String)String">toAuthorLname</a><span class="delimiter">(</span><a href="#36715" title="(id: Int)String">toAuthor</a><span class="delimiter">(</span><a href="#42129" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44245" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21185" title="(x$1: String)Unit">A_MNAME</a> = <a href="#44244" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44259" title="()java.lang.String">getA_mname</a>
    <a href="#44245" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21188" title="(x$1: Long)Unit">A_DOB</a> = <a href="#44244" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44263" title="()Long">getA_dob</a>
    <a href="#44245" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>.<a href="TpcwSchema.scala.html#21191" title="(x$1: String)Unit">A_BIO</a> = <a href="#44244" title="ch.ethz.systems.tpcw.populate.data.objects.AuthorTO">to</a>.<a href="AuthorTO.java.html#44265" title="()java.lang.String">getA_bio</a>

    <a href="#44245" title="edu.berkeley.cs.scads.piql.tpcw.Author">author</a>

    <span class="comment">//var author = (AuthorKey(uuid()), AuthorValue(to.getA_fname, to.getA_lname, to.getA_mname, to.getA_dob, to.getA_bio))</span>
    <span class="comment">//authors += id -&gt;  author</span>
    <span class="comment">//author</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Address" id="36726">createAddress</a><span class="delimiter">(</span><a title="Int" id="42118">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#9732" title="edu.berkeley.cs.scads.piql.tpcw.Address">Address</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" id="44280">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44080" title="(addrId: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateAddress</a><span class="delimiter">(</span><a href="#42118" title="Int">id</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO" class="delimiter">[</span><a href="AddressTO.java.html#9152" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">AddressTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = addressIds.getOrElseUpdate(id, uuid())</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Address" id="44281">address</a> = <a href="TpcwSchema.scala.html#44308" title="(ADDR_ID: String)edu.berkeley.cs.scads.piql.tpcw.Address">Address</a><span class="delimiter">(</span><a href="#36718" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#42118" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15847" title="(x$1: String)Unit">ADDR_STREET1</a> =  <a href="#44280" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44294" title="()java.lang.String">getAddr_street_1</a>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15850" title="(x$1: String)Unit">ADDR_STREET2</a> =  <a href="#44280" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44296" title="()java.lang.String">getAddr_street_2</a>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15853" title="(x$1: String)Unit">ADDR_CITY</a> =  <a href="#44280" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44298" title="()java.lang.String">getAddr_city</a>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15856" title="(x$1: String)Unit">ADDR_STATE</a> =  <a href="#44280" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44304" title="()java.lang.String">getAddr_state</a>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15859" title="(x$1: String)Unit">ADDR_ZIP</a> =  <a href="#44280" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44300" title="()java.lang.String">getAddr_zip</a>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>.<a href="TpcwSchema.scala.html#15862" title="(x$1: Int)Unit">ADDR_CO_ID</a> =  <a href="#44280" title="ch.ethz.systems.tpcw.populate.data.objects.AddressTO">to</a>.<a href="AddressTO.java.html#44302" title="()Int">getAddr_co_id</a>
    <a href="#44281" title="edu.berkeley.cs.scads.piql.tpcw.Address">address</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Customer" id="36727">createCustomer</a><span class="delimiter">(</span><a title="Int" id="42162">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> :  <a href="TpcwSchema.scala.html#9720" title="edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" id="44320">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44082" title="(i: Int, numCustomers: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateCustomer</a><span class="delimiter">(</span> <a href="#42162" title="Int">id</a> , <a href="#36684" title="=&gt; Int">numCustomers</a> <span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO" class="delimiter">[</span><a href="CustomerTO.java.html#9168" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">CustomerTO</a><span class="delimiter">]</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Customer" id="44321">customer</a> = <a href="TpcwSchema.scala.html#44379" title="(C_UNAME: String)edu.berkeley.cs.scads.piql.tpcw.Customer">Customer</a><span class="delimiter">(</span><a href="#36714" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44343" title="()Int">getC_id</a><span class="delimiter">)</span><span class="delimiter">)</span>   <span class="comment">//used naming convention instead of UUID</span>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21284" title="(x$1: String)Unit">C_PASSWD</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44347" title="()java.lang.String">getC_passwd</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21287" title="(x$1: String)Unit">C_FNAME</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44349" title="()java.lang.String">getC_fname</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21290" title="(x$1: String)Unit">C_LNAME</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44351" title="()java.lang.String">getC_lname</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21293" title="(x$1: String)Unit">C_ADDR_ID</a> = <a href="#36718" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44353" title="()Int">getC_addr_id</a><span class="delimiter">)</span>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21296" title="(x$1: String)Unit">C_PHONE</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44355" title="()Int">getC_phone</a>.<span title="()java.lang.String">toString</span>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21299" title="(x$1: String)Unit">C_EMAIL</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44357" title="()java.lang.String">getC_email</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21302" title="(x$1: Long)Unit">C_SINCE</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44359" title="()Long">getC_since</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21305" title="(x$1: Long)Unit">C_LAST_VISIT</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44361" title="()Long">getC_last_visit</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21308" title="(x$1: Long)Unit">C_LOGIN</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44363" title="()Long">getC_login</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21311" title="(x$1: Long)Unit">C_EXPIRATION</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44365" title="()Long">getC_expiration</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21314" title="(x$1: Double)Unit">C_DISCOUNT</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44367" title="()Double">getC_discount</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21317" title="(x$1: Double)Unit">C_BALANCE</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44369" title="()Double">getC_balance</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21320" title="(x$1: Double)Unit">C_YTD_PMT</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44371" title="()Double">getC_ytd_pmt</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21323" title="(x$1: Long)Unit">C_BIRTHDATE</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44373" title="()Long">getC_birthday</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>.<a href="TpcwSchema.scala.html#21326" title="(x$1: String)Unit">C_DATA</a> = <a href="#44320" title="ch.ethz.systems.tpcw.populate.data.objects.CustomerTO">to</a>.<a href="CustomerTO.java.html#44375" title="()java.lang.String">getC_data</a>
    <a href="#44321" title="edu.berkeley.cs.scads.piql.tpcw.Customer">customer</a>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(id: Int)edu.berkeley.cs.scads.piql.tpcw.Order" id="36728">createOrder</a><span class="delimiter">(</span><a title="Int" id="42202">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <a href="TpcwSchema.scala.html#9723" title="edu.berkeley.cs.scads.piql.tpcw.Order">Order</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" id="44400">to</a> = <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44085" title="(i: Int, numCustomers: Int, numItemLines: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrder</a><span class="delimiter">(</span><a href="#42202" title="Int">id</a>, <a href="#36684" title="=&gt; Int">numCustomers</a>, <a href="#36694" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO" class="delimiter">[</span><a href="OrderTO.java.html#9180" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">OrderTO</a><span class="delimiter">]</span>
    <span class="comment">//val idStr = orderIds.getOrElseUpdate(id, uuid())</span>
    <span class="comment">//customerOrderIndexInserts += Tuple2(CustomerOrderIndex(&quot;cust&quot; + to.getO_c_id, to.getO_date, idStr), NullRecord(true))</span>
    <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.Order" id="44401">order</a> = <a href="TpcwSchema.scala.html#35820" title="(O_ID: String)edu.berkeley.cs.scads.piql.tpcw.Order">Order</a><span class="delimiter">(</span><a href="#36721" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42202" title="Int">id</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21465" title="(x$1: String)Unit">O_C_UNAME</a> = <a href="#36714" title="(id: Int)String">toCustomer</a><span class="delimiter">(</span><a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44426" title="()Int">getO_c_id</a><span class="delimiter">)</span>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21468" title="(x$1: Long)Unit">O_DATE_Time</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44428" title="()Long">getO_date</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21471" title="(x$1: Double)Unit">O_SUB_TOTAL</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44430" title="()Double">getO_sub_total</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21474" title="(x$1: Double)Unit">O_TAX</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44432" title="()Double">getO_tax</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21477" title="(x$1: Double)Unit">O_TOTAL</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44434" title="()Double">getO_total</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21480" title="(x$1: String)Unit">O_SHIP_TYPE</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44436" title="()java.lang.String">getO_ship_type</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21483" title="(x$1: Long)Unit">O_SHIP_DATE</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44438" title="()Long">getO_ship_date</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21486" title="(x$1: String)Unit">O_BILL_ADDR_ID</a> = <a href="#36718" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44440" title="()Int">getO_bill_addr_id</a><span class="delimiter">)</span>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21489" title="(x$1: String)Unit">O_SHIP_ADDR_ID</a> = <a href="#36718" title="(id: Int)String">toAddress</a><span class="delimiter">(</span><a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44442" title="()Int">getO_ship_addr_id</a><span class="delimiter">)</span>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>.<a href="TpcwSchema.scala.html#21492" title="(x$1: String)Unit">O_STATUS</a> = <a href="#44400" title="ch.ethz.systems.tpcw.populate.data.objects.OrderTO">to</a>.<a href="OrderTO.java.html#44444" title="()java.lang.String">getO_status</a>
    <a href="#44401" title="edu.berkeley.cs.scads.piql.tpcw.Order">order</a>
  <span class="delimiter">}</span>

<span class="comment">//  def createCustomerOrderIndex(order: (OrdersKey, OrdersValue)) : (CustomerOrderIndex, NullRecord) = {</span>
<span class="comment">//    (CustomerOrderIndex(order._2.O_C_ID, order._2.O_DATE_Time, order._1.O_ID), NullRecord(true))</span>
<span class="comment">//  }</span>


  <span class="keyword">def</span> <a title="(id: Int)Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]" id="36729">createOrderline</a><span class="delimiter">(</span><a title="Int" id="42191">id</a> : <span title="Int">Int</span><span class="delimiter">)</span> : <span title="Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">Seq</span><span class="delimiter">[</span>OrderLine<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]" id="44447">orders</a> : <span title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">Seq</span><span class="delimiter">[</span>OrderLineTO<span class="delimiter">]</span> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#36694" title="=&gt; scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]])Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO,scala.collection.immutable.IndexedSeq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]]" class="delimiter">(</span> <a href="Generator.java.html#9134" title="object ch.ethz.systems.tpcw.populate.data.Generator">Generator</a>.<a href="Generator.java.html#44086" title="(orderLineId: Int, orderId: Int, numItems: Int)ch.ethz.systems.tpcw.populate.data.objects.AbstractTO">generateOrderLine</a><span class="delimiter">(</span><a href="#42191" title="Int">id</a>,<a href="#44558" title="Int">_</a>, <a href="#37017" title="=&gt; Int">numItems</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" class="delimiter">[</span><a href="OrderLineTO.java.html#9176" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">OrderLineTO</a><span class="delimiter">]</span><span class="delimiter">)</span>

    <span class="keyword">for</span><span class="delimiter">(</span> <span class="delimiter">(</span><a title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO" id="44687">order</a>, <a title="Int" id="44688">idx</a><span class="delimiter">)</span> &lt;- <a href="#44447" title="Seq[ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO]">orders</a>.<a href="#44655" title="(f: (ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int) =&gt; edu.berkeley.cs.scads.piql.tpcw.OrderLine)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO, Int)],edu.berkeley.cs.scads.piql.tpcw.OrderLine,Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]])Seq[edu.berkeley.cs.scads.piql.tpcw.OrderLine]">zipWithIndex</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.tpcw.OrderLine" id="44689">orderline</a> = <a href="TpcwSchema.scala.html#44692" title="(OL_O_ID: String, OL_ID: Int)edu.berkeley.cs.scads.piql.tpcw.OrderLine">OrderLine</a><span class="delimiter">(</span><a href="#36721" title="(id: Int)String">toOrder</a><span class="delimiter">(</span><a href="#42191" title="Int">id</a><span class="delimiter">)</span>, <a href="#44688" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <a href="#44689" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21434" title="(x$1: String)Unit">OL_I_ID</a> = <a href="#36720" title="(id: Int)String">toItem</a><span class="delimiter">(</span><a href="#44687" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44574" title="()Int">getOl_i_id</a><span class="delimiter">)</span>
      <a href="#44689" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21437" title="(x$1: Int)Unit">OL_QTY</a> = <a href="#44687" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44576" title="()Int">getOl_qty</a>
      <a href="#44689" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21440" title="(x$1: Double)Unit">OL_DISCOUNT</a> = <a href="#44687" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44578" title="()Double">getOl_discount</a>
      <a href="#44689" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>.<a href="TpcwSchema.scala.html#21443" title="(x$1: String)Unit">OL_COMMENT</a> =   <a href="#44687" title="ch.ethz.systems.tpcw.populate.data.objects.OrderLineTO">order</a>.<a href="OrderLineTO.java.html#44580" title="()java.lang.String">getOl_comments</a>
      <a href="#44689" title="edu.berkeley.cs.scads.piql.tpcw.OrderLine">orderline</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>