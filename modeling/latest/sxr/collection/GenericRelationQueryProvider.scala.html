<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>collection/GenericRelationQueryProvider.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> modeling

<span class="keyword">import</span> storage._
<span class="keyword">import</span> perf._
<span class="keyword">import</span> comm._
<span class="keyword">import</span> piql.plans._
<span class="keyword">import</span> piql.opt._
<span class="keyword">import</span> piql.scadr._
<span class="keyword">import</span> perf.scadr._
<span class="keyword">import</span> deploylib.ec2._
<span class="keyword">import</span> avro.marker._
<span class="keyword">import</span> avro.runtime._

<span class="keyword">import</span> net.lag.logging.Logger
<span class="keyword">import</span> scala.util.Random
<span class="keyword">import</span> scala.collection.mutable.ArrayBuffer

<span class="keyword">trait</span> <a title="trait DataMaker extends java.lang.Object with ScalaObject" id="9589">DataMaker</a> <span title="ScalaObject" class="delimiter">{</span><span class="keyword">var</span> <a title="=&gt; String" id="14804">data</a>: <span title="String">String</span>; <span class="keyword">def</span> <a title="(size: Int)DataMaker.this.type" id="14805">withDataSize</a><span class="delimiter">(</span><a title="Int" id="14905">size</a>: <span title="Int">Int</span><span class="delimiter">)</span>:<span class="keyword">this</span>.<span class="keyword">type</span> =
  <span class="delimiter">{</span><a href="#14804" title="(x$1: String)Unit">data</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;*&quot;</span> <span title="(n: Int)String">*</span> <a href="#14905" title="Int">size</a>; <a href="#9589" title="DataMaker.this.type" class="keyword">this</a><span class="delimiter">}</span><span class="delimiter">}</span>
case <span class="keyword">class</span> <a title="class R1 extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroPair with edu.berkeley.cs.scads.piql.modeling.DataMaker with ScalaObject with Product with Serializable" id="37676">R1</a><a href="#37676" title="ScalaObject" class="delimiter">(</a><a href="#37676" title="()edu.berkeley.cs.scads.piql.modeling.R1" id="85537" class="keyword">var</a> <a title="Int" id="28707">f1</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroPair">AvroPair</span> <span class="keyword">with</span> <a href="#9589" title="edu.berkeley.cs.scads.piql.modeling.DataMaker">DataMaker</a> <span class="delimiter">{</span> <span class="keyword">var</span> <a title="String" id="25796">data</a>: <span title="String">String</span> = _ <span class="delimiter">}</span>
case <span class="keyword">class</span> <a title="class R2 extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroPair with edu.berkeley.cs.scads.piql.modeling.DataMaker with ScalaObject with Product with Serializable" id="37672">R2</a><a href="#37672" title="ScalaObject" class="delimiter">(</a><a href="#37672" title="()edu.berkeley.cs.scads.piql.modeling.R2" id="85547" class="keyword">var</a> <a title="Int" id="34236">f1</a>: <span title="Int">Int</span>, <span class="keyword">var</span> <a title="Int" id="34237">f2</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroPair">AvroPair</span> <span class="keyword">with</span> <a href="#9589" title="edu.berkeley.cs.scads.piql.modeling.DataMaker">DataMaker</a> <span class="delimiter">{</span> <span class="keyword">var</span> <a title="String" id="26089">data</a>: <span title="String">String</span> = _ <span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class RandomNumber extends edu.berkeley.cs.scads.piql.modeling.ParameterGenerator with ScalaObject with Product with Serializable" id="37668">RandomNumber</a><a href="#37668" title="ScalaObject" class="delimiter">(</a><a title="Int" id="30260">numTuples</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="QueryRunnerTask.scala.html#9622" title="edu.berkeley.cs.scads.piql.modeling.ParameterGenerator">ParameterGenerator</a> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(rand: scala.util.Random)(Int, None.type)" id="26194">getValue</a><span class="delimiter">(</span><a title="scala.util.Random" id="26199">rand</a>: <span title="scala.util.Random">Random</span><span class="delimiter">)</span> = <span title="(_1: Int, _2: None.type)(Int, None.type)" class="delimiter">(</span><a href="#26199" title="scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#30260" title="=&gt; Int">numTuples</a><span class="delimiter">)</span>, <span title="object None">None</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class RandomR1List extends edu.berkeley.cs.scads.piql.modeling.ParameterGenerator with ScalaObject with Product with Serializable" id="37664">RandomR1List</a><a href="#37664" title="ScalaObject" class="delimiter">(</a><a title="Int" id="30275">numTuples</a>: <span title="Int">Int</span>, <a title="IndexedSeq[Int]" id="30276">cardinalityList</a>: <span title="IndexedSeq[Int]">IndexedSeq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="QueryRunnerTask.scala.html#9622" title="edu.berkeley.cs.scads.piql.modeling.ParameterGenerator">ParameterGenerator</a> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(rand: scala.util.Random)(scala.collection.mutable.ArrayBuffer[scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.piql.modeling.R1]], Some[Int])" id="27700">getValue</a><span class="delimiter">(</span><a title="scala.util.Random" id="27707">rand</a>: <span title="scala.util.Random">Random</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="27710">cardinality</a> = <a href="#30276" title="(idx: Int)Int">cardinalityList</a><span class="delimiter">(</span><a href="#27707" title="scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#30276" title="=&gt; IndexedSeq[Int]">cardinalityList</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(_1: scala.collection.mutable.ArrayBuffer[scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.piql.modeling.R1]], _2: Some[Int])(scala.collection.mutable.ArrayBuffer[scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.piql.modeling.R1]], Some[Int])" class="delimiter">(</span><span title="object scala.collection.mutable.ArrayBuffer">ArrayBuffer</span>.<span title="(n: Int)(elem: =&gt; scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.piql.modeling.R1])scala.collection.mutable.ArrayBuffer[scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.piql.modeling.R1]]">fill</span><span class="delimiter">(</span><a href="#27710" title="Int">cardinality</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="(elems: edu.berkeley.cs.scads.piql.modeling.R1*)scala.collection.mutable.ArrayBuffer[edu.berkeley.cs.scads.piql.modeling.R1]">ArrayBuffer</span><span class="delimiter">(</span><a href="#37676" title="(f1: Int)edu.berkeley.cs.scads.piql.modeling.R1">R1</a><span class="delimiter">(</span><a href="#27707" title="scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#30275" title="=&gt; Int">numTuples</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#27710" title="Int">cardinality</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class GenericQueryProvider extends edu.berkeley.cs.scads.piql.modeling.QueryProvider with ScalaObject" id="9602">GenericQueryProvider</a> <a href="#9602" title="ScalaObject" class="keyword">extends</a> <a href="QueryRunnerTask.scala.html#9635" title="edu.berkeley.cs.scads.piql.modeling.QueryProvider">QueryProvider</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="28834">logger</a> = <span title="()net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster, executor: edu.berkeley.cs.scads.piql.package.QueryExecutor)IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]" id="28836">getQueryList</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29136">cluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span>, <a title="edu.berkeley.cs.scads.piql.package.QueryExecutor" id="29137">executor</a>: <span title="edu.berkeley.cs.scads.piql.package.QueryExecutor">QueryExecutor</span><span class="delimiter">)</span>: <span title="IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">IndexedSeq</span><span class="delimiter">[</span>QuerySpec<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29230">clusterConfig</a> = <a href="#29136" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="(name: String, seqNumber: Option[Int], timeout: Long, unit: java.util.concurrent.TimeUnit)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">awaitChild</span><span class="delimiter">(</span><span title="java.lang.String(&quot;clusterReady&quot;)" class="string">&quot;clusterReady&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask" id="29231">loaderConfig</a> = classOf<span title="java.lang.Class[edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask](classOf[edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask])" class="delimiter">[</span>GenericRelationLoaderTask<span class="delimiter">]</span>.<span title="()edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask">newInstance</span>.<span title="(data: Array[Byte])edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask">parse</span><span class="delimiter">(</span><a href="#29230" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterConfig</a>.<span title="=&gt; Array[Byte]">data</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2]" id="29232">r2</a> = <a href="#29136" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String)(implicit evidence$7: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">getNamespace</span><span title="(ns: String)(implicit evidence$7: Manifest[edu.berkeley.cs.scads.piql.modeling.R2])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2]" class="delimiter">[</span><a href="#37672" title="edu.berkeley.cs.scads.piql.modeling.R2">R2</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.modeling.R2]" class="delimiter">(</span><span title="java.lang.String(&quot;R2&quot;)" class="string">&quot;R2&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.RandomNumber" id="29233">randomNumber</a> = <a href="#37668" title="(numTuples: Int)edu.berkeley.cs.scads.piql.modeling.RandomNumber">RandomNumber</a><span class="delimiter">(</span><a href="#29231" title="edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask">loaderConfig</a>.<a href="#29639" title="=&gt; Int">numTuples</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.RandomR1List" id="29234">inputSizes</a> = <a href="#37664" title="(numTuples: Int, cardinalityList: IndexedSeq[Int])edu.berkeley.cs.scads.piql.modeling.RandomR1List">RandomR1List</a><span class="delimiter">(</span><a href="#29231" title="edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask">loaderConfig</a>.<a href="#29639" title="=&gt; Int">numTuples</a>, <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">50</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <span title="Int(500)" class="int">500</span> <span title="(step: Int)scala.collection.immutable.Range">by</span> <span title="Int(50)" class="int">50</span> <span title="scala.collection.immutable.IndexedSeq[Int]">toIndexedSeq</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.CardinalityList" id="29235">limits</a> = <a href="QueryRunnerTask.scala.html#30952" title="(values: IndexedSeq[Int])edu.berkeley.cs.scads.piql.modeling.CardinalityList">CardinalityList</a><span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">50</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <span title="Int(500)" class="int">500</span> <span title="(step: Int)scala.collection.immutable.Range">by</span> <span title="Int(50)" class="int">50</span> <span title="scala.collection.immutable.IndexedSeq[Int]">toIndexedSeq</span><span class="delimiter">)</span>
    <span title="(requirement: Boolean, message: =&gt; Any)Unit">require</span><span class="delimiter">(</span><a href="#29231" title="edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask">loaderConfig</a>.<a href="#37647" title="=&gt; Int">maxCardinality</a> <span title="(x: Int)Boolean">&gt;=</span> <a href="#29235" title="edu.berkeley.cs.scads.piql.modeling.CardinalityList">limits</a>.<a href="QueryRunnerTask.scala.html#30954" title="=&gt; IndexedSeq[Int]">values</a>.<span title="(implicit cmp: Ordering[Int])Int">max</span>, <span title="java.lang.String(&quot;max cardinality of cluster is too small for specified limits&quot;)" class="string">&quot;max cardinality of cluster is too small for specified limits&quot;</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(ord: Int)edu.berkeley.cs.scads.piql.plans.ParameterLimit" id="29236">lim</a><span class="delimiter">(</span><a title="Int" id="32739">ord</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="edu.berkeley.cs.scads.piql.plans.ParameterLimit" class="keyword">new</span> <span title="edu.berkeley.cs.scads.piql.plans.ParameterLimit">ParameterLimit</span><span class="delimiter">(</span><a href="#32739" title="Int">ord</a>, <span title="Int(100000)" class="int">100000</span><span class="delimiter">)</span>
    <a href="QueryRunnerTask.scala.html#32789" title="(query: edu.berkeley.cs.scads.piql.opt.OptimizedQuery, paramGenerators: Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator])edu.berkeley.cs.scads.piql.modeling.QuerySpec">QuerySpec</a><span class="delimiter">(</span>
      <span title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" class="keyword">new</span> <span title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery">OptimizedQuery</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;indexScanQuery&quot;</span>,
			 <span title="(count: edu.berkeley.cs.scads.piql.plans.Limit, child: edu.berkeley.cs.scads.piql.plans.QueryPlan)edu.berkeley.cs.scads.piql.plans.LocalStopAfter">LocalStopAfter</span><span class="delimiter">(</span><a href="#29236" title="(ord: Int)edu.berkeley.cs.scads.piql.plans.ParameterLimit">lim</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>,
			   <span title="(namespace: edu.berkeley.cs.scads.piql.package.Namespace, keyPrefix: edu.berkeley.cs.scads.piql.package.KeyGenerator, limit: edu.berkeley.cs.scads.piql.plans.Limit, ascending: Boolean)edu.berkeley.cs.scads.piql.plans.IndexScan">IndexScan</span><span class="delimiter">(</span><a href="#29232" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2])edu.berkeley.cs.scads.piql.package#Namespace">r2</a>, <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">1.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span> <a href="#33004" title="(x: edu.berkeley.cs.scads.piql.plans.ParameterValue)List[edu.berkeley.cs.scads.piql.plans.ParameterValue]">::</a> <span title="object Nil">Nil</span>, <a href="#29236" title="(ord: Int)edu.berkeley.cs.scads.piql.plans.ParameterLimit">lim</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>,
			 <a href="#29137" title="edu.berkeley.cs.scads.piql.package.QueryExecutor">executor</a><span class="delimiter">)</span>,
      <span title="(elems: Product with Serializable with edu.berkeley.cs.scads.piql.modeling.ParameterGenerator*)scala.collection.immutable.Vector[Product with Serializable with edu.berkeley.cs.scads.piql.modeling.ParameterGenerator]">Vector</span><span class="delimiter">(</span><a href="#29235" title="edu.berkeley.cs.scads.piql.modeling.CardinalityList">limits</a>, <a href="#29233" title="edu.berkeley.cs.scads.piql.modeling.RandomNumber">randomNumber</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#32771" title="(x: edu.berkeley.cs.scads.piql.modeling.QuerySpec)List[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">::</a>
    <a href="QueryRunnerTask.scala.html#32789" title="(query: edu.berkeley.cs.scads.piql.opt.OptimizedQuery, paramGenerators: Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator])edu.berkeley.cs.scads.piql.modeling.QuerySpec">QuerySpec</a><span class="delimiter">(</span>
      <span title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" class="keyword">new</span> <span title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery">OptimizedQuery</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;indexLookupJoin&quot;</span>,
			 <span title="(namespace: edu.berkeley.cs.scads.piql.package.Namespace, key: edu.berkeley.cs.scads.piql.package.KeyGenerator, child: edu.berkeley.cs.scads.piql.plans.QueryPlan)edu.berkeley.cs.scads.piql.plans.IndexLookupJoin">IndexLookupJoin</span><span class="delimiter">(</span><a href="#29232" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2])edu.berkeley.cs.scads.piql.package#Namespace">r2</a>, 
					 <span title="(recordPosition: Int, fieldPosition: Int)edu.berkeley.cs.scads.piql.plans.AttributeValue">AttributeValue</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#33680" title="(x: Product with Serializable with edu.berkeley.cs.scads.piql.plans.Value)List[Product with Serializable with edu.berkeley.cs.scads.piql.plans.Value]">::</a> <span title="(v: Any)edu.berkeley.cs.scads.piql.plans.ConstantValue">ConstantValue</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#33715" title="(x: edu.berkeley.cs.scads.piql.plans.ConstantValue)List[edu.berkeley.cs.scads.piql.plans.ConstantValue]">::</a> <span title="object Nil">Nil</span>,
					 <span title="(parameterOrdinal: Int, wrap: Boolean)edu.berkeley.cs.scads.piql.plans.LocalIterator">LocalIterator</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>,
			 <a href="#29137" title="edu.berkeley.cs.scads.piql.package.QueryExecutor">executor</a><span class="delimiter">)</span>,
      <span title="(elems: edu.berkeley.cs.scads.piql.modeling.RandomR1List*)scala.collection.immutable.Vector[edu.berkeley.cs.scads.piql.modeling.RandomR1List]">Vector</span><span class="delimiter">(</span><a href="#29234" title="edu.berkeley.cs.scads.piql.modeling.RandomR1List">inputSizes</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#33548" title="(x: edu.berkeley.cs.scads.piql.modeling.QuerySpec)List[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">::</a>
    <a href="QueryRunnerTask.scala.html#32789" title="(query: edu.berkeley.cs.scads.piql.opt.OptimizedQuery, paramGenerators: Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator])edu.berkeley.cs.scads.piql.modeling.QuerySpec">QuerySpec</a><span class="delimiter">(</span>
      <span title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" class="keyword">new</span> <span title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery">OptimizedQuery</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;indexMergeJoin&quot;</span>,
			 <span title="(namespace: edu.berkeley.cs.scads.piql.package.Namespace, keyPrefix: edu.berkeley.cs.scads.piql.package.KeyGenerator, sortFields: Seq[edu.berkeley.cs.scads.piql.plans.Value], limit: edu.berkeley.cs.scads.piql.plans.Limit, ascending: Boolean, child: edu.berkeley.cs.scads.piql.plans.QueryPlan)edu.berkeley.cs.scads.piql.plans.IndexMergeJoin">IndexMergeJoin</span><span class="delimiter">(</span><a href="#29232" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2])edu.berkeley.cs.scads.piql.package#Namespace">r2</a>, 
					<span title="(recordPosition: Int, fieldPosition: Int)edu.berkeley.cs.scads.piql.plans.AttributeValue">AttributeValue</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#33942" title="(x: Product with Serializable with edu.berkeley.cs.scads.piql.plans.Value)List[Product with Serializable with edu.berkeley.cs.scads.piql.plans.Value]">::</a> <span title="(v: Any)edu.berkeley.cs.scads.piql.plans.ConstantValue">ConstantValue</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#33947" title="(x: edu.berkeley.cs.scads.piql.plans.ConstantValue)List[edu.berkeley.cs.scads.piql.plans.ConstantValue]">::</a> <span title="object Nil">Nil</span>,
					<span title="(recordPosition: Int, fieldPosition: Int)edu.berkeley.cs.scads.piql.plans.AttributeValue">AttributeValue</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#33972" title="(x: edu.berkeley.cs.scads.piql.plans.AttributeValue)List[edu.berkeley.cs.scads.piql.plans.AttributeValue]">::</a> <span title="object Nil">Nil</span>,
					<a href="#29236" title="(ord: Int)edu.berkeley.cs.scads.piql.plans.ParameterLimit">lim</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>,					
					<span title="Boolean(true)" class="keyword">true</span>,
					<span title="(parameterOrdinal: Int, wrap: Boolean)edu.berkeley.cs.scads.piql.plans.LocalIterator">LocalIterator</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>,
			 <a href="#29137" title="edu.berkeley.cs.scads.piql.package.QueryExecutor">executor</a><span class="delimiter">)</span>,
      <span title="(elems: Product with Serializable with edu.berkeley.cs.scads.piql.modeling.ParameterGenerator*)scala.collection.immutable.Vector[Product with Serializable with edu.berkeley.cs.scads.piql.modeling.ParameterGenerator]">Vector</span><span class="delimiter">(</span><a href="#29234" title="edu.berkeley.cs.scads.piql.modeling.RandomR1List">inputSizes</a>, <a href="#29235" title="edu.berkeley.cs.scads.piql.modeling.CardinalityList">limits</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#33777" title="(x: edu.berkeley.cs.scads.piql.modeling.QuerySpec)List[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">::</a> <span title="object Nil">Nil</span> <span title="scala.collection.immutable.IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">toIndexedSeq</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a href="#88949" title="class GenericRelationLoaderTask extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.scads.perf.DataLoadingTask with edu.berkeley.cs.avro.marker.AvroRecord with ScalaObject with Product with Serializable" id="37660">GenericRelationLoaderTask</a><a href="#37660" title="ScalaObject" class="delimiter">(</a><a href="#37660" title="()edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask" id="85557" class="keyword">var</a> <a title="Int" id="37642">numServers</a>: <span title="Int">Int</span> = <span title="Int(10)" class="int">10</span>,
				     <span class="keyword">var</span> <a title="Int" id="37643">numLoaders</a>: <span title="Int">Int</span> = <span title="Int(10)" class="int">10</span>,
				     <span class="keyword">var</span> <a title="Int" id="37644">replicationFactor</a>: <span title="Int">Int</span> = <span title="Int(2)" class="int">2</span>,
				     <span class="keyword">var</span> <a title="Int" id="37645">tuplesPerServer</a>: <span title="Int">Int</span> = <span title="Int(10000)" class="int">10000</span>,
				     <span class="keyword">var</span> <a title="Int" id="37646">dataSize</a>: <span title="Int">Int</span> = <span title="Int(128)" class="int">128</span>,
				     <span class="keyword">var</span> <a title="Int" id="37647">maxCardinality</a>: <span title="Int">Int</span> = <span title="Int(500)" class="int">500</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.scads.perf.DataLoadingTask">DataLoadingTask</span> <span class="keyword">with</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="String" id="29637">clusterAddress</a>: <span title="String">String</span> = _

  <span class="keyword">def</span> <a title="=&gt; Int" id="29639">numTuples</a> = <span class="delimiter">(</span><a href="#37642" title="=&gt; Int">numServers</a> <span title="(x: Int)Int">/</span> <a href="#37644" title="=&gt; Int">replicationFactor</a><span class="delimiter">)</span> <span title="(x: Int)Int">*</span> <a href="#37645" title="=&gt; Int">tuplesPerServer</a>

  <span class="keyword">def</span> <a title="()Unit" id="29640">run</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="34094">clusterRoot</a> = <span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#29637" title="=&gt; String">clusterAddress</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="34095">coordination</a> = <a href="#34094" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a>.<span title="(rpath: java.lang.String, tries: Int)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">getOrCreate</span><span class="delimiter">(</span><span title="java.lang.String(&quot;coordination/loaders&quot;)" class="string">&quot;coordination/loaders&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster" id="34096">cluster</a> = <span title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster" class="keyword">new</span> <span title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster">ExperimentalScadsCluster</span><span class="delimiter">(</span><a href="#34094" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a><span class="delimiter">)</span>
    <a href="#34096" title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster">cluster</a>.<span title="(clusterSize: Int)Unit">blockUntilReady</span><span class="delimiter">(</span><a href="#37642" title="=&gt; Int">numServers</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="34097">clientId</a> = <a href="#34095" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">coordination</a>.<span title="(barrierName: String, count: Int, timeout: Long, unit: java.util.concurrent.TimeUnit)Int">registerAndAwait</span><span class="delimiter">(</span><span title="java.lang.String(&quot;clientStart&quot;)" class="string">&quot;clientStart&quot;</span>, <a href="#37643" title="=&gt; Int">numLoaders</a><span class="delimiter">)</span>
    <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#34097" title="Int">clientId</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.IndexedSeq[Option[edu.berkeley.cs.scads.piql.modeling.R2]]" id="34125">keySplits</a> = <span title="object None">None</span> <a href="#34127" title="(elem: Option[edu.berkeley.cs.scads.piql.modeling.R2])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Some[edu.berkeley.cs.scads.piql.modeling.R2]],Option[edu.berkeley.cs.scads.piql.modeling.R2],scala.collection.immutable.IndexedSeq[Option[edu.berkeley.cs.scads.piql.modeling.R2]]])scala.collection.immutable.IndexedSeq[Option[edu.berkeley.cs.scads.piql.modeling.R2]]">+:</a> <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <span class="delimiter">(</span><a href="#37642" title="=&gt; Int">numServers</a><span title="(x: Int)Int">/</span><a href="#37644" title="=&gt; Int">replicationFactor</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: Int =&gt; Some[edu.berkeley.cs.scads.piql.modeling.R2])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],Some[edu.berkeley.cs.scads.piql.modeling.R2],scala.collection.immutable.IndexedSeq[Some[edu.berkeley.cs.scads.piql.modeling.R2]]])scala.collection.immutable.IndexedSeq[Some[edu.berkeley.cs.scads.piql.modeling.R2]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,Some[edu.berkeley.cs.scads.piql.modeling.R2],scala.collection.immutable.IndexedSeq[Some[edu.berkeley.cs.scads.piql.modeling.R2]]]" class="delimiter">(</span><a title="Int" id="34233">i</a> =&gt; <span title="(x: edu.berkeley.cs.scads.piql.modeling.R2)Some[edu.berkeley.cs.scads.piql.modeling.R2]">Some</span><span class="delimiter">(</span><a href="#37672" title="(f1: Int, f2: Int)edu.berkeley.cs.scads.piql.modeling.R2">R2</a><span class="delimiter">(</span><a href="#34233" title="Int">i</a> <span title="(x: Int)Int">*</span> <a href="#37645" title="=&gt; Int">tuplesPerServer</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.IndexedSeq[(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService])]" id="34126">partitions</a> = <a href="#34125" title="scala.collection.immutable.IndexedSeq[Option[edu.berkeley.cs.scads.piql.modeling.R2]]">keySplits</a>.<span title="(that: scala.collection.GenIterable[List[edu.berkeley.cs.scads.comm.StorageService]])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Option[edu.berkeley.cs.scads.piql.modeling.R2]],(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService]),scala.collection.immutable.IndexedSeq[(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService])]])scala.collection.immutable.IndexedSeq[(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService])]">zip</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService]),scala.collection.immutable.IndexedSeq[(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService])]]" class="delimiter">(</span><a href="#34096" title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster">cluster</a>.<span title="()List[edu.berkeley.cs.scads.comm.StorageService]">getAvailableServers</span>.<span title="(size: Int)Iterator[List[edu.berkeley.cs.scads.comm.StorageService]]">grouped</span><span class="delimiter">(</span><a href="#37644" title="=&gt; Int">replicationFactor</a><span class="delimiter">)</span>.<span title="=&gt; Seq[List[edu.berkeley.cs.scads.comm.StorageService]]">toSeq</span><span class="delimiter">)</span>
      <a href="#37660" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Creating R2 with partitions: %s&quot;)" class="string">&quot;Creating R2 with partitions: %s&quot;</span>, <a href="#34126" title="scala.collection.immutable.IndexedSeq[(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService])]">partitions</a><span class="delimiter">)</span>
      <a href="#34096" title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster">cluster</a>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String, servers: Seq[(Option[org.apache.avro.generic.IndexedRecord], Seq[edu.berkeley.cs.scads.comm.StorageService])])(implicit evidence$8: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">createNamespace</span><span title="(ns: String, servers: Seq[(Option[org.apache.avro.generic.IndexedRecord], Seq[edu.berkeley.cs.scads.comm.StorageService])])(implicit evidence$8: Manifest[edu.berkeley.cs.scads.piql.modeling.R2])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2]" class="delimiter">[</span><a href="#37672" title="edu.berkeley.cs.scads.piql.modeling.R2">R2</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.modeling.R2]" class="delimiter">(</span><span title="java.lang.String(&quot;R2&quot;)" class="string">&quot;R2&quot;</span>, <a href="#34126" title="scala.collection.immutable.IndexedSeq[(Option[edu.berkeley.cs.scads.piql.modeling.R2], List[edu.berkeley.cs.scads.comm.StorageService])]">partitions</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    
    <a href="#34095" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">coordination</a>.<span title="(barrierName: String, count: Int, timeout: Long, unit: java.util.concurrent.TimeUnit)Int">registerAndAwait</span><span class="delimiter">(</span><span title="java.lang.String(&quot;startBulkLoad&quot;)" class="string">&quot;startBulkLoad&quot;</span>, <a href="#37643" title="=&gt; Int">numLoaders</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2]" id="34098">r2</a> = <a href="#34096" title="edu.berkeley.cs.scads.perf.ExperimentalScadsCluster">cluster</a>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String)(implicit evidence$7: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">getNamespace</span><span title="(ns: String)(implicit evidence$7: Manifest[edu.berkeley.cs.scads.piql.modeling.R2])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2]" class="delimiter">[</span><a href="#37672" title="edu.berkeley.cs.scads.piql.modeling.R2">R2</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.modeling.R2]" class="delimiter">(</span><span title="java.lang.String(&quot;R2&quot;)" class="string">&quot;R2&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="34099">totalTuples</a> = <a href="#37645" title="=&gt; Int">tuplesPerServer</a> <span title="(x: Int)Int">*</span> <span class="delimiter">(</span><a href="#37642" title="=&gt; Int">numServers</a> <span title="(x: Int)Int">/</span> <a href="#37644" title="=&gt; Int">replicationFactor</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="34100">tuplesPerLoader</a> = <a href="#34099" title="Int">totalTuples</a> <span title="(x: Int)Int">/</span> <a href="#37643" title="=&gt; Int">numLoaders</a>
    <span class="keyword">val</span> <a title="Int" id="34101">startKey</a> = <a href="#34097" title="Int">clientId</a> <span title="(x: Int)Int">*</span> <a href="#34100" title="Int">tuplesPerLoader</a>
    <span class="keyword">val</span> <a title="Int" id="34102">endKey</a> = <span class="delimiter">(</span><a href="#34097" title="Int">clientId</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Int)Int">*</span> <a href="#34100" title="Int">tuplesPerLoader</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>

    <a href="#37660" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Loading %d keys from %d to %d out of %d total keys&quot;)" class="string">&quot;Loading %d keys from %d to %d out of %d total keys&quot;</span>, <a href="#34102" title="Int">endKey</a> <span title="(x: Int)Int">-</span> <a href="#34101" title="Int">startKey</a>, <a href="#34101" title="Int">startKey</a>, <a href="#34102" title="Int">endKey</a>, <a href="#34099" title="Int">totalTuples</a><span class="delimiter">)</span>
    <a href="#34098" title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.R2]">r2</a> <span title="(that: TraversableOnce[edu.berkeley.cs.scads.piql.modeling.R2])Unit">++=</span> <span class="delimiter">(</span><a href="#34101" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">startKey</a> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#34102" title="Int">endKey</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; scala.collection.GenTraversableOnce[edu.berkeley.cs.scads.piql.modeling.R2])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],edu.berkeley.cs.scads.piql.modeling.R2,TraversableOnce[edu.berkeley.cs.scads.piql.modeling.R2]])TraversableOnce[edu.berkeley.cs.scads.piql.modeling.R2]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,edu.berkeley.cs.scads.piql.modeling.R2,scala.collection.immutable.IndexedSeq[edu.berkeley.cs.scads.piql.modeling.R2]]" class="delimiter">(</span><a title="Int" id="37280">i</a> =&gt;
      <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#37647" title="=&gt; Int">maxCardinality</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; edu.berkeley.cs.scads.piql.modeling.R2)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],edu.berkeley.cs.scads.piql.modeling.R2,scala.collection.immutable.IndexedSeq[edu.berkeley.cs.scads.piql.modeling.R2]])scala.collection.immutable.IndexedSeq[edu.berkeley.cs.scads.piql.modeling.R2]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,edu.berkeley.cs.scads.piql.modeling.R2,scala.collection.immutable.IndexedSeq[edu.berkeley.cs.scads.piql.modeling.R2]]" class="delimiter">(</span><a title="Int" id="37380">j</a> =&gt; <a href="#37672" title="(f1: Int, f2: Int)edu.berkeley.cs.scads.piql.modeling.R2">R2</a><span class="delimiter">(</span><a href="#37280" title="Int">i</a>,<a href="#37380" title="Int">j</a><span class="delimiter">)</span>.<a href="#14805" title="(size: Int)edu.berkeley.cs.scads.piql.modeling.R2">withDataSize</a><span class="delimiter">(</span><a href="#37646" title="=&gt; Int">dataSize</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#34095" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">coordination</a>.<span title="(barrierName: String, count: Int, timeout: Long, unit: java.util.concurrent.TimeUnit)Int">registerAndAwait</span><span class="delimiter">(</span><span title="java.lang.String(&quot;bulkLoadFinished&quot;)" class="string">&quot;bulkLoadFinished&quot;</span>, <a href="#37643" title="=&gt; Int">numLoaders</a><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#34097" title="Int">clientId</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="object deploylib.ec2.ExperimentNotification">ExperimentNotification</span>.<span title="object deploylib.ec2.ExperimentNotification.completions">completions</span>.<span title="(subject: String, message: String)Unit">publish</span><span class="delimiter">(</span><span title="java.lang.String(&quot;generic cluster data load finished&quot;)" class="string">&quot;generic cluster data load finished&quot;</span>, <a href="#37660" title="(record: edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask)edu.berkeley.cs.avro.runtime.RichIndexedRecord[edu.berkeley.cs.scads.piql.modeling.GenericRelationLoaderTask]" class="keyword">this</a>.<span title="=&gt; String">toJson</span><span class="delimiter">)</span>
      <a href="#34094" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a>.<span title="(name: java.lang.String, data: Array[Byte], mode: org.apache.zookeeper.CreateMode)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">createChild</span><span title="Unit" class="delimiter">(</span><span title="java.lang.String(&quot;clusterReady&quot;)" class="string">&quot;clusterReady&quot;</span>, data=<a href="#37660" title="GenericRelationLoaderTask.this.type" class="keyword">this</a>.<span title="=&gt; Array[Byte]">toBytes</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>