<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>collection/QueryRunnerTask.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> modeling

<span class="keyword">import</span> avro.marker._
<span class="keyword">import</span> avro.runtime._
<span class="keyword">import</span> storage._
<span class="keyword">import</span> perf._
<span class="keyword">import</span> comm._
<span class="keyword">import</span> deploylib._

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> scala.util.Random
<span class="keyword">import</span> java.util.concurrent._
<span class="keyword">import</span> java.util.concurrent.atomic._
<span class="keyword">import</span> collection.<span title="object scala.collection.JavaConversions">JavaConversions</span>._

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class ParameterGenerator extends java.lang.Object with ScalaObject" id="10131">ParameterGenerator</a> <a href="#10131" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">def</span> <a title="(rand: scala.util.Random)(Any, Option[Int])" id="26199">getValue</a><span class="delimiter">(</span><a title="scala.util.Random" id="26211">rand</a>: <span title="scala.util.Random">Random</span><span class="delimiter">)</span>: <span title="(Any, Option[Int])" class="delimiter">(</span>Any, Option<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class CardinalityList extends edu.berkeley.cs.scads.piql.modeling.ParameterGenerator with ScalaObject with Product with Serializable" id="43443">CardinalityList</a><a href="#43443" title="ScalaObject" class="delimiter">(</a><a title="IndexedSeq[Int]" id="30995">values</a>: <span title="IndexedSeq[Int]">IndexedSeq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10131" title="edu.berkeley.cs.scads.piql.modeling.ParameterGenerator">ParameterGenerator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(rand: scala.util.Random)(Int, Some[Int])" id="30992">getValue</a><span class="delimiter">(</span><a title="scala.util.Random" id="33548">rand</a>: <span title="scala.util.Random">Random</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="33551">cardinality</a> = <a href="#30995" title="(idx: Int)Int">values</a><span class="delimiter">(</span><a href="#33548" title="scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#30995" title="=&gt; IndexedSeq[Int]">values</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(_1: Int, _2: Some[Int])(Int, Some[Int])" class="delimiter">(</span><a href="#33551" title="Int">cardinality</a>, <span title="(x: Int)Some[Int]">Some</span><span class="delimiter">(</span><a href="#33551" title="Int">cardinality</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class QuerySpec extends java.lang.Object with ScalaObject with Product with Serializable" id="43439">QuerySpec</a><a href="#43439" title="ScalaObject" class="delimiter">(</a><a title="edu.berkeley.cs.scads.piql.OptimizedQuery" id="32834">query</a>: <span title="edu.berkeley.cs.scads.piql.OptimizedQuery">OptimizedQuery</span>, <a title="Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator]" id="32835">paramGenerators</a>: <span title="Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator]">Seq</span><span class="delimiter">[</span>ParameterGenerator<span class="delimiter">]</span><span class="delimiter">)</span>


case <span class="keyword">class</span> <a href="#89029" title="class QueryDescription extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroRecord with ScalaObject with Product with Serializable" id="43435">QueryDescription</a><a href="#43435" title="ScalaObject" class="delimiter">(</a><a href="#43435" title="()edu.berkeley.cs.scads.piql.modeling.QueryDescription" id="85335" class="keyword">var</a> <a title="String" id="42008">queryName</a>: <span title="String">String</span>, <span class="keyword">var</span> <a title="Seq[Int]" id="42009">parameters</a>: <span title="Seq[Int]">Seq</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <span class="keyword">var</span> <a title="Int" id="42010">resultCardinality</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span>

case <span class="keyword">class</span> <a title="class Result extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroPair with ScalaObject with Product with Serializable" id="43431">Result</a><a href="#43431" title="ScalaObject" class="delimiter">(</a><a href="#43431" title="()edu.berkeley.cs.scads.piql.modeling.Result" id="85381" class="keyword">var</a> <a title="edu.berkeley.cs.scads.piql.modeling.QueryDescription" id="42673">queryDesc</a>: <a href="#43435" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">QueryDescription</a>, <span class="keyword">var</span> <a title="String" id="42674">hostname</a>: <span title="String">String</span>, <span class="keyword">var</span> <a title="Long" id="42675">timestamp</a>: <span title="Long">Long</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroPair">AvroPair</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Int" id="37928">iteration</a>: <span title="Int">Int</span> = _
  <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.piql.modeling.QueryRunnerTask" id="37931">clientConfig</a>: <a href="#43427" title="edu.berkeley.cs.scads.piql.modeling.QueryRunnerTask">QueryRunnerTask</a> = <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">var</span> <a title="edu.berkeley.cs.scads.perf.Histogram" id="37934">responseTimes</a>: <span title="edu.berkeley.cs.scads.perf.Histogram">Histogram</span> = <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">var</span> <a title="Int" id="37937">failedQueries</a>: <span title="Int">Int</span> = <span title="Int(0)" class="int">0</span>
<span class="delimiter">}</span>	

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class QueryProvider extends java.lang.Object with ScalaObject" id="10144">QueryProvider</a> <a href="#10144" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">def</span> <a title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster, executor: edu.berkeley.cs.scads.piql.QueryExecutor)IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]" id="28842">getQueryList</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29149">cluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span>, <a title="edu.berkeley.cs.scads.piql.QueryExecutor" id="29150">executor</a>: <span title="edu.berkeley.cs.scads.piql.QueryExecutor">QueryExecutor</span><span class="delimiter">)</span>: <span title="IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">IndexedSeq</span><span class="delimiter">[</span>QuerySpec<span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="comment">//TODO: Record cluster loader configuration</span>
<span class="comment">//TODO: Make executor variable</span>
case <span class="keyword">class</span> <a href="#91676" title="class QueryRunnerTask extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroRecord with edu.berkeley.cs.scads.perf.ReplicatedExperimentTask with ScalaObject with Product with Serializable" id="43427">QueryRunnerTask</a><a href="#43427" title="ScalaObject" class="delimiter">(</a><a href="#43427" title="()edu.berkeley.cs.scads.piql.modeling.QueryRunnerTask" id="85391" class="keyword">var</a> <a title="Int" id="43392">numClients</a>: <span title="Int">Int</span>,
			   <span class="keyword">var</span> <a title="String" id="43393">queryProvider</a>: <span title="String">String</span>,
			   <span class="keyword">var</span> <a title="Boolean" id="43409">traceIterators</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>,
			   <span class="keyword">var</span> <a title="Boolean" id="43410">traceMessages</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>,
			   <span class="keyword">var</span> <a title="Boolean" id="43411">traceQueries</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>,
			   <span class="keyword">var</span> <a title="Int" id="43412">iterations</a>: <span title="Int">Int</span> = <span title="Int(6)" class="int">6</span>,
			   <span class="keyword">var</span> <a title="Int" id="43413">iterationLengthMin</a>: <span title="Int">Int</span> = <span title="Int(10)" class="int">10</span>,
			   <span class="keyword">var</span> <a title="Int" id="43414">threads</a>: <span title="Int">Int</span> = <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
 <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroRecord">AvroRecord</span> <span class="keyword">with</span> <span title="edu.berkeley.cs.scads.perf.ReplicatedExperimentTask">ReplicatedExperimentTask</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="String" id="38016">clusterAddress</a>: <span title="String">String</span> = _
  <span class="keyword">var</span> <a title="String" id="38019">resultClusterAddress</a>: <span title="String">String</span> = _
  <span class="keyword">var</span> <a title="String" id="38022">experimentAddress</a>: <span title="String">String</span> = _

  <span class="keyword">def</span> <a title="()Unit" id="38024">run</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="38224">hostname</a> = java.net.<span title="object java.net.InetAddress">InetAddress</span>.<span title="()java.net.InetAddress">getLocalHost</span>.<span title="()java.lang.String">getHostName</span>

    <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Query Runner Task Starting&quot;)" class="string">&quot;Query Runner Task Starting&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.Result]" id="38225">results</a> = <span title="edu.berkeley.cs.scads.storage.ScadsCluster" class="keyword">new</span> <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">(</span><span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#38019" title="=&gt; String">resultClusterAddress</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String)(implicit evidence$7: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">getNamespace</span><span title="(ns: String)(implicit evidence$7: Manifest[edu.berkeley.cs.scads.piql.modeling.Result])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.Result]" class="delimiter">[</span><a href="#43431" title="edu.berkeley.cs.scads.piql.modeling.Result">Result</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.modeling.Result]" class="delimiter">(</span><span title="java.lang.String(&quot;queryRunnerResults&quot;)" class="string">&quot;queryRunnerResults&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="38226">experimentRoot</a> = <span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#38022" title="=&gt; String">experimentAddress</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="38227">coordination</a> = <a href="#38226" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">experimentRoot</a>.<span title="(rpath: java.lang.String, tries: Int)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">getOrCreate</span><span class="delimiter">(</span><span title="java.lang.String(&quot;coordination/clients&quot;)" class="string">&quot;coordination/clients&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="38228">clientId</a> = <a href="#38227" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">coordination</a>.<span title="(barrierName: String, count: Int, timeout: Long, unit: java.util.concurrent.TimeUnit)Int">registerAndAwait</span><span class="delimiter">(</span><span title="java.lang.String(&quot;clientStart&quot;)" class="string">&quot;clientStart&quot;</span>, <a href="#43392" title="=&gt; Int">numClients</a>, timeout=<span class="int">24</span>*<span class="int">60</span>*<span class="int">60</span><span title="Long(86400000L)">*</span><span class="int">1000</span><span class="delimiter">)</span>  <span class="comment">// 1 day</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="38229">clusterRoot</a> = <span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#38016" title="=&gt; String">clusterAddress</a><span class="delimiter">)</span>
    <a href="#38229" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a>.<a title="Option[Int]" id="39530">awaitChild</a><span class="delimiter">(</span><a title="java.lang.String(&quot;clusterReady&quot;)" id="39527" class="string">&quot;clusterReady&quot;</a>, timeout=<span class="int">24</span>*<span class="int">60</span>*<span class="int">60</span><a title="Long(86400000L)" id="39528">*</a><span class="int">1000</span><span class="delimiter">)</span> <span class="comment">// 1 day</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="38230">cluster</a> = <span title="edu.berkeley.cs.scads.storage.ScadsCluster" class="keyword">new</span> <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">(</span><a href="#38229" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="java.io.File" id="38231">traceFile</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><span title="java.lang.String(&quot;piqltrace.avro&quot;)" class="string">&quot;piqltrace.avro&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink" id="38232">traceSink</a> = <span title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink" class="keyword">new</span> <a href="../tracing/FileTraceSink.scala.html#10304" title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink">FileTraceSink</a><span class="delimiter">(</span><a href="#38231" title="java.io.File">traceFile</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.ParallelExecutor" id="38233">executor</a> =
      <span title="edu.berkeley.cs.scads.piql.ParallelExecutor" class="keyword">if</span><span class="delimiter">(</span><a href="#43409" title="=&gt; Boolean">traceIterators</a><span class="delimiter">)</span>
	      <a href="#39769" title="edu.berkeley.cs.scads.piql.ParallelExecutor with edu.berkeley.cs.scads.piql.modeling.TracingExecutor{}" class="keyword">new</a> <a title="anonymous class $anon extends edu.berkeley.cs.scads.piql.ParallelExecutor with edu.berkeley.cs.scads.piql.modeling.TracingExecutor" id="39769">ParallelExecutor</a> <span class="keyword">with</span> <a href="../tracing/TracingExecutor.scala.html#10318" title="edu.berkeley.cs.scads.piql.modeling.TracingExecutor">TracingExecutor</a> <span class="delimiter">{</span>
	        <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink" id="39775">sink</a> = <a href="#38232" title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink">traceSink</a>
	      <span class="delimiter">}</span>
      <span class="keyword">else</span>
	      <span title="edu.berkeley.cs.scads.piql.ParallelExecutor" class="keyword">new</span> <span title="edu.berkeley.cs.scads.piql.ParallelExecutor">ParallelExecutor</span>
    
    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#43410" title="=&gt; Boolean">traceMessages</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;registering listener...&quot;)" class="string">&quot;registering listener...&quot;</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.MessagePassingTracer" id="39790">messageTracer</a> = <span title="edu.berkeley.cs.scads.piql.modeling.MessagePassingTracer" class="keyword">new</span> <a href="../tracing/TracingMessageHandler.scala.html#10323" title="edu.berkeley.cs.scads.piql.modeling.MessagePassingTracer">MessagePassingTracer</a><span class="delimiter">(</span><a href="#38232" title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink">traceSink</a><span class="delimiter">)</span>
      <span title="object edu.berkeley.cs.scads.comm.MessageHandler">MessageHandler</span>.<span title="(listener: edu.berkeley.cs.scads.comm.MessageHandlerListener[edu.berkeley.cs.scads.comm.Message,edu.berkeley.cs.scads.comm.Message])Unit">registerListener</span><span class="delimiter">(</span><a href="#39790" title="edu.berkeley.cs.scads.piql.modeling.MessagePassingTracer">messageTracer</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]" id="38234">querySpecs</a> = <span title="object java.lang.Class">Class</span>.<span title="(x$1: java.lang.String)java.lang.Class[_]">forName</span><span class="delimiter">(</span><a href="#43393" title="=&gt; String">queryProvider</a><span class="delimiter">)</span>.<span title="()?0">newInstance</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="edu.berkeley.cs.scads.piql.modeling.QueryProvider" class="delimiter">[</span><a href="#10144" title="edu.berkeley.cs.scads.piql.modeling.QueryProvider">QueryProvider</a><span class="delimiter">]</span>.<a href="#28842" title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster, executor: edu.berkeley.cs.scads.piql.QueryExecutor)IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">getQueryList</a><span class="delimiter">(</span><a href="#38230" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>, <a href="#38233" title="edu.berkeley.cs.scads.piql.ParallelExecutor">executor</a><span class="delimiter">)</span>

    <a href="#38227" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">coordination</a>.<span title="(barrierName: String, count: Int, timeout: Long, unit: java.util.concurrent.TimeUnit)Int">registerAndAwait</span><span class="delimiter">(</span><span title="java.lang.String(&quot;startQueryRunning&quot;)" class="string">&quot;startQueryRunning&quot;</span>, <a href="#43392" title="=&gt; Int">numClients</a><span class="delimiter">)</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="40828">iteration</a> &lt;- <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(f: Int =&gt; Unit)Unit">to</span> <a href="#43412" title="=&gt; Int">iterations</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">//coordination.registerAndAwait(&quot;startIteration&quot; + iteration, numClients)</span>
      <span class="keyword">val</span> <a title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]" id="40829">responseTimes</a> = <span title="()java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]" class="keyword">new</span> <span title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">ConcurrentHashMap</span><span class="delimiter">[</span>QueryDescription, Histogram<span class="delimiter">]</span>
      <span class="keyword">val</span> <a title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]" id="40830">failedQueries</a> = <span title="()java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]" class="keyword">new</span> <span title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]">ConcurrentHashMap</span><span class="delimiter">[</span>QueryDescription, AtomicInteger<span class="delimiter">]</span>

      <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Registered Actor Count: %d&quot;)" class="string">&quot;Registered Actor Count: %d&quot;</span>, <span title="object edu.berkeley.cs.scads.comm.MessageHandler">MessageHandler</span>.<span title="=&gt; Int">registrySize</span><span class="delimiter">)</span>
      <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Late messages %d&quot;)" class="string">&quot;Late messages %d&quot;</span>, <span title="object edu.berkeley.cs.scads.comm.MessageHandler">MessageHandler</span>.<span title="=&gt; java.util.concurrent.atomic.AtomicLong">invalidMessageCount</span>.<span title="(x$1: Long)Long">getAndSet</span><span class="delimiter">(</span><span title="Long(0L)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Beginning iteration %d&quot;)" class="string">&quot;Beginning iteration %d&quot;</span>, <a href="#40828" title="Int">iteration</a><span class="delimiter">)</span>
      <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(itr: Iterable[Int])deploylib.ParallelSeq[Int]">to</span> <a href="#43414" title="=&gt; Int">threads</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; Unit)List[Unit]">pmap</span><span class="delimiter">(</span><a title="Int" id="41559">threadId</a> =&gt; <span class="delimiter">{</span>
	      <span class="keyword">val</span> <a title="java.lang.String" id="41560">seed</a> = java.net.<span title="object java.net.InetAddress">InetAddress</span>.<span title="()java.net.InetAddress">getLocalHost</span>.<span title="()java.lang.String">getHostName</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#41559" title="Int">threadId</a>
	      <span class="keyword">val</span> <a title="scala.util.Random" id="41561">rand</a> = <span title="(seed: Int)scala.util.Random" class="keyword">new</span> <span title="scala.util.Random">Random</span><span class="delimiter">(</span><a href="#41560" title="java.lang.String">seed</a>.<span title="()Int">hashCode</span><span class="delimiter">)</span>
	      <span class="keyword">val</span> <a title="Long" id="41562">runTime</a> = <a href="#43413" title="=&gt; Int">iterationLengthMin</a> <span title="(x: Int)Int">*</span> <span title="Int(60)" class="int">60</span> <span title="(x: Long)Long">*</span> <span title="Long(1000L)" class="long">1000L</span>
	      <span class="keyword">val</span> <a title="Long" id="41563">iterationStartTime</a> = <a href="#38025" title="=&gt; Long">getTime</a>
	      <span class="keyword">var</span> <a title="Int" id="41564">queryCounter</a> = <span title="Int(0)" class="int">0</span>

	      <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><a href="#38025" title="=&gt; Long">getTime</a> <span title="(x: Long)Long">-</span> <a href="#41563" title="Long">iterationStartTime</a> <span title="(x: Long)Boolean">&lt;</span> <a href="#41562" title="Long">runTime</a><span class="delimiter">)</span> <a href="#41565" title="()Unit" class="delimiter">{</a>
	        <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.QuerySpec" id="41795">querySpec</a> = <a href="#38234" title="(idx: Int)edu.berkeley.cs.scads.piql.modeling.QuerySpec">querySpecs</a><span class="delimiter">(</span><a href="#41561" title="scala.util.Random">rand</a>.<span title="(n: Int)Int">nextInt</span><span class="delimiter">(</span><a href="#38234" title="IndexedSeq[edu.berkeley.cs.scads.piql.modeling.QuerySpec]">querySpecs</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
	        <span class="keyword">val</span> <a title="Seq[(Any, Option[Int])]" id="41796">params</a> = <a href="#41795" title="edu.berkeley.cs.scads.piql.modeling.QuerySpec">querySpec</a>.<a href="#32835" title="=&gt; Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator]">paramGenerators</a>.<span title="(f: edu.berkeley.cs.scads.piql.modeling.ParameterGenerator =&gt; (Any, Option[Int]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[edu.berkeley.cs.scads.piql.modeling.ParameterGenerator],(Any, Option[Int]),Seq[(Any, Option[Int])]])Seq[(Any, Option[Int])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(Any, Option[Int]),Seq[(Any, Option[Int])]]" class="delimiter">(</span><a href="#41840" title="edu.berkeley.cs.scads.piql.modeling.ParameterGenerator">_</a>.<a href="#26199" title="(rand: scala.util.Random)(Any, Option[Int])">getValue</a><span class="delimiter">(</span><a href="#41561" title="scala.util.Random">rand</a><span class="delimiter">)</span><span class="delimiter">)</span>
	        <span class="keyword">val</span> <a title="Seq[Any]" id="41797">runParams</a> = <a href="#41796" title="Seq[(Any, Option[Int])]">params</a>.<span title="(f: (Any, Option[Int]) =&gt; Any)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(Any, Option[Int])],Any,Seq[Any]])Seq[Any]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Any,Seq[Any]]" class="delimiter">(</span><a href="#41915" title="(Any, Option[Int])">_</a>.<span title="=&gt; Any">_1</span><span class="delimiter">)</span>
	        <span class="keyword">val</span> <a title="Seq[Int]" id="41798">paramsDesc</a> = <a href="#41796" title="Seq[(Any, Option[Int])]">params</a>.<span title="(f: (Any, Option[Int]) =&gt; scala.collection.GenTraversableOnce[Int])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(Any, Option[Int])],Int,Seq[Int]])Seq[Int]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,Int,Seq[Int]]" class="delimiter">(</span><a href="#41951" title="(Any, Option[Int])">_</a>.<span title="(xo: Option[Int])Iterable[Int]">_2</span><span class="delimiter">)</span>
	        <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.QueryDescription" id="41799">queryDesc</a> = <a href="#43435" title="(queryName: String, parameters: Seq[Int], resultCardinality: Int)edu.berkeley.cs.scads.piql.modeling.QueryDescription">QueryDescription</a><span class="delimiter">(</span><a href="#41795" title="edu.berkeley.cs.scads.piql.modeling.QuerySpec">querySpec</a>.<a href="#32834" title="=&gt; edu.berkeley.cs.scads.piql.OptimizedQuery">query</a>.<span title="=&gt; Option[String]">name</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;unnamed&quot;)" class="string">&quot;unnamed&quot;</span><span class="delimiter">)</span>, <a href="#41798" title="Seq[Int]">paramsDesc</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

	        <span title="AnyVal" class="keyword">if</span><span class="delimiter">(</span><a href="#43411" title="=&gt; Boolean">traceQueries</a><span class="delimiter">)</span>
	          <a href="#38232" title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink">traceSink</a>.<a href="../tracing/FileTraceSink.scala.html#39766" title="(event: edu.berkeley.cs.scads.piql.modeling.TraceEvent)Boolean">recordEvent</a><span class="delimiter">(</span><a href="../schema.scala.html#42027" title="(queryName: String, params: Seq[Int], queryCounter: Int, start: Boolean)edu.berkeley.cs.scads.piql.modeling.QueryEvent">QueryEvent</a><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a>.<a href="#42008" title="=&gt; String">queryName</a>, <a href="#41798" title="Seq[Int]">paramsDesc</a>, <a href="#41564" title="Int">queryCounter</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>

	        <span class="keyword">val</span> <a title="Long" id="41800">startTime</a> = <a href="#38025" title="=&gt; Long">getTime</a>
	        <span class="keyword">try</span> <span class="delimiter">{</span>
	          <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.package.QueryResult" id="42074">results</a> = <a href="#41795" title="edu.berkeley.cs.scads.piql.modeling.QuerySpec">querySpec</a>.<a href="#32834" title="=&gt; edu.berkeley.cs.scads.piql.OptimizedQuery">query</a>.<span title="(args: Any*)edu.berkeley.cs.scads.piql.package.QueryResult">apply</span><span class="delimiter">(</span><a href="#41797" title="Seq[Any]">runParams</a>: _*<span class="delimiter">)</span>
	          <a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a>.<a href="#42010" title="(x$1: Int)Unit">resultCardinality</a> = <a href="#42074" title="edu.berkeley.cs.scads.piql.package.QueryResult">results</a>.<span title="=&gt; Int">size</span>
	          <span class="keyword">val</span> <a title="Long" id="42075">endTime</a> = <a href="#38025" title="=&gt; Long">getTime</a>

	          <span title="AnyVal" class="keyword">if</span><span class="delimiter">(</span><a href="#43411" title="=&gt; Boolean">traceQueries</a><span class="delimiter">)</span>
	            <a href="#38232" title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink">traceSink</a>.<a href="../tracing/FileTraceSink.scala.html#39766" title="(event: edu.berkeley.cs.scads.piql.modeling.TraceEvent)Boolean">recordEvent</a><span class="delimiter">(</span><a href="../schema.scala.html#42027" title="(queryName: String, params: Seq[Int], queryCounter: Int, start: Boolean)edu.berkeley.cs.scads.piql.modeling.QueryEvent">QueryEvent</a><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a>.<a href="#42008" title="=&gt; String">queryName</a>, <a href="#41798" title="Seq[Int]">paramsDesc</a>, <a href="#41564" title="Int">queryCounter</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>

	          <span title="Any" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#40829" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">responseTimes</a>.<span title="(x$1: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
	            <a href="#40829" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">responseTimes</a>.<span title="(x$1: edu.berkeley.cs.scads.piql.modeling.QueryDescription, x$2: edu.berkeley.cs.scads.perf.Histogram)edu.berkeley.cs.scads.perf.Histogram">putIfAbsent</span><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a>, <span title="(bucketSize: Int, bucketCount: Int)edu.berkeley.cs.scads.perf.Histogram">Histogram</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <span title="Int(1000)" class="int">1000</span><span class="delimiter">)</span><span class="delimiter">)</span>
	          <span class="delimiter">}</span>

	          <a href="#40829" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">responseTimes</a>.<span title="(x$1: Any)edu.berkeley.cs.scads.perf.Histogram">get</span><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a><span class="delimiter">)</span> <span title="(value: Long)Unit">+=</span> <span class="delimiter">(</span><a href="#42075" title="Long">endTime</a> <span title="(x: Long)Long">-</span> <a href="#41800" title="Long">startTime</a><span class="delimiter">)</span>
	          <a href="#41564" title="Int">queryCounter</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
	        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
	          <span class="keyword">case</span> <a title="Int" id="42120">e</a> =&gt;
	            <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(thrown: Throwable, msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><a href="#42120" title="java.lang.Throwable">e</a>, <span title="java.lang.String(&quot;Query %s failed&quot;)" class="string">&quot;Query %s failed&quot;</span>, <a href="#41795" title="edu.berkeley.cs.scads.piql.modeling.QuerySpec">querySpec</a>.<a href="#32834" title="=&gt; edu.berkeley.cs.scads.piql.OptimizedQuery">query</a>.<span title="=&gt; Option[String]">name</span><span class="delimiter">)</span>
	            <span title="Any" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#40830" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]">failedQueries</a>.<span title="(x$1: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a><span class="delimiter">)</span><span class="delimiter">)</span>
		            <a href="#40830" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]">failedQueries</a>.<span title="(x$1: edu.berkeley.cs.scads.piql.modeling.QueryDescription, x$2: java.util.concurrent.atomic.AtomicInteger)java.util.concurrent.atomic.AtomicInteger">putIfAbsent</span><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a>, <span title="()java.util.concurrent.atomic.AtomicInteger" class="keyword">new</span> <span title="java.util.concurrent.atomic.AtomicInteger">AtomicInteger</span><span class="delimiter">)</span>
	            <a href="#40830" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]">failedQueries</a>.<span title="(x$1: Any)java.util.concurrent.atomic.AtomicInteger">get</span><span class="delimiter">(</span><a href="#41799" title="edu.berkeley.cs.scads.piql.modeling.QueryDescription">queryDesc</a><span class="delimiter">)</span>.<span title="()Int">incrementAndGet</span>
	        <span class="delimiter">}</span>
	      <span class="delimiter">}</span>
	
	      <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Thread %d completed with %d queries.&quot;)" class="string">&quot;Thread %d completed with %d queries.&quot;</span>, <a href="#41559" title="Int">threadId</a>, <a href="#41564" title="Int">queryCounter</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>

      <a href="#43427" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Recording results to scads&quot;)" class="string">&quot;Recording results to scads&quot;</span><span class="delimiter">)</span>
      <a href="#38225" title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.modeling.Result]">results</a> <span title="(that: TraversableOnce[edu.berkeley.cs.scads.piql.modeling.Result])Unit">++=</span> <a href="#40829" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">responseTimes</a>.<span title="(s: java.util.Set[java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]])scala.collection.mutable.Set[java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]]">entrySet</span>.<span title="(f: java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram] =&gt; edu.berkeley.cs.scads.piql.modeling.Result)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Set[java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]],edu.berkeley.cs.scads.piql.modeling.Result,TraversableOnce[edu.berkeley.cs.scads.piql.modeling.Result]])TraversableOnce[edu.berkeley.cs.scads.piql.modeling.Result]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Set.Coll,edu.berkeley.cs.scads.piql.modeling.Result,scala.collection.mutable.Set[edu.berkeley.cs.scads.piql.modeling.Result]]" class="delimiter">(</span><a title="java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]" id="42671">e</a> =&gt; <span class="delimiter">{</span>
	      <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.modeling.Result" id="42672">result</a> = <a href="#43431" title="(queryDesc: edu.berkeley.cs.scads.piql.modeling.QueryDescription, hostname: String, timestamp: Long)edu.berkeley.cs.scads.piql.modeling.Result">Result</a><span class="delimiter">(</span><a href="#42671" title="java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">e</a>.<span title="()edu.berkeley.cs.scads.piql.modeling.QueryDescription">getKey</span>, <a href="#38224" title="java.lang.String">hostname</a>, <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">)</span>
	      <a href="#42672" title="edu.berkeley.cs.scads.piql.modeling.Result">result</a>.<a href="#37928" title="(x$1: Int)Unit">iteration</a> = <a href="#40828" title="Int">iteration</a>
	      <a href="#42672" title="edu.berkeley.cs.scads.piql.modeling.Result">result</a>.<a href="#37931" title="(x$1: edu.berkeley.cs.scads.piql.modeling.QueryRunnerTask)Unit">clientConfig</a> = <a href="#43427" title="edu.berkeley.cs.scads.piql.modeling.QueryRunnerTask" class="keyword">this</a>
	      <a href="#42672" title="edu.berkeley.cs.scads.piql.modeling.Result">result</a>.<a href="#37934" title="(x$1: edu.berkeley.cs.scads.perf.Histogram)Unit">responseTimes</a> = <a href="#42671" title="java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">e</a>.<span title="()edu.berkeley.cs.scads.perf.Histogram">getValue</span>
	      <a href="#42672" title="edu.berkeley.cs.scads.piql.modeling.Result">result</a>.<a href="#37937" title="(x$1: Int)Unit">failedQueries</a> = <span title="(x: java.util.concurrent.atomic.AtomicInteger)Option[java.util.concurrent.atomic.AtomicInteger]">Option</span><span class="delimiter">(</span><a href="#40830" title="java.util.concurrent.ConcurrentHashMap[edu.berkeley.cs.scads.piql.modeling.QueryDescription,java.util.concurrent.atomic.AtomicInteger]">failedQueries</a>.<span title="(x$1: Any)java.util.concurrent.atomic.AtomicInteger">get</span><span class="delimiter">(</span><a href="#42671" title="java.util.Map.Entry[edu.berkeley.cs.scads.piql.modeling.QueryDescription,edu.berkeley.cs.scads.perf.Histogram]">e</a>.<span title="()edu.berkeley.cs.scads.piql.modeling.QueryDescription">getKey</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: java.util.concurrent.atomic.AtomicInteger =&gt; Int)Option[Int]">map</span><span class="delimiter">(</span><a href="#42690" title="java.util.concurrent.atomic.AtomicInteger">_</a>.<span title="()Int">get</span><span class="delimiter">)</span>.<span title="(default: =&gt; Int)Int">getOrElse</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
	      <a href="#42672" title="edu.berkeley.cs.scads.piql.modeling.Result">result</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">//Upload traces to S3</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#43411" title="=&gt; Boolean">traceQueries</a> <span title="(x: Boolean)Boolean">||</span> <a href="#43409" title="=&gt; Boolean">traceIterators</a> <span title="(x: Boolean)Boolean">||</span> <a href="#43410" title="=&gt; Boolean">traceMessages</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#38232" title="edu.berkeley.cs.scads.piql.modeling.FileTraceSink">traceSink</a>.<a href="../tracing/FileTraceSink.scala.html#39767" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="../util/TraceS3Cache.scala.html#10335" title="object edu.berkeley.cs.scads.piql.modeling.TraceS3Cache">TraceS3Cache</a>.<a href="../util/TraceS3Cache.scala.html#43169" title="(file: java.io.File, prefix: String, suffix: String)Unit">uploadFile</a><span class="delimiter">(</span><a href="#38231" title="java.io.File">traceFile</a>, <span title="(xs: Any*)List[Any]">List</span><span class="delimiter">(</span><a href="#43393" title="=&gt; String">queryProvider</a>, <a href="#43414" title="=&gt; Int">threads</a>, <a href="#43412" title="=&gt; Int">iterations</a><span title="(x: Int)Int">*</span><a href="#43413" title="=&gt; Int">iterationLengthMin</a>, <a href="#38226" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">experimentRoot</a>.<span title="=&gt; String">name</span><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span class="delimiter">)</span>, <span title="java.lang.String(&quot;client&quot;)" class="string">&quot;client&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#38228" title="Int">clientId</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  @inline <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Long" id="38025">getTime</a> = <span title="object java.lang.System">System</span>.<span title="()Long">nanoTime</span> <span title="(x: Int)Long">/</span> <span title="Int(1000000)" class="int">1000000</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>