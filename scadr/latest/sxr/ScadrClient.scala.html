<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>ScadrClient.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> piql
<span class="keyword">package</span> scadr

<span class="keyword">import</span> storage.ScadsCluster
<span class="keyword">import</span> avro.marker._

<span class="keyword">import</span> org.apache.avro.util._

case <span class="keyword">class</span> <a title="class User extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroPair with ScalaObject with Product with Serializable" id="27237">User</a><a href="#27237" title="ScalaObject" class="delimiter">(</a><a href="#27237" title="()edu.berkeley.cs.scads.piql.scadr.User" id="41266" class="keyword">var</a> <a title="String" id="27234">username</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroPair">AvroPair</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="String" id="11636">homeTown</a>: <span title="String">String</span> = _
  <span class="keyword">var</span> <a title="String" id="11639">password</a>: <span title="String">String</span> = _
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class Thought extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroPair with ScalaObject with Product with Serializable" id="27230">Thought</a><a href="#27230" title="ScalaObject" class="delimiter">(</a><a href="#27230" title="()edu.berkeley.cs.scads.piql.scadr.Thought" id="41276" class="keyword">var</a> <a title="String" id="27225">owner</a>: <span title="String">String</span>, <span class="keyword">var</span> <a title="Int" id="27226">timestamp</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroPair">AvroPair</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="String" id="14871">text</a>: <span title="String">String</span> = _
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class Subscription extends org.apache.avro.specific.SpecificRecordBase with edu.berkeley.cs.avro.runtime.HasAvroConversions with edu.berkeley.cs.avro.marker.AvroPair with ScalaObject with Product with Serializable" id="27221">Subscription</a><a href="#27221" title="ScalaObject" class="delimiter">(</a><a href="#27221" title="()edu.berkeley.cs.scads.piql.scadr.Subscription" id="41286" class="keyword">var</a> <a title="String" id="27216">owner</a>: <span title="String">String</span>, <span class="keyword">var</span> <a title="String" id="27217">target</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="edu.berkeley.cs.avro.marker.AvroPair">AvroPair</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="Boolean" id="16316">approved</a>: <span title="Boolean">Boolean</span> = _
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class ScadrClient extends java.lang.Object with ScalaObject" id="9585">ScadrClient</a><a href="#9585" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="27195">cluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span>, <a title="edu.berkeley.cs.scads.piql.package.QueryExecutor" id="27198">executor</a>: <span title="edu.berkeley.cs.scads.piql.package.QueryExecutor">QueryExecutor</span> = <span title="edu.berkeley.cs.scads.piql.exec.ParallelExecutor" class="keyword">new</span> <span title="edu.berkeley.cs.scads.piql.exec.ParallelExecutor">ParallelExecutor</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="Int" id="16421">maxSubscriptions</a> = <span title="Int(10000)" class="int">10000</span>
  <span class="keyword">val</span> <a title="Int" id="16423">maxResultsPerPage</a> = <span title="Int(10000)" class="int">10000</span>
  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.package.QueryExecutor" id="16425">exec</a> = <a href="#27198" title="edu.berkeley.cs.scads.piql.package.QueryExecutor">executor</a>

  <span class="comment">// namespaces are declared to be lazy so as to allow for manual</span>
  <span class="comment">// createNamespace calls to happen first (and after instantiating this</span>
  <span class="comment">// class)</span>

  <span class="comment">//HACK: typecast to namespace</span>
  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.User]" id="16427">users</a> = <a href="#27195" title="=&gt; edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String)(implicit evidence$7: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">getNamespace</span><span title="(ns: String)(implicit evidence$7: Manifest[edu.berkeley.cs.scads.piql.scadr.User])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.User]" class="delimiter">[</span><a href="#27237" title="edu.berkeley.cs.scads.piql.scadr.User">User</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.scadr.User]" class="delimiter">(</span><span title="java.lang.String(&quot;users&quot;)" class="string">&quot;users&quot;</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Thought]" id="16429">thoughts</a> = <a href="#27195" title="=&gt; edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String)(implicit evidence$7: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">getNamespace</span><span title="(ns: String)(implicit evidence$7: Manifest[edu.berkeley.cs.scads.piql.scadr.Thought])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Thought]" class="delimiter">[</span><a href="#27230" title="edu.berkeley.cs.scads.piql.scadr.Thought">Thought</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.scadr.Thought]" class="delimiter">(</span><span title="java.lang.String(&quot;thoughts&quot;)" class="string">&quot;thoughts&quot;</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription]" id="16431">subscriptions</a> = <a href="#27195" title="=&gt; edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="[PairType &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: String)(implicit evidence$7: Manifest[PairType])edu.berkeley.cs.scads.storage.PairNamespace[PairType]">getNamespace</span><span title="(ns: String)(implicit evidence$7: Manifest[edu.berkeley.cs.scads.piql.scadr.Subscription])edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription]" class="delimiter">[</span><a href="#27221" title="edu.berkeley.cs.scads.piql.scadr.Subscription">Subscription</a><span class="delimiter">]</span><span title="(clazz: Class[_])scala.reflect.Manifest[edu.berkeley.cs.scads.piql.scadr.Subscription]" class="delimiter">(</span><span title="java.lang.String(&quot;subscriptions&quot;)" class="string">&quot;subscriptions&quot;</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="List[edu.berkeley.cs.scads.storage.PairNamespace[_ &gt;: edu.berkeley.cs.scads.piql.scadr.Subscription with edu.berkeley.cs.scads.piql.scadr.Thought with edu.berkeley.cs.scads.piql.scadr.User &lt;: edu.berkeley.cs.avro.marker.AvroPair with Product with Serializable]]" id="16433">namespaces</a> = <span title="(xs: edu.berkeley.cs.scads.storage.PairNamespace[_ &gt;: edu.berkeley.cs.scads.piql.scadr.Subscription with edu.berkeley.cs.scads.piql.scadr.Thought with edu.berkeley.cs.scads.piql.scadr.User &lt;: edu.berkeley.cs.avro.marker.AvroPair with Product with Serializable]*)List[edu.berkeley.cs.scads.storage.PairNamespace[_ &gt;: edu.berkeley.cs.scads.piql.scadr.Subscription with edu.berkeley.cs.scads.piql.scadr.Thought with edu.berkeley.cs.scads.piql.scadr.User &lt;: edu.berkeley.cs.avro.marker.AvroPair with Product with Serializable]]">List</span><span class="delimiter">(</span><a href="#16427" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.User]">users</a>, <a href="#16429" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Thought]">thoughts</a>, <a href="#16431" title="=&gt; edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription]">subscriptions</a><span class="delimiter">)</span>
  <span class="comment">//val allNamespaces = namespaces.flatMap(ns =&gt; ns :: ns.listIndexes.map(_._2).toList)</span>

  <span class="comment">/* Optimized queries */</span>
  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" id="16435">findUser</a> = <a href="#16427" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.User])edu.berkeley.cs.scads.piql.plans.Relation">users</a>.<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><a href="#16425" title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.plans.LogicalPlan)(implicit executor: edu.berkeley.cs.scads.piql.package#QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.opt.OptimizedQuery; def toPiql$default$1: Option[String]}" class="delimiter">(</a><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;username&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">0.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(queryName: Option[String])edu.berkeley.cs.scads.piql.opt.OptimizedQuery">toPiql</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;findUser&quot;</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" id="16437">myThoughts</a> = <span class="delimiter">(</span>
    <a href="#16429" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Thought])edu.berkeley.cs.scads.piql.plans.Relation">thoughts</a>.<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;thoughts.owner&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">0.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>
	    .<span title="(attributes: Seq[edu.berkeley.cs.scads.piql.plans.Value], ascending: Boolean)edu.berkeley.cs.scads.piql.plans.Sort">sort</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;thoughts.timestamp&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <a href="#26763" title="(x: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue)List[edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue]">::</a> <span title="object Nil">Nil</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
	    .<span title="(parameter: edu.berkeley.cs.scads.piql.plans.ParameterValue, max: Int)edu.berkeley.cs.scads.piql.plans.StopAfter">limit</span><a href="#16425" title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.plans.LogicalPlan)(implicit executor: edu.berkeley.cs.scads.piql.package#QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.opt.OptimizedQuery; def toPiql$default$1: Option[String]}" class="delimiter">(</a><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">1.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span>, <a href="#16423" title="=&gt; Int">maxResultsPerPage</a><span class="delimiter">)</span>
  <span class="delimiter">)</span>.<span title="(queryName: Option[String])edu.berkeley.cs.scads.piql.opt.OptimizedQuery">toPiql</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;myThoughts&quot;</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" id="16439">usersFollowedBy</a> = <span class="delimiter">(</span>
    <a href="#16431" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription])edu.berkeley.cs.scads.piql.plans.Relation">subscriptions</a>.<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.owner&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">0.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>
	 .<span title="(parameter: edu.berkeley.cs.scads.piql.plans.ParameterValue, max: Int)edu.berkeley.cs.scads.piql.plans.StopAfter">limit</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">1.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span>, <a href="#16423" title="=&gt; Int">maxResultsPerPage</a><span class="delimiter">)</span>
	 .<span title="(inner: edu.berkeley.cs.scads.piql.plans.LogicalPlan)edu.berkeley.cs.scads.piql.plans.Join">join</span><span class="delimiter">(</span><a href="#16427" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.User])edu.berkeley.cs.scads.piql.plans.Relation">users</a><span class="delimiter">)</span>
	 .<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><a href="#16425" title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.plans.LogicalPlan)(implicit executor: edu.berkeley.cs.scads.piql.package#QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.opt.OptimizedQuery; def toPiql$default$1: Option[String]}" class="delimiter">(</a><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.target&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;users.username&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span><span class="delimiter">)</span>
  <span class="delimiter">)</span>.<span title="(queryName: Option[String])edu.berkeley.cs.scads.piql.opt.OptimizedQuery">toPiql</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;usersFollowedBy&quot;</span><span class="delimiter">)</span>


  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" id="16441">thoughtstream</a> = <span class="delimiter">(</span>
    <a href="#16431" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription])edu.berkeley.cs.scads.piql.plans.Relation">subscriptions</a>.<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.owner&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">0.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>
		 .<span title="(count: Int)edu.berkeley.cs.scads.piql.plans.DataStopAfter">dataLimit</span><span class="delimiter">(</span><a href="#16421" title="=&gt; Int">maxSubscriptions</a><span class="delimiter">)</span>
		 .<span title="(inner: edu.berkeley.cs.scads.piql.plans.LogicalPlan)edu.berkeley.cs.scads.piql.plans.Join">join</span><span class="delimiter">(</span><a href="#16429" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Thought])edu.berkeley.cs.scads.piql.plans.Relation">thoughts</a><span class="delimiter">)</span>
		 .<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;thoughts.owner&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.target&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span><span class="delimiter">)</span>
		 .<span title="(attributes: Seq[edu.berkeley.cs.scads.piql.plans.Value], ascending: Boolean)edu.berkeley.cs.scads.piql.plans.Sort">sort</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;thoughts.timestamp&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <a href="#27146" title="(x: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue)List[edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue]">::</a> <span title="object Nil">Nil</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
		 .<span title="(parameter: edu.berkeley.cs.scads.piql.plans.ParameterValue, max: Int)edu.berkeley.cs.scads.piql.plans.StopAfter">limit</span><a href="#16425" title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.plans.LogicalPlan)(implicit executor: edu.berkeley.cs.scads.piql.package#QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.opt.OptimizedQuery; def toPiql$default$1: Option[String]}" class="delimiter">(</a><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">1.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span>, <a href="#16423" title="=&gt; Int">maxResultsPerPage</a><span class="delimiter">)</span>
  <span class="delimiter">)</span>.<span title="(queryName: Option[String])edu.berkeley.cs.scads.piql.opt.OptimizedQuery">toPiql</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;thoughtstream&quot;</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Who is following ME?
   */</span>
  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" id="16443">usersFollowing</a> = <span class="delimiter">(</span>
    <a href="#16431" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription])edu.berkeley.cs.scads.piql.plans.Relation">subscriptions</a>.<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.target&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">0.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>
		 .<span title="(parameter: edu.berkeley.cs.scads.piql.plans.ParameterValue, max: Int)edu.berkeley.cs.scads.piql.plans.StopAfter">limit</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">1.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span>, <a href="#16423" title="=&gt; Int">maxResultsPerPage</a><span class="delimiter">)</span>
		 .<span title="(inner: edu.berkeley.cs.scads.piql.plans.LogicalPlan)edu.berkeley.cs.scads.piql.plans.Join">join</span><span class="delimiter">(</span><a href="#16427" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.User])edu.berkeley.cs.scads.piql.plans.Relation">users</a><span class="delimiter">)</span>
		 .<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><a href="#16425" title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.plans.LogicalPlan)(implicit executor: edu.berkeley.cs.scads.piql.package#QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.opt.OptimizedQuery; def toPiql$default$1: Option[String]}" class="delimiter">(</a><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;users.username&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.owner&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>.<span title="(queryName: Option[String])edu.berkeley.cs.scads.piql.opt.OptimizedQuery">toPiql</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;usersFollowing&quot;</span><span class="delimiter">)</span>
  
  <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.opt.OptimizedQuery" id="16445">findSubscription</a> = <span class="delimiter">(</span>
    <a href="#16431" title="(ns: edu.berkeley.cs.scads.storage.PairNamespace[edu.berkeley.cs.scads.piql.scadr.Subscription])edu.berkeley.cs.scads.piql.plans.Relation">subscriptions</a>.<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.owner&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">0.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>
		 .<span title="(predicate: edu.berkeley.cs.scads.piql.plans.Predicate)edu.berkeley.cs.scads.piql.plans.Selection">where</span><a href="#16425" title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.plans.LogicalPlan)(implicit executor: edu.berkeley.cs.scads.piql.package#QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.opt.OptimizedQuery; def toPiql$default$1: Option[String]}" class="delimiter">(</a><span title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue}" class="string">&quot;subscriptions.target&quot;</span>.<span title="=&gt; edu.berkeley.cs.scads.piql.plans.UnboundAttributeValue">a</span> <span title="(value: edu.berkeley.cs.scads.piql.plans.Value)edu.berkeley.cs.scads.piql.plans.EqualityPredicate">===</span> <span class="delimiter">(</span><span title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.plans.ParameterValue}" class="double">1.</span><span title="=&gt; edu.berkeley.cs.scads.piql.plans.ParameterValue">?</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>.<span title="(queryName: Option[String])edu.berkeley.cs.scads.piql.opt.OptimizedQuery">toPiql</span><span class="delimiter">(</span><span title="(a: java.lang.String)Option[java.lang.String]" class="string">&quot;findSubscription&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>