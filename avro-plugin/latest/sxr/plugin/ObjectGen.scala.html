<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>plugin/ObjectGen.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.avro
<span class="keyword">package</span> plugin

<span class="keyword">import</span> scala.tools._
<span class="keyword">import</span> nsc.Global
<span class="keyword">import</span> nsc.Phase
<span class="keyword">import</span> nsc.plugins.Plugin
<span class="keyword">import</span> nsc.plugins.PluginComponent
<span class="keyword">import</span> nsc.transform.Transform
<span class="keyword">import</span> nsc.transform.InfoTransform
<span class="keyword">import</span> nsc.transform.TypingTransformers
<span class="keyword">import</span> nsc.symtab.<span title="object scala.tools.nsc.symtab.Flags">Flags</span>._
<span class="keyword">import</span> nsc.util.Position
<span class="keyword">import</span> nsc.util.NoPosition
<span class="keyword">import</span> nsc.ast.TreeDSL
<span class="keyword">import</span> nsc.typechecker
<span class="keyword">import</span> scala.annotation.tailrec

<span class="keyword">import</span> scala.collection.<span title="object scala.collection.JavaConversions">JavaConversions</span>._

<span class="keyword">trait</span> <a title="trait ObjectGen extends scala.tools.nsc.plugins.PluginComponent with edu.berkeley.cs.avro.plugin.ScalaAvroPluginComponent with scala.tools.nsc.transform.Transform with scala.tools.nsc.transform.TypingTransformers with scala.tools.nsc.ast.TreeDSL with ScalaObject" id="9563">ObjectGen</a> <span title="ScalaObject" class="keyword">extends</span> <a href="ScalaAvroPlugin.scala.html#9582" title="edu.berkeley.cs.avro.plugin.ScalaAvroPluginComponent">ScalaAvroPluginComponent</a>
                <span class="keyword">with</span>    <span title="scala.tools.nsc.transform.Transform">Transform</span>
                <span class="keyword">with</span>    <span title="scala.tools.nsc.transform.TypingTransformers">TypingTransformers</span>
                <span class="keyword">with</span>    <span title="scala.tools.nsc.ast.TreeDSL">TreeDSL</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#9563" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="#9563" title="object ObjectGen.this.global.definitions">definitions</a>._
      
  <span class="keyword">val</span> <a title="List[String]" id="54060">runsAfter</a> = <span title="[A](xs: A*)List[A]">List</span><span title="(xs: String*)List[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="java.lang.String(&quot;schemagen&quot;)" class="string">&quot;schemagen&quot;</span><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">val</span> <a title="Some[java.lang.String]" id="54062">runsRightAfter</a> = <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span><span title="java.lang.String(&quot;schemagen&quot;)" class="string">&quot;schemagen&quot;</span><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="54064">phaseName</a> = <span title="java.lang.String(&quot;objectgen&quot;)" class="string">&quot;objectgen&quot;</span>
  <span class="keyword">def</span> <a title="(unit: ObjectGen.this.global.CompilationUnit)ObjectGen.this.ObjectGenTransformer" id="54066">newTransformer</a><span class="delimiter">(</span><a title="ObjectGen.this.global.CompilationUnit" id="54078">unit</a>: <span title="ObjectGen.this.global.CompilationUnit">CompilationUnit</span><span class="delimiter">)</span> = <span title="ObjectGen.this.ObjectGenTransformer" class="keyword">new</span> <a href="#54067" title="ObjectGen.this.ObjectGenTransformer">ObjectGenTransformer</a><span class="delimiter">(</span><a href="#54078" title="ObjectGen.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>    

  <span class="keyword">class</span> <a title="class ObjectGenTransformer extends ObjectGen.this.TypingTransformer with ScalaObject" id="54067">ObjectGenTransformer</a><a href="#54067" title="ScalaObject" class="delimiter">(</a><a title="ObjectGen.this.global.CompilationUnit" id="54088">unit</a>: <span title="ObjectGen.this.global.CompilationUnit">CompilationUnit</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#9563" title="ObjectGen.this.TypingTransformer">TypingTransformer</a><span class="delimiter">(</span><a href="#54088" title="ObjectGen.this.global.CompilationUnit">unit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#9563" title="object ObjectGen.this.CODE">CODE</a>._

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(md: ObjectGen.this.global.ModuleDef)ObjectGen.this.global.Tree" id="54086">pimpModuleDef</a><span class="delimiter">(</span><a title="ObjectGen.this.global.ModuleDef" id="54092">md</a>: <span title="ObjectGen.this.global.ModuleDef">ModuleDef</span><span class="delimiter">)</span>: <span title="ObjectGen.this.global.Tree">Tree</span> = <span class="delimiter">{</span>
      <a href="ScalaAvroPlugin.scala.html#21648" title="(a: AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;pimping the module def: &quot;)" class="string">&quot;pimping the module def: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ObjectGen.this.global.Template" id="54094">impl</a>  = <a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Template">impl</span>
      <span class="keyword">val</span> <a title="ObjectGen.this.global.Symbol" id="54095">clazz</a> = <a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span>.<span title="=&gt; ObjectGen.this.global.Symbol">moduleClass</span>

      <span class="keyword">def</span> <a title="(fieldName: String)String" id="54096">fieldNameAsVal</a><span class="delimiter">(</span><a title="String" id="54116">fieldName</a>: <span title="String">String</span><span class="delimiter">)</span> = 
        <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s &quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#54116" title="String">fieldName</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(fieldName: String)String" id="54097">fieldNameAsGetter</a><span class="delimiter">(</span><a title="String" id="54131">fieldName</a>: <span title="String">String</span><span class="delimiter">)</span> =
        <a href="#54131" title="String">fieldName</a>

      <span class="keyword">def</span> <a title="(fieldName: String, schema: String)(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)" id="54098">newSchemaVal</a><span class="delimiter">(</span><a title="String" id="54132">fieldName</a>: <span title="String">String</span>, <a title="String" id="54133">schema</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ObjectGen.this.global.TermSymbol" id="54134">valSym</a> = <a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>.<span title="(pos: ObjectGen.this.global.Position, name: ObjectGen.this.global.TermName)ObjectGen.this.global.TermSymbol">newValue</span><span class="delimiter">(</span><a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>.<span title="=&gt; ObjectGen.this.global.Position">pos</span>.<span title="=&gt; scala.tools.nsc.util.Position">focus</span>, <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><a href="#54096" title="(fieldName: String)String">fieldNameAsVal</a><span class="delimiter">(</span><a href="#54132" title="String">fieldName</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#54134" title="ObjectGen.this.global.TermSymbol">valSym</a> <span title="(mask: Long)valSym.type">setFlag</span> <span class="delimiter">(</span>PRIVATE <span title="Long(524292L)">|</span> LOCAL<span class="delimiter">)</span>
        <a href="#54134" title="ObjectGen.this.global.TermSymbol">valSym</a> <span title="(info: ObjectGen.this.global.Type)valSym.type">setInfo</span> <a href="ScalaAvroPlugin.scala.html#21673" title="=&gt; ObjectGen.this.global.Symbol">schemaClass</a>.<span title="=&gt; ObjectGen.this.global.Type">tpe</span>
        <a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>.<span title="=&gt; ObjectGen.this.global.Type">info</span>.<span title="=&gt; ObjectGen.this.global.Scope">decls</span> <span title="(sym: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">enter</span> <a href="#54134" title="ObjectGen.this.global.TermSymbol">valSym</a>

        <span class="keyword">val</span> <a title="ObjectGen.this.global.analyzer.global.Tree" id="54135">valDef</a> = <a href="#54067" title="=&gt; ObjectGen.this.global.analyzer.Typer">localTyper</a>.<span title="(tree: ObjectGen.this.global.analyzer.global.Tree)ObjectGen.this.global.analyzer.global.Tree">typed</span> <span class="delimiter">{</span>
          <a href="#9563" title="(sym: ObjectGen.this.global.Symbol)ObjectGen.this.CODE.ValSymStart">VAL</a><span class="delimiter">(</span><a href="#54134" title="ObjectGen.this.global.TermSymbol">valSym</a><span class="delimiter">)</span> <span title="(rhs: ObjectGen.this.global.Tree)ObjectGen.this.global.ValDef">===</span> <span class="delimiter">{</span>
            <a href="#9563" title="(fun: ObjectGen.this.global.Tree, args: List[ObjectGen.this.global.Tree])ObjectGen.this.global.Apply">Apply</a><span class="delimiter">(</span>
            <a href="#9563" title="(name: ObjectGen.this.global.Name)ObjectGen.this.global.Ident">Ident</a><a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: ObjectGen.this.global.Tree)ObjectGen.this.CODE.TreeMethods" class="delimiter">(</a><a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;edu&quot;)" class="string">&quot;edu&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethodsFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.CODE.TreeMethods">DOT</a> 
                <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;berkeley&quot;)" class="string">&quot;berkeley&quot;</span><span class="delimiter">)</span>   <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethodsFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.CODE.TreeMethods">DOT</a>
                <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;cs&quot;)" class="string">&quot;cs&quot;</span><span class="delimiter">)</span>     <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethodsFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.CODE.TreeMethods">DOT</a>
                <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;avro&quot;)" class="string">&quot;avro&quot;</span><span class="delimiter">)</span>   <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethodsFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.CODE.TreeMethods">DOT</a>
		<a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;runtime&quot;)" class="string">&quot;runtime&quot;</span><span class="delimiter">)</span>   <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethodsFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.CODE.TreeMethods">DOT</a>
		<a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;ScalaSpecificRecord&quot;)" class="string">&quot;ScalaSpecificRecord&quot;</span><span class="delimiter">)</span>   <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.global.Select">DOT</a>
                <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><span title="java.lang.String(&quot;parse&quot;)" class="string">&quot;parse&quot;</span><span class="delimiter">)</span>,
              <span title="(xs: ObjectGen.this.global.Literal*)List[ObjectGen.this.global.Literal]">List</span><span class="delimiter">(</span><a href="#9563" title="(x: Any)ObjectGen.this.global.Literal">LIT</a><span class="delimiter">(</span><a href="#54133" title="String">schema</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <span title="(_1: ObjectGen.this.global.TermSymbol, _2: ObjectGen.this.global.analyzer.global.Tree)(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)" class="delimiter">(</span><a href="#54134" title="ObjectGen.this.global.TermSymbol">valSym</a>, <a href="#54135" title="ObjectGen.this.global.analyzer.global.Tree">valDef</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(fieldName: String)(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)" id="54099">newSchemaGetter</a><span class="delimiter">(</span><a title="String" id="54310">fieldName</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ObjectGen.this.global.MethodSymbol" id="54311">getterSym</a> = <a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>.<span title="(pos: ObjectGen.this.global.Position, name: ObjectGen.this.global.TermName)ObjectGen.this.global.MethodSymbol">newMethod</span><span class="delimiter">(</span><a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>.<span title="=&gt; ObjectGen.this.global.Position">pos</span>.<span title="=&gt; scala.tools.nsc.util.Position">focus</span>, <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><a href="#54097" title="(fieldName: String)String">fieldNameAsGetter</a><span class="delimiter">(</span><a href="#54310" title="String">fieldName</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#54311" title="ObjectGen.this.global.MethodSymbol">getterSym</a> <span title="(mask: Long)getterSym.type">setFlag</span> <span class="delimiter">(</span>METHOD | STABLE <span title="Long(138412096L)">|</span> ACCESSOR<span class="delimiter">)</span>
        <a href="#54311" title="ObjectGen.this.global.MethodSymbol">getterSym</a> <span title="(info: ObjectGen.this.global.Type)getterSym.type">setInfo</span> <a href="#9563" title="(params: List[ObjectGen.this.global.Symbol], resultType: ObjectGen.this.global.Type)ObjectGen.this.global.MethodType">MethodType</a><span class="delimiter">(</span><a href="#54311" title="ObjectGen.this.global.MethodSymbol">getterSym</a>.<span title="(argtypes: List[ObjectGen.this.global.Type])List[ObjectGen.this.global.Symbol]">newSyntheticValueParams</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span>, <a href="ScalaAvroPlugin.scala.html#21673" title="=&gt; ObjectGen.this.global.Symbol">schemaClass</a>.<span title="=&gt; ObjectGen.this.global.Type">tpe</span><span class="delimiter">)</span>
        <a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>.<span title="=&gt; ObjectGen.this.global.Type">info</span>.<span title="=&gt; ObjectGen.this.global.Scope">decls</span> <span title="(sym: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">enter</span> <a href="#54311" title="ObjectGen.this.global.MethodSymbol">getterSym</a>

        <span class="keyword">val</span> <a title="ObjectGen.this.global.analyzer.global.Tree" id="54312">getDef</a> = <a href="#54067" title="(owner: ObjectGen.this.global.Symbol)(trans: =&gt; ObjectGen.this.global.analyzer.global.Tree)ObjectGen.this.global.analyzer.global.Tree">atOwner</a><span class="delimiter">(</span><a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#54067" title="=&gt; ObjectGen.this.global.analyzer.Typer">localTyper</a>.<span title="(tree: ObjectGen.this.global.analyzer.global.Tree)ObjectGen.this.global.analyzer.global.Tree">typed</span> <span class="delimiter">{</span>
          <a href="#9563" title="(sym: ObjectGen.this.global.Symbol)ObjectGen.this.CODE.DefSymStart">DEF</a><span class="delimiter">(</span><a href="#54311" title="ObjectGen.this.global.MethodSymbol">getterSym</a><span class="delimiter">)</span> <span title="(rhs: ObjectGen.this.global.Tree)ObjectGen.this.global.DefDef">===</span> <span class="delimiter">{</span> <a href="#9563" title="(sym: ObjectGen.this.global.Symbol)ObjectGen.this.global.gen.global.Tree">THIS</a><a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: ObjectGen.this.global.Tree)ObjectGen.this.CODE.TreeMethods" class="delimiter">(</a><a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a><span class="delimiter">)</span> <a href="#9563" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeFromSelectStart : (ss: ObjectGen.this.CODE.SelectStart)ObjectGen.this.global.Select">DOT</a> <a href="#9563" title="(s: String)ObjectGen.this.global.TermName">newTermName</a><span class="delimiter">(</span><a href="#54096" title="(fieldName: String)String">fieldNameAsVal</a><span class="delimiter">(</span><a href="#54310" title="String">fieldName</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
        <span title="(_1: ObjectGen.this.global.MethodSymbol, _2: ObjectGen.this.global.analyzer.global.Tree)(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)" class="delimiter">(</span><a href="#54311" title="ObjectGen.this.global.MethodSymbol">getterSym</a>, <a href="#54312" title="ObjectGen.this.global.analyzer.global.Tree">getDef</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>


      <span class="keyword">val</span> <a href="#54101" title="(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)" class="delimiter">(</a><a href="#54100" title="ObjectGen.this.global.TermSymbol" id="54101">valSym</a>, <a href="#54100" title="ObjectGen.this.global.analyzer.global.Tree" id="54102">valDef</a><span class="delimiter">)</span> = <a href="#54098" title="(fieldName: String, schema: String)(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)">newSchemaVal</a><span title="(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree) @unchecked" class="delimiter">(</span><span title="java.lang.String(&quot;schema&quot;)" class="string">&quot;schema&quot;</span>, <a href="ScalaAvroPlugin.scala.html#21694" title="(name: ObjectGen.this.global.Symbol)Option[org.apache.avro.Schema]">retrieveRecordSchema</a><span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21711" title="(module: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">companionClassOf</a><span class="delimiter">(</span><a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; org.apache.avro.Schema">get</span>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a href="#54104" title="(Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)], Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)])" class="delimiter">(</a><a href="#54103" title="Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)]" id="54104">keyPairVal</a>, <a href="#54103" title="Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)]" id="54105">valPairVal</a><span class="delimiter">)</span> = 
        <span title="(Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)], Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)])" class="keyword">if</span> <span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21656" title="(sym: ObjectGen.this.global.Symbol)Boolean">isMarkedPair</a><span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21711" title="(module: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">companionClassOf</a><span class="delimiter">(</span><a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a href="#54593" title="(Int, org.apache.avro.Schema, org.apache.avro.Schema)" class="delimiter">(</a><a href="#54592" title="Int" id="54593">offset</a>, <a href="#54592" title="org.apache.avro.Schema" id="54594">keySchema</a>, <a href="#54592" title="org.apache.avro.Schema" id="54595">valueSchema</a><span class="delimiter">)</span> = <a href="ScalaAvroPlugin.scala.html#21688" title="(key: ObjectGen.this.global.Symbol)(Int, org.apache.avro.Schema, org.apache.avro.Schema)">classToKVSchema</a><span title="(Int, org.apache.avro.Schema, org.apache.avro.Schema) @unchecked" class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21711" title="(module: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">companionClassOf</a><span class="delimiter">(</span><a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="(_1: Some[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)], _2: Some[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)])(Some[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)], Some[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)])" class="delimiter">(</span><span title="(x: (ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree))Some[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)]">Some</span><span class="delimiter">(</span><a href="#54098" title="(fieldName: String, schema: String)(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)">newSchemaVal</a><span class="delimiter">(</span><span title="java.lang.String(&quot;keySchema&quot;)" class="string">&quot;keySchema&quot;</span>, <a href="#54594" title="org.apache.avro.Schema">keySchema</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(x: (ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree))Some[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)]">Some</span><span class="delimiter">(</span><a href="#54098" title="(fieldName: String, schema: String)(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)">newSchemaVal</a><span class="delimiter">(</span><span title="java.lang.String(&quot;valueSchema&quot;)" class="string">&quot;valueSchema&quot;</span>, <a href="#54595" title="org.apache.avro.Schema">valueSchema</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> 
          <span title="(_1: None.type, _2: None.type)(None.type, None.type)" class="delimiter">(</span><span title="object None">None</span>, <span title="object None">None</span><span class="delimiter">)</span>

      <span class="comment">// !!! HACK !!!</span>
      <span class="keyword">val</span> <a title="ObjectGen.this.global.analyzer.global.Symbol" id="54106">owner0</a> = <a href="#54067" title="=&gt; ObjectGen.this.global.analyzer.Typer">localTyper</a>.<span title="=&gt; ObjectGen.this.global.analyzer.Context">context1</span>.<span title="=&gt; ObjectGen.this.global.analyzer.Context">enclClass</span>.<span title="=&gt; ObjectGen.this.global.analyzer.global.Symbol">owner</span>
      <a href="#54067" title="=&gt; ObjectGen.this.global.analyzer.Typer">localTyper</a>.<span title="=&gt; ObjectGen.this.global.analyzer.Context">context1</span>.<span title="=&gt; ObjectGen.this.global.analyzer.Context">enclClass</span>.<span title="(x$1: ObjectGen.this.global.analyzer.global.Symbol)Unit">owner</span> = <a href="#54095" title="ObjectGen.this.global.Symbol">clazz</a>

      <span class="keyword">val</span> <a href="#54108" title="(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)" class="delimiter">(</a><a href="#54107" title="ObjectGen.this.global.MethodSymbol" id="54108">getSym</a>, <a href="#54107" title="ObjectGen.this.global.analyzer.global.Tree" id="54109">getDef</a><span class="delimiter">)</span> = <a href="#54099" title="(fieldName: String)(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)">newSchemaGetter</a><span title="(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree) @unchecked" class="delimiter">(</span><span title="java.lang.String(&quot;schema&quot;)" class="string">&quot;schema&quot;</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a href="#54111" title="(Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)], Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)])" class="delimiter">(</a><a href="#54110" title="Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)]" id="54111">keyPairDef</a>, <a href="#54110" title="Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)]" id="54112">valPairDef</a><span class="delimiter">)</span> =
        <span title="(Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)], Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)])" class="keyword">if</span> <span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21656" title="(sym: ObjectGen.this.global.Symbol)Boolean">isMarkedPair</a><span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21711" title="(module: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">companionClassOf</a><span class="delimiter">(</span><a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> 
          <span title="(_1: Some[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)], _2: Some[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)])(Some[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)], Some[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)])" class="delimiter">(</span><span title="(x: (ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree))Some[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)]">Some</span><span class="delimiter">(</span><a href="#54099" title="(fieldName: String)(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)">newSchemaGetter</a><span class="delimiter">(</span><span title="java.lang.String(&quot;keySchema&quot;)" class="string">&quot;keySchema&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="(x: (ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree))Some[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)]">Some</span><span class="delimiter">(</span><a href="#54099" title="(fieldName: String)(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)">newSchemaGetter</a><span class="delimiter">(</span><span title="java.lang.String(&quot;valueSchema&quot;)" class="string">&quot;valueSchema&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> 
          <span title="(_1: None.type, _2: None.type)(None.type, None.type)" class="delimiter">(</span><span title="object None">None</span>, <span title="object None">None</span><span class="delimiter">)</span>

      <span class="comment">// !!! RESTORE HACK !!!</span>
      <a href="#54067" title="=&gt; ObjectGen.this.global.analyzer.Typer">localTyper</a>.<span title="=&gt; ObjectGen.this.global.analyzer.Context">context1</span>.<span title="=&gt; ObjectGen.this.global.analyzer.Context">enclClass</span>.<span title="(x$1: ObjectGen.this.global.analyzer.global.Symbol)Unit">owner</span> = <a href="#54106" title="ObjectGen.this.global.analyzer.global.Symbol">owner0</a>

      <span class="keyword">val</span> <a title="List[ObjectGen.this.global.Tree]" id="54113">mbrs</a> = <span title="(xs: List[ObjectGen.this.global.Tree]*)List[List[ObjectGen.this.global.Tree]]">List</span><span class="delimiter">(</span>
        <a href="#54111" title="Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)]">keyPairDef</a>.<span title="(f: (ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree) =&gt; List[ObjectGen.this.global.analyzer.global.Tree])Option[List[ObjectGen.this.global.analyzer.global.Tree]]">map</span><span class="delimiter">(</span><a title="(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)" id="54781">d</a> =&gt; <span title="(xs: ObjectGen.this.global.analyzer.global.Tree*)List[ObjectGen.this.global.analyzer.global.Tree]">List</span><span class="delimiter">(</span><a href="#54104" title="Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)]">keyPairVal</a>.<span title="=&gt; (ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)">get</span>.<span title="=&gt; ObjectGen.this.global.analyzer.global.Tree">_2</span>, <a href="#54781" title="(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)">d</a>.<span title="=&gt; ObjectGen.this.global.analyzer.global.Tree">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; List[ObjectGen.this.global.analyzer.global.Tree])List[ObjectGen.this.global.analyzer.global.Tree]">getOrElse</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span>,
        <a href="#54112" title="Option[(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)]">valPairDef</a>.<span title="(f: (ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree) =&gt; List[ObjectGen.this.global.analyzer.global.Tree])Option[List[ObjectGen.this.global.analyzer.global.Tree]]">map</span><span class="delimiter">(</span><a title="(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)" id="54800">d</a> =&gt; <span title="(xs: ObjectGen.this.global.analyzer.global.Tree*)List[ObjectGen.this.global.analyzer.global.Tree]">List</span><span class="delimiter">(</span><a href="#54105" title="Option[(ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)]">valPairVal</a>.<span title="=&gt; (ObjectGen.this.global.TermSymbol, ObjectGen.this.global.analyzer.global.Tree)">get</span>.<span title="=&gt; ObjectGen.this.global.analyzer.global.Tree">_2</span>, <a href="#54800" title="(ObjectGen.this.global.MethodSymbol, ObjectGen.this.global.analyzer.global.Tree)">d</a>.<span title="=&gt; ObjectGen.this.global.analyzer.global.Tree">_2</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; List[ObjectGen.this.global.analyzer.global.Tree])List[ObjectGen.this.global.analyzer.global.Tree]">getOrElse</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span>,
        <a href="#54102" title="ObjectGen.this.global.analyzer.global.Tree">valDef</a> <a href="#54813" title="(x: ObjectGen.this.global.Tree)List[ObjectGen.this.global.Tree]">::</a> <a href="#54109" title="ObjectGen.this.global.analyzer.global.Tree">getDef</a> <a href="#54814" title="(x: ObjectGen.this.global.Tree)List[ObjectGen.this.global.Tree]">::</a> <a href="#54094" title="ObjectGen.this.global.Template">impl</a>.<span title="=&gt; List[ObjectGen.this.global.Tree]">body</span><span class="delimiter">)</span>.<span title="(implicit asTraversable: List[ObjectGen.this.global.Tree] =&gt; scala.collection.TraversableOnce[ObjectGen.this.global.Tree])List[ObjectGen.this.global.Tree]">flatten</span>

      <span class="keyword">val</span> <a title="ObjectGen.this.global.Template" id="54114">impl0</a> = <a href="#54067" title="=&gt; ObjectGen.this.global.TreeCopier">treeCopy</a>.<span title="(tree: ObjectGen.this.global.Tree, parents: List[ObjectGen.this.global.Tree], self: ObjectGen.this.global.ValDef, body: List[ObjectGen.this.global.Tree])ObjectGen.this.global.Template">Template</span><span class="delimiter">(</span><a href="#54094" title="ObjectGen.this.global.Template">impl</a>, <a href="#54094" title="ObjectGen.this.global.Template">impl</a>.<span title="=&gt; List[ObjectGen.this.global.Tree]">parents</span>, <a href="#54094" title="ObjectGen.this.global.Template">impl</a>.<span title="=&gt; ObjectGen.this.global.ValDef">self</span>, <a href="#54113" title="List[ObjectGen.this.global.Tree]">mbrs</a><span class="delimiter">)</span>
      <a href="#54067" title="=&gt; ObjectGen.this.global.TreeCopier">treeCopy</a>.<span title="(tree: ObjectGen.this.global.Tree, mods: ObjectGen.this.global.Modifiers, name: ObjectGen.this.global.Name, impl: ObjectGen.this.global.Template)ObjectGen.this.global.ModuleDef">ModuleDef</span><span class="delimiter">(</span><a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>, <a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Modifiers">mods</span>, <a href="#54092" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.TermName">name</span>, <a href="#54114" title="ObjectGen.this.global.Template">impl0</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: ObjectGen.this.global.Tree)ObjectGen.this.global.Tree" id="54087">transform</a><span class="delimiter">(</span><a title="ObjectGen.this.global.Tree" id="54868">tree</a>: <span title="ObjectGen.this.global.Tree">Tree</span><span class="delimiter">)</span> : <span title="ObjectGen.this.global.Tree">Tree</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ObjectGen.this.global.Tree" id="54873">newTree</a> = <a href="#54868" title="ObjectGen.this.global.Tree">tree</a> <span title="ObjectGen.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="ObjectGen.this.global.Tree" id="54874">md</a> @ ModuleDef<span class="delimiter">(</span><a title="ObjectGen.this.global.Modifiers" id="54882">mods</a>, <a title="ObjectGen.this.global.TermName" id="54883">name</a>, <a title="ObjectGen.this.global.Template" id="54884">impl</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21654" title="(sym: ObjectGen.this.global.Symbol)Boolean">isMarked</a><span class="delimiter">(</span><a href="ScalaAvroPlugin.scala.html#21711" title="(module: ObjectGen.this.global.Symbol)ObjectGen.this.global.Symbol">companionClassOf</a><span class="delimiter">(</span><a href="#54874" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;

          <a href="ScalaAvroPlugin.scala.html#21648" title="(a: AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Adding module to companionModule map&quot;)" class="string">&quot;Adding module to companionModule map&quot;</span><span class="delimiter">)</span>
          <a href="ScalaAvroPlugin.scala.html#21693" title="=&gt; scala.collection.mutable.Map[String,ObjectGen.this.global.Symbol]">companionModuleMap</a> <span title="(kv: (String, ObjectGen.this.global.Symbol))ObjectGen.this.companionModuleMap.type">+=</span> <a href="#54874" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span>.<span title="(x: String)ArrowAssoc[String]">fullName</span> <span title="(y: ObjectGen.this.global.Symbol)(String, ObjectGen.this.global.Symbol)">-&gt;</span> <a href="#54874" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span>
          <a href="ScalaAvroPlugin.scala.html#21648" title="(a: AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;companionModuleMap: &quot;)" class="string">&quot;companionModuleMap: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="ScalaAvroPlugin.scala.html#21693" title="=&gt; scala.collection.mutable.Map[String,ObjectGen.this.global.Symbol]">companionModuleMap</a><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="Boolean" id="54893">hasSchemaDef</a> = <span title="=&gt; Boolean">!</span> <span class="delimiter">(</span> <a href="#54884" title="ObjectGen.this.global.Template">impl</a>.<span title="=&gt; List[ObjectGen.this.global.Tree]">body</span>.<span title="(p: ObjectGen.this.global.Tree =&gt; Boolean)List[ObjectGen.this.global.Tree]">filter</span> <a href="#54923" title="Boolean" class="delimiter">{</a> 
            <span class="keyword">case</span> <span title="Boolean(true)">ValDef</span><span class="delimiter">(</span>_, <a title="ObjectGen.this.global.TermName" id="54933">n</a>, _, _<span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#54933" title="ObjectGen.this.global.TermName">n</a>.<span title="()String">toString</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;schema &quot;)" class="string">&quot;schema &quot;</span><span class="delimiter">)</span> =&gt; <span title="Boolean(true)" class="keyword">true</span>
            <span class="keyword">case</span> <span title="Boolean(false)">_</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
          <span class="delimiter">}</span> <span title="=&gt; Boolean">isEmpty</span> <span class="delimiter">)</span>

          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#54893" title="Boolean">hasSchemaDef</a><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">throw</span> <span title="(x$1: Any)java.lang.AssertionError" class="keyword">new</span> <span title="java.lang.AssertionError">AssertionError</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Object cannot have schema member already defined: %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#54874" title="ObjectGen.this.global.ModuleDef">md</a>.<span title="=&gt; ObjectGen.this.global.Symbol">symbol</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <a href="#54086" title="(md: ObjectGen.this.global.ModuleDef)ObjectGen.this.global.Tree">pimpModuleDef</a><span class="delimiter">(</span><a href="#54874" title="ObjectGen.this.global.ModuleDef">md</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="ObjectGen.this.global.Tree">_</span> =&gt; <a href="#54868" title="ObjectGen.this.global.Tree">tree</a>
      <span class="delimiter">}</span>
      <a href="#54067" title="ObjectGen.this.ObjectGenTransformer" class="keyword">super</a>.<span title="(tree: ObjectGen.this.global.Tree)ObjectGen.this.global.Tree">transform</span><span class="delimiter">(</span><a href="#54873" title="ObjectGen.this.global.Tree">newTree</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>    
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>