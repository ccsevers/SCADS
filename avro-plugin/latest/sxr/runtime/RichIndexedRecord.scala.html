<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>runtime/RichIndexedRecord.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs.avro
<span class="keyword">package</span> runtime

<span class="keyword">import</span> java.io.ByteArrayOutputStream

<span class="keyword">import</span> scala.collection.<span title="object scala.collection.JavaConversions">JavaConversions</span>._

<span class="keyword">import</span> org.apache.avro.io.<span class="delimiter">{</span>BinaryDecoder, BinaryEncoder, EncoderFactory, DecoderFactory, JsonDecoder, JsonEncoder<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.generic.<span class="delimiter">{</span>GenericData, GenericDatumReader, GenericDatumWriter, IndexedRecord<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.specific.SpecificRecord

<span class="comment">/**
 * Collection of implicit conversions to scala-ify the Avro Java Library.
 */</span>
<span class="keyword">class</span> <a title="class RichIndexedRecord[T &lt;: org.apache.avro.generic.IndexedRecord] extends java.lang.Object with ScalaObject" id="9693">RichIndexedRecord</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.generic.IndexedRecord" id="9694">T</a> &lt;: IndexedRecord<span class="delimiter">]</span><a href="#9693" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="T" id="61781">rec</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="org.apache.avro.generic.GenericDatumReader[T]" id="61765">reader</a> = <span title="(x$1: org.apache.avro.Schema)org.apache.avro.generic.GenericDatumReader[T]" class="keyword">new</span> <span title="org.apache.avro.generic.GenericDatumReader[T]">GenericDatumReader</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; String" id="61766">toJson</a>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="73064">outBuffer</a> = <span title="java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.JsonEncoder" id="73065">encoder</a> = <span title="object org.apache.avro.io.EncoderFactory">EncoderFactory</span>.<span title="()org.apache.avro.io.EncoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: org.apache.avro.Schema, x$2: java.io.OutputStream)org.apache.avro.io.JsonEncoder">jsonEncoder</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span>,<a href="#73064" title="java.io.ByteArrayOutputStream">outBuffer</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]" id="73066">writer</a> = <span title="(x$1: org.apache.avro.Schema)org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]" class="keyword">new</span> <span title="org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]">GenericDatumWriter</span><span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#73066" title="org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]">writer</a>.<span title="(x$1: org.apache.avro.generic.IndexedRecord, x$2: org.apache.avro.io.Encoder)Unit">write</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>, <a href="#73065" title="org.apache.avro.io.JsonEncoder">encoder</a><span class="delimiter">)</span>
    <a href="#73065" title="org.apache.avro.io.JsonEncoder">encoder</a>.<span title="()Unit">flush</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span title="(x$1: Array[Byte])java.lang.String" class="keyword">new</span> <span title="java.lang.String">String</span><span class="delimiter">(</span><a href="#73064" title="java.io.ByteArrayOutputStream">outBuffer</a>.<span title="()Array[Byte]">toByteArray</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Array[Byte]" id="61767">toBytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="74035">outBuffer</a> = <span title="java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.BinaryEncoder" id="74036">encoder</a> = <span title="object org.apache.avro.io.EncoderFactory">EncoderFactory</span>.<span title="()org.apache.avro.io.EncoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: java.io.OutputStream, x$2: org.apache.avro.io.BinaryEncoder)org.apache.avro.io.BinaryEncoder">binaryEncoder</span><span class="delimiter">(</span><a href="#74035" title="java.io.ByteArrayOutputStream">outBuffer</a>,<span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]" id="74037">writer</a> = <span title="(x$1: org.apache.avro.Schema)org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]" class="keyword">new</span> <span title="org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]">GenericDatumWriter</span><span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#74037" title="org.apache.avro.generic.GenericDatumWriter[org.apache.avro.generic.IndexedRecord]">writer</a>.<span title="(x$1: org.apache.avro.generic.IndexedRecord, x$2: org.apache.avro.io.Encoder)Unit">write</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>, <a href="#74036" title="org.apache.avro.io.BinaryEncoder">encoder</a><span class="delimiter">)</span>
    <a href="#74036" title="org.apache.avro.io.BinaryEncoder">encoder</a>.<span title="()Unit">flush</span>
    <a href="#74035" title="java.io.ByteArrayOutputStream">outBuffer</a>.<span title="()Array[Byte]">toByteArray</span>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(data: String)T" id="61768">parse</a><span class="delimiter">(</span><a title="String" id="74074">data</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#9694" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.JsonDecoder" id="74076">decoder</a> = <span title="object org.apache.avro.io.DecoderFactory">DecoderFactory</span>.<span title="()org.apache.avro.io.DecoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: org.apache.avro.Schema, x$2: java.lang.String)org.apache.avro.io.JsonDecoder">jsonDecoder</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span>,<a href="#74074" title="String">data</a><span class="delimiter">)</span>
    <a href="#61764" title="=&gt; org.apache.avro.generic.GenericDatumReader[T]">reader</a>.<span title="(x$1: T, x$2: org.apache.avro.io.Decoder)T">read</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>, <a href="#74076" title="org.apache.avro.io.JsonDecoder">decoder</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(data: Array[Byte])T" id="61769">parse</a><span class="delimiter">(</span><a title="Array[Byte]" id="74231">data</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#9694" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.avro.io.BinaryDecoder" id="74233">decoder</a> = <span title="object org.apache.avro.io.DecoderFactory">DecoderFactory</span>.<span title="()org.apache.avro.io.DecoderFactory">get</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: Array[Byte], x$2: org.apache.avro.io.BinaryDecoder)org.apache.avro.io.BinaryDecoder">binaryDecoder</span><span class="delimiter">(</span><a href="#74231" title="Array[Byte]">data</a>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <a href="#61764" title="=&gt; org.apache.avro.generic.GenericDatumReader[T]">reader</a>.<span title="(x$1: T, x$2: org.apache.avro.io.Decoder)T">read</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>, <a href="#74233" title="org.apache.avro.io.BinaryDecoder">decoder</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; org.apache.avro.generic.GenericData.Record" id="61770">toGenericRecord</a>: GenericData.<span title="org.apache.avro.generic.GenericData.Record">Record</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.avro.generic.GenericData.Record" id="74350">genRec</a> = <span title="org.apache.avro.generic.GenericData.Record" class="keyword">new</span> <span title="object org.apache.avro.generic.GenericData">GenericData</span>.<span title="org.apache.avro.generic.GenericData.Record">Record</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(l: java.util.List[org.apache.avro.Schema.Field])scala.collection.mutable.Buffer[org.apache.avro.Schema.Field]">getFields</span>.<span title="(f: org.apache.avro.Schema.Field =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="org.apache.avro.Schema.Field" id="74747">f</a> =&gt; <a href="#74350" title="org.apache.avro.generic.GenericData.Record">genRec</a>.<span title="(x$1: Int, x$2: Any)Unit">put</span><span class="delimiter">(</span><a href="#74747" title="org.apache.avro.Schema.Field">f</a>.<span title="()Int">pos</span>, <a href="#61781" title="=&gt; T">rec</a>.<span title="(x$1: Int)java.lang.Object">get</span><span class="delimiter">(</span><a href="#74747" title="org.apache.avro.Schema.Field">f</a>.<span title="()Int">pos</span><span class="delimiter">)</span> <span title="java.lang.Object" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="org.apache.avro.generic.GenericData.Record" id="74752">r</a>: <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span> =&gt; <a href="package.scala.html#9753" title="(record: org.apache.avro.generic.IndexedRecord)edu.berkeley.cs.avro.runtime.RichIndexedRecord[org.apache.avro.generic.IndexedRecord]">r</a>.<a href="#61770" title="=&gt; org.apache.avro.generic.GenericData.Record">toGenericRecord</a>
      <span class="keyword">case</span> <a title="java.lang.Object" id="74768">o</a> =&gt; <a href="#74768" title="java.lang.Object">o</a>
    <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#74350" title="org.apache.avro.generic.GenericData.Record">genRec</a>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[SR &lt;: org.apache.avro.specific.SpecificRecord](implicit m: Manifest[SR])SR" id="61771">toSpecificRecord</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: org.apache.avro.specific.SpecificRecord" id="61773">SR</a> &lt;: SpecificRecord<span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[SR]" id="74770">m</a>: <span title="Manifest[SR]">Manifest</span><span class="delimiter">[</span>SR<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#61773" title="SR">SR</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="SR" id="74773">specific</a> = <a href="#74770" title="Manifest[SR]">m</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="()_$1">newInstance</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="SR" class="delimiter">[</span><a href="#61773" title="SR">SR</a><span class="delimiter">]</span>
    <a href="ScalaSpecificRecord.scala.html#9704" title="object edu.berkeley.cs.avro.runtime.ScalaSpecificRecordHelpers">ScalaSpecificRecordHelpers</a>.<a href="ScalaSpecificRecord.scala.html#74776" title="(specific: SR, generic: org.apache.avro.generic.IndexedRecord)SR">fromGenericRecord</a><span class="delimiter">(</span><a href="#74773" title="SR">specific</a>, <a href="#61781" title="=&gt; T">rec</a><span class="delimiter">)</span>
    <a href="#74773" title="SR">specific</a>
  <span class="delimiter">}</span>

  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lhs: T)Int" id="61774">compare</a><span class="delimiter">(</span><a title="T" id="74789">lhs</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <span title="object org.apache.avro.generic.GenericData">GenericData</span>.<span title="()org.apache.avro.generic.GenericData">get</span>.<span title="(x$1: Any, x$2: Any, x$3: org.apache.avro.Schema)Int">compare</span><span class="delimiter">(</span><a href="#61781" title="=&gt; T">rec</a>, <a href="#74789" title="T">lhs</a>, <a href="#61781" title="=&gt; T">rec</a>.<span title="()org.apache.avro.Schema">getSchema</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lhs: T)Boolean" id="61775">&gt;</a><span class="delimiter">(</span><a title="T" id="74792">lhs</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#61774" title="(lhs: T)Int">compare</a><span class="delimiter">(</span><a href="#74792" title="T">lhs</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lhs: T)Boolean" id="61776">&lt;</a><span class="delimiter">(</span><a title="T" id="74798">lhs</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#61774" title="(lhs: T)Int">compare</a><span class="delimiter">(</span><a href="#74798" title="T">lhs</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lhs: T)Boolean" id="61777">&gt;=</a><span class="delimiter">(</span><a title="T" id="74804">lhs</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#61774" title="(lhs: T)Int">compare</a><span class="delimiter">(</span><a href="#74804" title="T">lhs</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lhs: T)Boolean" id="61778">&lt;=</a><span class="delimiter">(</span><a title="T" id="74810">lhs</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#61774" title="(lhs: T)Int">compare</a><span class="delimiter">(</span><a href="#74810" title="T">lhs</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(lhs: T)Boolean" id="61779">==</a><span class="delimiter">(</span><a title="T" id="74816">lhs</a>: <a href="#9694" title="T">T</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#61774" title="(lhs: T)Int">compare</a><span class="delimiter">(</span><a href="#74816" title="T">lhs</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>