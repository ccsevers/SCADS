<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>AvroClient.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads
<span class="keyword">package</span> perf

<span class="keyword">import</span> comm._
<span class="keyword">import</span> storage._
<span class="keyword">import</span> avro.runtime._
<span class="keyword">import</span> avro.marker._
<span class="keyword">import</span> deploylib.mesos._

<span class="keyword">import</span> net.lag.logging.Logger
<span class="keyword">import</span> org.apache.avro.generic.IndexedRecord
<span class="keyword">import</span> org.apache.zookeeper.CreateMode

<span class="keyword">trait</span> <a title="trait ExperimentTask extends java.lang.Object with deploylib.mesos.AvroTask with ScalaObject" id="9500">ExperimentTask</a> <span title="ScalaObject" class="keyword">extends</span> <span title="deploylib.mesos.AvroTask">AvroTask</span> <span class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[ReturnType](tries: Int)(func: =&gt; ReturnType)ReturnType" id="14028">retry</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="14053">ReturnType</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="14051">tries</a>: <span title="Int">Int</span> = <span title="Int(5)" class="int">5</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; ReturnType" id="14049">func</a>: =&gt; ReturnType<span class="delimiter">)</span>: <a href="#14053" title="ReturnType">ReturnType</a> = <span class="delimiter">{</span>
    <span class="keyword">try</span> <a href="#14049" title="=&gt; ReturnType">func</a> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="ReturnType" id="14274">e</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#14051" title="Int">tries</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
	<a href="#9500" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(thrown: Throwable, msg: String, items: Any*)Unit">warning</span><span class="delimiter">(</span><a href="#14274" title="java.lang.Throwable">e</a>, <span title="java.lang.String(&quot;Exception caught, trying %d more times&quot;)" class="string">&quot;Exception caught, trying %d more times&quot;</span>, <a href="#14051" title="Int">tries</a><span class="delimiter">)</span>
	<a href="#14028" title="(tries: Int)(func: =&gt; ReturnType)ReturnType">retry</a><span class="delimiter">(</span><a href="#14051" title="Int">tries</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#14049" title="=&gt; ReturnType">func</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">trait</span> <a title="trait DataLoadingTask extends java.lang.Object with edu.berkeley.cs.scads.perf.ExperimentTask with ScalaObject" id="9501">DataLoadingTask</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9500" title="edu.berkeley.cs.scads.perf.ExperimentTask">ExperimentTask</a> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="=&gt; Int" id="24683">numServers</a>: <span title="Int">Int</span>
  <span class="keyword">var</span> <a title="=&gt; Int" id="24685">numLoaders</a>: <span title="Int">Int</span>

  <span class="keyword">var</span> <a title="=&gt; String" id="24687">clusterAddress</a>: <span title="String">String</span> 

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="24689">clusterRoot</a> = <span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#24687" title="=&gt; String">clusterAddress</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="()edu.berkeley.cs.scads.storage.ScadsCluster" id="24690">newTestCluster</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ManagedScadsCluster" id="24937">cluster</a> = <span title="object edu.berkeley.cs.scads.storage.TestScalaEngine">TestScalaEngine</span>.<span title="(numNodes: Int)edu.berkeley.cs.scads.storage.ManagedScadsCluster">newScadsCluster</span><span class="delimiter">(</span><a href="#24683" title="=&gt; Int">numServers</a><span class="delimiter">)</span>
    <a href="#24687" title="(x$1: String)Unit">clusterAddress</a> = <a href="#24937" title="edu.berkeley.cs.scads.storage.ManagedScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="=&gt; java.lang.String">canonicalAddress</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.IndexedSeq[java.lang.Thread]" id="24938">threads</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#24685" title="=&gt; Int">numLoaders</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; java.lang.Thread)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],java.lang.Thread,scala.collection.immutable.IndexedSeq[java.lang.Thread]])scala.collection.immutable.IndexedSeq[java.lang.Thread]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,java.lang.Thread,scala.collection.immutable.IndexedSeq[java.lang.Thread]]" class="delimiter">(</span><a title="Int" id="25519">i</a> =&gt; <span title="(x$1: java.lang.Runnable, x$2: java.lang.String)java.lang.Thread" class="keyword">new</span> <span title="java.lang.Thread">Thread</span><span class="delimiter">(</span><a href="#9501" title="edu.berkeley.cs.scads.perf.DataLoadingTask" class="keyword">this</a>, <span title="java.lang.String(&quot;TestDataLoadingTask &quot;)" class="string">&quot;TestDataLoadingTask &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#25519" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#24938" title="scala.collection.immutable.IndexedSeq[java.lang.Thread]">threads</a>.<span title="(f: java.lang.Thread =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#28125" title="java.lang.Thread">_</a>.<span title="()Unit">start</span><span class="delimiter">)</span>
    <a href="#24937" title="edu.berkeley.cs.scads.storage.ManagedScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="(name: String, seqNumber: Option[Int], timeout: Long, unit: java.util.concurrent.TimeUnit)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">awaitChild</span><span class="delimiter">(</span><span title="java.lang.String(&quot;clusterReady&quot;)" class="string">&quot;clusterReady&quot;</span><span class="delimiter">)</span>
    <a href="#24937" title="edu.berkeley.cs.scads.storage.ManagedScadsCluster">cluster</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(implicit classpath: Seq[edu.berkeley.cs.scads.comm.ClassSource], implicit scheduler: deploylib.mesos.ExperimentScheduler, implicit zookeeperRoot: edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode)edu.berkeley.cs.scads.storage.ScadsCluster" id="24691">newCluster</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Seq[edu.berkeley.cs.scads.comm.ClassSource]" id="28539">classpath</a>: <span title="Seq[edu.berkeley.cs.scads.comm.ClassSource]">Seq</span><span class="delimiter">[</span>ClassSource<span class="delimiter">]</span>, <a title="deploylib.mesos.ExperimentScheduler" id="28540">scheduler</a>: <span title="deploylib.mesos.ExperimentScheduler">ExperimentScheduler</span>, <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="28541">zookeeperRoot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#28551" title="(Seq[edu.berkeley.cs.scads.comm.JvmTask], edu.berkeley.cs.scads.storage.ScadsCluster)" class="delimiter">(</a><a href="#28550" title="Seq[edu.berkeley.cs.scads.comm.JvmTask]" id="28551">tasks</a>, <a href="#28550" title="edu.berkeley.cs.scads.storage.ScadsCluster" id="28552">cluster</a><span class="delimiter">)</span> = <a href="#24692" title="(implicit classpath: Seq[edu.berkeley.cs.scads.comm.ClassSource], implicit zookeeperRoot: edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode)(Seq[edu.berkeley.cs.scads.comm.JvmTask], edu.berkeley.cs.scads.storage.ScadsCluster)">delayedCluster</a>
    <a href="#28540" title="deploylib.mesos.ExperimentScheduler">scheduler</a>.<span title="(processes: Seq[edu.berkeley.cs.scads.comm.JvmTask])Unit">scheduleExperiment</span><span class="delimiter">(</span><a href="#28551" title="Seq[edu.berkeley.cs.scads.comm.JvmTask]">tasks</a><span class="delimiter">)</span>
    <a href="#28552" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(implicit classpath: Seq[edu.berkeley.cs.scads.comm.ClassSource], implicit zookeeperRoot: edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode)(Seq[edu.berkeley.cs.scads.comm.JvmTask], edu.berkeley.cs.scads.storage.ScadsCluster)" id="24692">delayedCluster</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Seq[edu.berkeley.cs.scads.comm.ClassSource]" id="28553">classpath</a>: <span title="Seq[edu.berkeley.cs.scads.comm.ClassSource]">Seq</span><span class="delimiter">[</span>ClassSource<span class="delimiter">]</span>, <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="28554">zookeeperRoot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>: <span title="(Seq[edu.berkeley.cs.scads.comm.JvmTask], edu.berkeley.cs.scads.storage.ScadsCluster)" class="delimiter">(</span>Seq<span class="delimiter">[</span>JvmTask<span class="delimiter">]</span>, ScadsCluster<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="28612">clusterRoot</a> = <a href="#28554" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">zookeeperRoot</a>.<span title="(rpath: java.lang.String, tries: Int)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">getOrCreate</span><a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="28637" class="delimiter">(</a><span title="java.lang.String(&quot;scads&quot;)" class="string">&quot;scads&quot;</span><span class="delimiter">)</span>.<a href="#28637" title="Array[Byte]" id="28640">createChild</a><span class="delimiter">(</span><a title="java.lang.String(&quot;experimentCluster&quot;)" id="28638" class="string">&quot;experimentCluster&quot;</a>, mode = CreateMode.<a title="org.apache.zookeeper.CreateMode(value PERSISTENT_SEQUENTIAL)" id="28639">PERSISTENT_SEQUENTIAL</a><span class="delimiter">)</span>
    <a href="#24687" title="(x$1: String)Unit">clusterAddress</a> = <a href="#28612" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a>.<span title="=&gt; java.lang.String">canonicalAddress</span>
    <span class="keyword">val</span> <a title="List[edu.berkeley.cs.scads.comm.JvmMainTask]" id="28613">serverProcs</a> = <span title="object List">List</span>.<span title="(n: Int)(elem: =&gt; edu.berkeley.cs.scads.comm.JvmMainTask)List[edu.berkeley.cs.scads.comm.JvmMainTask]">fill</span><span class="delimiter">(</span><a href="#24683" title="=&gt; Int">numServers</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="(clusterAddress: String, dbDir: Option[String], cachePercentage: Option[Int], name: Option[String])edu.berkeley.cs.scads.storage.ScalaEngineTask">ScalaEngineTask</span><span class="delimiter">(</span>clusterAddress=<a href="#28612" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a>.<span title="=&gt; java.lang.String">canonicalAddress</span><span class="delimiter">)</span>.<a href="#28553" title="(implicit classSource: Seq[edu.berkeley.cs.scads.comm.ClassSource])edu.berkeley.cs.scads.comm.JvmMainTask">toJvmTask</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="List[edu.berkeley.cs.scads.comm.JvmMainTask]" id="28614">loaderProcs</a> = <span title="object List">List</span>.<span title="(n: Int)(elem: =&gt; edu.berkeley.cs.scads.comm.JvmMainTask)List[edu.berkeley.cs.scads.comm.JvmMainTask]">fill</span><span class="delimiter">(</span><a href="#24685" title="=&gt; Int">numLoaders</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#9501" title="DataLoadingTask.this.type" class="keyword">this</a>.<a href="#28553" title="(implicit classSource: Seq[edu.berkeley.cs.scads.comm.ClassSource])edu.berkeley.cs.scads.comm.JvmMainTask">toJvmTask</a><span class="delimiter">)</span>

    <span title="(_1: Seq[edu.berkeley.cs.scads.comm.JvmTask], _2: edu.berkeley.cs.scads.storage.ScadsCluster)(Seq[edu.berkeley.cs.scads.comm.JvmTask], edu.berkeley.cs.scads.storage.ScadsCluster)" class="delimiter">(</span><a href="#28613" title="List[edu.berkeley.cs.scads.comm.JvmMainTask]">serverProcs</a> <span title="(that: scala.collection.GenTraversableOnce[edu.berkeley.cs.scads.comm.JvmMainTask])(implicit bf: scala.collection.generic.CanBuildFrom[List[edu.berkeley.cs.scads.comm.JvmMainTask],edu.berkeley.cs.scads.comm.JvmMainTask,Seq[edu.berkeley.cs.scads.comm.JvmTask]])Seq[edu.berkeley.cs.scads.comm.JvmTask]">++</span> <a href="#28614" title="List[edu.berkeley.cs.scads.comm.JvmMainTask]">loaderProcs</a>, <span title="edu.berkeley.cs.scads.storage.ScadsCluster" class="keyword">new</span> <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">(</span><a href="#28612" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">trait</span> <a title="trait ReplicatedExperimentTask extends java.lang.Object with edu.berkeley.cs.scads.perf.ExperimentTask with ScalaObject" id="9502">ReplicatedExperimentTask</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9500" title="edu.berkeley.cs.scads.perf.ExperimentTask">ExperimentTask</a> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="=&gt; Int" id="29698">numClients</a>: <span title="Int">Int</span>
  <span class="keyword">var</span> <a title="=&gt; String" id="29700">resultClusterAddress</a>: <span title="String">String</span>
  <span class="keyword">var</span> <a title="=&gt; String" id="29702">clusterAddress</a>: <span title="String">String</span>
  <span class="keyword">var</span> <a title="=&gt; String" id="29704">experimentAddress</a>: <span title="String">String</span>

  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29706">clusterRoot</a> = <span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#29702" title="=&gt; String">clusterAddress</a><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29708">coordination</a> = <a href="#29705" title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a>.<span title="(rpath: java.lang.String, tries: Int)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">getOrCreate</span><span class="delimiter">(</span><span title="java.lang.String(&quot;coordination/clients&quot;)" class="string">&quot;coordination/clients&quot;</span><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29710">cluster</a> = <span title="edu.berkeley.cs.scads.storage.ScadsCluster" class="keyword">new</span> <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">(</span><a href="#29705" title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">clusterRoot</a><span class="delimiter">)</span>
  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29712">resultCluster</a> = <span title="edu.berkeley.cs.scads.storage.ScadsCluster" class="keyword">new</span> <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">(</span><span title="(uri: String)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">(</span><a href="#29700" title="=&gt; String">resultClusterAddress</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster)scala.collection.immutable.IndexedSeq[java.lang.Thread]" id="29713">testLocally</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29726">cluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29729">experimentRoot</a> = <a href="#29726" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="(rpath: java.lang.String, tries: Int)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">getOrCreate</span><a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29735" class="delimiter">(</a><span title="java.lang.String(&quot;experiments&quot;)" class="string">&quot;experiments&quot;</span><span class="delimiter">)</span>.<a href="#29735" title="Array[Byte]" id="29738">createChild</a><span class="delimiter">(</span><a title="java.lang.String(&quot;experiment&quot;)" id="29736" class="string">&quot;experiment&quot;</a>, mode = CreateMode.<a title="org.apache.zookeeper.CreateMode(value PERSISTENT_SEQUENTIAL)" id="29737">PERSISTENT_SEQUENTIAL</a><span class="delimiter">)</span>
    <a href="#29704" title="(x$1: String)Unit">experimentAddress</a> = <a href="#29729" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">experimentRoot</a>.<span title="=&gt; java.lang.String">canonicalAddress</span>
    <a href="#29702" title="(x$1: String)Unit">clusterAddress</a> = <a href="#29726" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="=&gt; java.lang.String">canonicalAddress</span>
    <a href="#29700" title="(x$1: String)Unit">resultClusterAddress</a> = <a href="#29726" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="=&gt; java.lang.String">canonicalAddress</span>

    <span class="keyword">val</span> <a title="scala.collection.immutable.IndexedSeq[java.lang.Thread]" id="29730">threads</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#29698" title="=&gt; Int">numClients</a><span class="delimiter">)</span>.<span title="(f: Int =&gt; java.lang.Thread)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],java.lang.Thread,scala.collection.immutable.IndexedSeq[java.lang.Thread]])scala.collection.immutable.IndexedSeq[java.lang.Thread]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,java.lang.Thread,scala.collection.immutable.IndexedSeq[java.lang.Thread]]" class="delimiter">(</span><a title="Int" id="29873">_</a> =&gt; <span title="(x$1: java.lang.Runnable)java.lang.Thread" class="keyword">new</span> <span title="java.lang.Thread">Thread</span><span class="delimiter">(</span><a href="#9502" title="edu.berkeley.cs.scads.perf.ReplicatedExperimentTask" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#29730" title="scala.collection.immutable.IndexedSeq[java.lang.Thread]">threads</a>.<span title="(f: java.lang.Thread =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#29920" title="java.lang.Thread">_</a>.<span title="()Unit">start</span><span class="delimiter">)</span>
    <a href="#29730" title="scala.collection.immutable.IndexedSeq[java.lang.Thread]">threads</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster, resultCluster: edu.berkeley.cs.scads.storage.ScadsCluster)(implicit classpath: Seq[edu.berkeley.cs.scads.comm.ClassSource], implicit zookeeperRoot: edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode)Seq[edu.berkeley.cs.scads.comm.JvmTask]" id="29714">delayedSchedule</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29922">cluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span>, <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="29923">resultCluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Seq[edu.berkeley.cs.scads.comm.ClassSource]" id="29924">classpath</a>: <span title="Seq[edu.berkeley.cs.scads.comm.ClassSource]">Seq</span><span class="delimiter">[</span>ClassSource<span class="delimiter">]</span>, <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29925">zookeeperRoot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>: <span title="Seq[edu.berkeley.cs.scads.comm.JvmTask]">Seq</span><span class="delimiter">[</span>JvmTask<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29931">experimentRoot</a> = <a href="#29925" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">zookeeperRoot</a>.<span title="(rpath: java.lang.String, tries: Int)edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">getOrCreate</span><a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="29937" class="delimiter">(</a><span title="java.lang.String(&quot;experiments&quot;)" class="string">&quot;experiments&quot;</span><span class="delimiter">)</span>.<a href="#29937" title="Array[Byte]" id="29940">createChild</a><span class="delimiter">(</span><a title="java.lang.String(&quot;experiment&quot;)" id="29938" class="string">&quot;experiment&quot;</a>, mode = CreateMode.<a title="org.apache.zookeeper.CreateMode(value PERSISTENT_SEQUENTIAL)" id="29939">PERSISTENT_SEQUENTIAL</a><span class="delimiter">)</span>
    <a href="#29704" title="(x$1: String)Unit">experimentAddress</a> = <a href="#29931" title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">experimentRoot</a>.<span title="=&gt; java.lang.String">canonicalAddress</span>
    <a href="#29702" title="(x$1: String)Unit">clusterAddress</a> = <a href="#29922" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="=&gt; java.lang.String">canonicalAddress</span>
    <a href="#29700" title="(x$1: String)Unit">resultClusterAddress</a> = <a href="#29923" title="edu.berkeley.cs.scads.storage.ScadsCluster">resultCluster</a>.<span title="=&gt; edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">root</span>.<span title="=&gt; java.lang.String">canonicalAddress</span>

    <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.comm.JvmMainTask" id="29932">task</a> = <a href="#9502" title="ReplicatedExperimentTask.this.type" class="keyword">this</a>.<a href="#29924" title="(implicit classSource: Seq[edu.berkeley.cs.scads.comm.ClassSource])edu.berkeley.cs.scads.comm.JvmMainTask">toJvmTask</a>
    <span title="object Array">Array</span>.<span title="(n: Int)(elem: =&gt; edu.berkeley.cs.scads.comm.JvmMainTask)(implicit evidence$9: scala.reflect.ClassManifest[edu.berkeley.cs.scads.comm.JvmMainTask])Array[edu.berkeley.cs.scads.comm.JvmMainTask]">fill</span><span class="delimiter">(</span><a href="#29698" title="=&gt; Int">numClients</a><span class="delimiter">)</span><span title="(xs: Array[edu.berkeley.cs.scads.comm.JvmMainTask])scala.collection.mutable.WrappedArray[edu.berkeley.cs.scads.comm.JvmMainTask]" class="delimiter">(</span><a href="#29932" title="edu.berkeley.cs.scads.comm.JvmMainTask">task</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster, resultCluster: edu.berkeley.cs.scads.storage.ScadsCluster)(implicit classpath: Seq[edu.berkeley.cs.scads.comm.ClassSource], implicit scheduler: deploylib.mesos.ExperimentScheduler, implicit zookeeperRoot: edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode)ReplicatedExperimentTask.this.type" id="29715">schedule</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="30747">cluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span>, <a title="edu.berkeley.cs.scads.storage.ScadsCluster" id="30748">resultCluster</a>: <span title="edu.berkeley.cs.scads.storage.ScadsCluster">ScadsCluster</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Seq[edu.berkeley.cs.scads.comm.ClassSource]" id="30749">classpath</a>: <span title="Seq[edu.berkeley.cs.scads.comm.ClassSource]">Seq</span><span class="delimiter">[</span>ClassSource<span class="delimiter">]</span>, <a title="deploylib.mesos.ExperimentScheduler" id="30750">scheduler</a>: <span title="deploylib.mesos.ExperimentScheduler">ExperimentScheduler</span>, <a title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode" id="30751">zookeeperRoot</a>: ZooKeeperProxy#<span title="edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode">ZooKeeperNode</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#30750" title="deploylib.mesos.ExperimentScheduler">scheduler</a>.<span title="(processes: Seq[edu.berkeley.cs.scads.comm.JvmTask])Unit">scheduleExperiment</span><span class="delimiter">(</span><a href="#29714" title="(cluster: edu.berkeley.cs.scads.storage.ScadsCluster, resultCluster: edu.berkeley.cs.scads.storage.ScadsCluster)(implicit classpath: Seq[edu.berkeley.cs.scads.comm.ClassSource], implicit zookeeperRoot: edu.berkeley.cs.scads.comm.ZooKeeperProxy#ZooKeeperNode)Seq[edu.berkeley.cs.scads.comm.JvmTask]">delayedSchedule</a><a href="#30749" title="Seq[edu.berkeley.cs.scads.comm.ClassSource]" class="delimiter">(</a><a href="#30747" title="edu.berkeley.cs.scads.storage.ScadsCluster">cluster</a>, <a href="#30748" title="edu.berkeley.cs.scads.storage.ScadsCluster">resultCluster</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#9502" title="ReplicatedExperimentTask.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>