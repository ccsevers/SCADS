<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>package.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> edu.berkeley.cs
<span class="keyword">package</span> scads

<span class="keyword">import</span> org.apache.avro.Schema
<span class="keyword">import</span> org.apache.avro.generic.<span class="delimiter">{</span> IndexedRecord, GenericRecord <span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.avro.util.Utf8
<span class="keyword">import</span> net.lag.logging.Logger

<span class="keyword">import</span> avro.marker._
<span class="keyword">import</span> storage._

<span class="keyword">package</span> <span class="keyword">object</span> <a title="object edu.berkeley.cs.scads.piql.package" id="9668">piql</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="net.lag.logging.Logger" id="9671">logger</a> = <span title="()net.lag.logging.Logger">Logger</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">type</span> <a title="package extends edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.RecordStore[org.apache.avro.generic.IndexedRecord] with edu.berkeley.cs.scads.storage.GlobalMetadata" id="9673">Namespace</a> = storage.<a href="#25139" title="package extends edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.RecordStore[org.apache.avro.generic.IndexedRecord] with edu.berkeley.cs.scads.storage.GlobalMetadata">Namespace</a> <span class="keyword">with</span> RecordStore<span class="delimiter">[</span>IndexedRecord<span class="delimiter">]</span> <span class="keyword">with</span> GlobalMetadata
  <span class="keyword">type</span> <a title="package extends edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.RecordStore[edu.berkeley.cs.avro.marker.AvroPair] with edu.berkeley.cs.scads.storage.GlobalMetadata with edu.berkeley.cs.scads.storage.IndexManager[edu.berkeley.cs.avro.marker.AvroPair]" id="9674">IndexedNamespace</a> = storage.<a href="#46922" title="package extends edu.berkeley.cs.scads.storage.Namespace with edu.berkeley.cs.scads.storage.RecordStore[edu.berkeley.cs.avro.marker.AvroPair] with edu.berkeley.cs.scads.storage.GlobalMetadata with edu.berkeley.cs.scads.storage.IndexManager[edu.berkeley.cs.avro.marker.AvroPair]">Namespace</a> <span class="keyword">with</span> RecordStore<span class="delimiter">[</span>AvroPair<span class="delimiter">]</span> <span class="keyword">with</span> GlobalMetadata <span class="keyword">with</span> IndexManager<span class="delimiter">[</span>AvroPair<span class="delimiter">]</span>

  <span class="keyword">type</span> <a title="Seq[edu.berkeley.cs.scads.piql.Value]" id="9675">KeyGenerator</a> = <span title="Seq[edu.berkeley.cs.scads.piql.Value]">Seq</span><span class="delimiter">[</span>Value<span class="delimiter">]</span>

  <span class="keyword">type</span> <a title="org.apache.avro.generic.IndexedRecord" id="9676">Key</a> = <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span>
  <span class="keyword">type</span> <a title="org.apache.avro.generic.IndexedRecord" id="9677">Record</a> = <span title="org.apache.avro.generic.IndexedRecord">IndexedRecord</span>
  <span class="keyword">type</span> <a title="IndexedSeq[edu.berkeley.cs.scads.piql.package.Record]" id="9678">Tuple</a> = <span title="IndexedSeq[edu.berkeley.cs.scads.piql.package.Record]">IndexedSeq</span><span class="delimiter">[</span>Record<span class="delimiter">]</span>
  <span class="keyword">type</span> <a title="Seq[edu.berkeley.cs.scads.piql.package.Namespace]" id="9679">TupleSchema</a> = <span title="Seq[edu.berkeley.cs.scads.piql.package.Namespace]">Seq</span><span class="delimiter">[</span>Namespace<span class="delimiter">]</span>

  <span class="keyword">type</span> <a title="Seq[edu.berkeley.cs.scads.piql.package.Tuple]" id="9680">QueryResult</a> = <span title="Seq[edu.berkeley.cs.scads.piql.package.Tuple]">Seq</span><span class="delimiter">[</span>Tuple<span class="delimiter">]</span>

  <span class="comment">//Query State Serailization</span>
  <span class="keyword">type</span> <a title="Seq[Any]" id="9681">CursorPosition</a> = <span title="Seq[Any]">Seq</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit edu.berkeley.cs.scads.piql.package.toRichTuple : (t: edu.berkeley.cs.scads.piql.package.Tuple)edu.berkeley.cs.scads.piql.RichTuple" id="9682">toRichTuple</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.package.Tuple" id="25841">t</a>: <span title="edu.berkeley.cs.scads.piql.package.Tuple">Tuple</span><span class="delimiter">)</span> = <span title="edu.berkeley.cs.scads.piql.RichTuple" class="keyword">new</span> <a href="Debug.scala.html#9509" title="edu.berkeley.cs.scads.piql.RichTuple">RichTuple</a><span class="delimiter">(</span><a href="#25841" title="edu.berkeley.cs.scads.piql.package.Tuple">t</a><span class="delimiter">)</span>

  <span class="comment">//TODO: Remove hack</span>
  <span class="comment">//HACK: to deal with problem in namespace variance</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: edu.berkeley.cs.scads.storage.PairNamespace[T])edu.berkeley.cs.scads.piql.package.Namespace" id="9683">pairToNamespace</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="9685">T</a> &lt;: AvroPair<span class="delimiter">]</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.PairNamespace[T]" id="25837">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[T]">PairNamespace</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#25837" title="edu.berkeley.cs.scads.storage.PairNamespace[T]">ns</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="edu.berkeley.cs.scads.piql.package.Namespace" class="delimiter">[</span><a href="#25139" title="edu.berkeley.cs.scads.piql.package.Namespace">Namespace</a><span class="delimiter">]</span>

  <span class="comment">//PIQL Scala Language Integration</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T &lt;: edu.berkeley.cs.avro.marker.AvroPair](ns: edu.berkeley.cs.scads.storage.PairNamespace[T])edu.berkeley.cs.scads.piql.Relation" id="9686">namespaceToRelation</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: edu.berkeley.cs.avro.marker.AvroPair" id="9688">T</a> &lt;: AvroPair<span class="delimiter">]</span><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.storage.PairNamespace[T]" id="25048">ns</a>: <span title="edu.berkeley.cs.scads.storage.PairNamespace[T]">PairNamespace</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="LogicalPlan.scala.html#25142" title="(ns: edu.berkeley.cs.scads.piql.package.Namespace)edu.berkeley.cs.scads.piql.Relation">Relation</a><span class="delimiter">(</span><a href="#25048" title="edu.berkeley.cs.scads.storage.PairNamespace[T]">ns</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="edu.berkeley.cs.scads.piql.package.Namespace" class="delimiter">[</span><a href="#25139" title="edu.berkeley.cs.scads.piql.package.Namespace">Namespace</a><span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit edu.berkeley.cs.scads.piql.package.toAttr : (s: String)java.lang.Object{def a: edu.berkeley.cs.scads.piql.UnboundAttributeValue}" id="9689">toAttr</a><span class="delimiter">(</span><a title="String" id="25017">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#25020" title="java.lang.Object{def a: edu.berkeley.cs.scads.piql.UnboundAttributeValue}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object" id="25020" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="=&gt; edu.berkeley.cs.scads.piql.UnboundAttributeValue" id="25022">a</a> = <a href="QueryPlan.scala.html#25025" title="(name: String)edu.berkeley.cs.scads.piql.UnboundAttributeValue">UnboundAttributeValue</a><span class="delimiter">(</span><a href="#25017" title="String">s</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit edu.berkeley.cs.scads.piql.package.toParameter : (o: Double)java.lang.Object{def ?: edu.berkeley.cs.scads.piql.ParameterValue}" id="9690">toParameter</a><span class="delimiter">(</span><a title="Double" id="24990">o</a>: <span title="Double">Double</span><span class="delimiter">)</span> = <a href="#24993" title="java.lang.Object{def ?: edu.berkeley.cs.scads.piql.ParameterValue}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object" id="24993" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="=&gt; edu.berkeley.cs.scads.piql.ParameterValue" id="24995">?</a> = <a href="QueryPlan.scala.html#24998" title="(ordinal: Int)edu.berkeley.cs.scads.piql.ParameterValue">ParameterValue</a><span class="delimiter">(</span><a href="#24990" title="Double">o</a>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit edu.berkeley.cs.scads.piql.package.toConstantValue : (a: Any)edu.berkeley.cs.scads.piql.ConstantValue" id="9691">toConstantValue</a><span class="delimiter">(</span><a title="Any" id="24967">a</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="QueryPlan.scala.html#24975" title="(v: Any)edu.berkeley.cs.scads.piql.ConstantValue">ConstantValue</a><span class="delimiter">(</span><a href="#24967" title="Any">a</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](a: A)Option[A]" id="9692">toOption</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="9694">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="24960">a</a>: <a href="#9694" title="A">A</a><span class="delimiter">)</span> = <span title="(x: A)Option[A]">Option</span><span class="delimiter">(</span><a href="#24960" title="A">a</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit edu.berkeley.cs.scads.piql.package.toPiql : (logicalPlan: edu.berkeley.cs.scads.piql.Queryable)(implicit executor: edu.berkeley.cs.scads.piql.QueryExecutor)java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.OptimizedQuery; def toPiql$default$1: Option[String]}" id="9695">toPiql</a><span class="delimiter">(</span><a title="edu.berkeley.cs.scads.piql.Queryable" id="17597">logicalPlan</a>: <a href="LogicalPlan.scala.html#9532" title="edu.berkeley.cs.scads.piql.Queryable">Queryable</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="edu.berkeley.cs.scads.piql.QueryExecutor" id="17598">executor</a>: <a href="Iterators.scala.html#9525" title="edu.berkeley.cs.scads.piql.QueryExecutor">QueryExecutor</a><span class="delimiter">)</span> = <a href="#17601" title="java.lang.Object{def toPiql(queryName: Option[String]): edu.berkeley.cs.scads.piql.OptimizedQuery; def toPiql$default$1: Option[String] @scala.annotation.unchecked.uncheckedVariance}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object" id="17601" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="(queryName: Option[String])edu.berkeley.cs.scads.piql.OptimizedQuery" id="17603">toPiql</a><span class="delimiter">(</span><a title="Option[String]" id="17605">queryName</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="object None">None</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#9671" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Begining Optimization of query %s: %s&quot;)" class="string">&quot;Begining Optimization of query %s: %s&quot;</span>, <a href="#17605" title="Option[String]">queryName</a>, <a href="#17597" title="edu.berkeley.cs.scads.piql.Queryable">logicalPlan</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="edu.berkeley.cs.scads.piql.QueryPlan" id="17606">physicalPlan</a> = <a href="Optimizer.scala.html#23939" title="(logicalPlan: edu.berkeley.cs.scads.piql.Queryable)edu.berkeley.cs.scads.piql.Optimizer.OptimizedSubPlan">Optimizer</a><span class="delimiter">(</span><a href="#17597" title="edu.berkeley.cs.scads.piql.Queryable">logicalPlan</a><span class="delimiter">)</span>.<a href="Optimizer.scala.html#23963" title="=&gt; edu.berkeley.cs.scads.piql.QueryPlan">physicalPlan</a>
      <a href="#9671" title="=&gt; net.lag.logging.Logger">logger</a>.<span title="(msg: String, items: Any*)Unit">info</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Optimized piql query %s: %s&quot;)" class="string">&quot;Optimized piql query %s: %s&quot;</span>, <a href="#17605" title="Option[String]">queryName</a>, <a href="#17606" title="edu.berkeley.cs.scads.piql.QueryPlan">physicalPlan</a><span class="delimiter">)</span>
      <span title="edu.berkeley.cs.scads.piql.OptimizedQuery" class="keyword">new</span> <a href="Optimizer.scala.html#9567" title="edu.berkeley.cs.scads.piql.OptimizedQuery">OptimizedQuery</a><span class="delimiter">(</span><a href="#17605" title="Option[String]">queryName</a>, <a href="#17606" title="edu.berkeley.cs.scads.piql.QueryPlan">physicalPlan</a>, <a href="#17598" title="edu.berkeley.cs.scads.piql.QueryExecutor">executor</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>